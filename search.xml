<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>nodejs-排程工具node-schedule</title>
      <link href="//nodejs-%E6%8E%92%E7%A8%8B%E5%B7%A5%E5%85%B7node-schedule/"/>
      <url>//nodejs-%E6%8E%92%E7%A8%8B%E5%B7%A5%E5%85%B7node-schedule/</url>
      
        <content type="html"><![CDATA[<h2 id="安裝"><a href="#安裝" class="headerlink" title="安裝"></a>安裝</h2><p>if you only want to do something like “run this function every 5 minutes”, toad-scheduler would be a better choice. But if you want to, say, “run this function at the :20 and :50 of every hour on the third Tuesday of every month<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">npm i <span class="hljs-keyword">node</span><span class="hljs-title">-schedule</span><br></code></pre></td></tr></table></figure></p><p>每五分鐘執行一次<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> schedule = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;node-schedule&#x27;</span>);<br><span class="hljs-keyword">const</span> &#123; scheduleJob &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;node-schedule&#x27;</span>);<br><span class="hljs-keyword">const</span> CRON_TIME=*/<span class="hljs-number">5</span> * * * *<br><br><span class="hljs-keyword">const</span> job = schedule.scheduleJob(CRON_TIME, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;每五分鐘你都會看到我&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue使用 Lodash Throttle，動態設定秒數</title>
      <link href="//Vue%E4%BD%BF%E7%94%A8Lodash-Throttle/"/>
      <url>//Vue%E4%BD%BF%E7%94%A8Lodash-Throttle/</url>
      
        <content type="html"><![CDATA[<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>接到一個需求，請求 API 取得延遲秒數，也就是說延遲秒數是動態設置的。<br>再開始設定像是註冊、登入等按鈕點擊後需要請求 API，用 Lodash 的 throttle 函式來延遲請求</p><h2 id="常見寫法"><a href="#常見寫法" class="headerlink" title="常見寫法"></a>常見寫法</h2><p>在實作這個需求時有卡住一下，大部分的寫法都是像這樣<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;onSubmit&quot;</span>&gt;</span>送出<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-attr">onSubmit</span>: _.throttle(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>      <span class="hljs-comment">// ...執行某些事</span><br>    &#125;, <span class="hljs-number">2000</span>),<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><br>秒數皆是設定靜態，並不符合我的需求。<br>但將 2000 取代成 this.click_interval，會發生錯誤，無法找到 this，如下範例<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;onSubmit&quot;</span>&gt;</span>送出<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-attr">onSubmit</span>: _.throttle(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>      <span class="hljs-comment">// ...執行某些事</span><br>    &#125;, <span class="hljs-built_in">this</span>.settings.click_interval, <span class="hljs-comment">// 無法執行，會找不到 this</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="解決方案"><a href="#解決方案" class="headerlink" title="解決方案"></a>解決方案</h2><p>最後嘗試了很久，要改為在生命週期宣告一個變數並用 function 儲存進去，這樣的寫法才能帶入動態秒數<br>從 API 取得的秒數，我儲存在 vuex getters 裡，<code>getters.settings.click_interval</code></p><ul><li>methods 宣告 debouncer function，並什麼都不寫</li><li>宣告原本欲要請求 API 的方法 <code>this.clickToTransferIn()</code>，動態帶入 API取得的 click_interval，並在 function 裡執行 clickToTransferIn</li><li>在生命週期 created 執行 this.debouncer，並用 _.throttle</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; throttle &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;lodash&#x27;</span><br><span class="hljs-keyword">import</span> &#123; mapGetters &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-function"><span class="hljs-title">created</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-comment">// 延遲按鈕：一鍵轉入</span><br>    <span class="hljs-built_in">this</span>.debouncer = _.throttle(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code, name</span>) </span>&#123;<br>      <span class="hljs-built_in">this</span>.clickToTransferIn(code, name)<br>    &#125;, <span class="hljs-built_in">this</span>.settings.click_interval * <span class="hljs-number">1000</span> || <span class="hljs-number">2000</span>)<br>  &#125;,<br><br>  <span class="hljs-attr">computed</span>: &#123;<br>    ...mapGetters([<span class="hljs-string">&#x27;settings&#x27;</span>]),<br>  &#125;,<br><br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-comment">// 不可刪除，用於的按鈕延遲功能</span><br>    <span class="hljs-function"><span class="hljs-title">debouncer</span>(<span class="hljs-params"></span>)</span> &#123;&#125;,<br><br>    <span class="hljs-comment">// 請求 API</span><br>    <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-title">clickToTransferIn</span>(<span class="hljs-params">code, name</span>)</span> &#123;<br>      <span class="hljs-comment">// ... 請求 API</span><br>      <span class="hljs-keyword">await</span> requestTransferInAPI(params)<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
          <category> lodash </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Mongoose操作</title>
      <link href="//Mongoose%E6%93%8D%E4%BD%9C/"/>
      <url>//Mongoose%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="findByIdAndUpdate"><a href="#findByIdAndUpdate" class="headerlink" title="findByIdAndUpdate"></a>findByIdAndUpdate</h2><p>Mongoose 的 findByIdAndUpdate，會呼叫 MongoDB findAndModify 方法</p><ul><li>new: 設定 true 表示會返回修改後的 item ，而非原始 item</li><li>runValidators: 若設定 true 將會觸發 Model Schema 重新驗證</li><li>upsert：若設定 true，如果 object 不存在會新建，預設值是 false</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 引入 Model Instance</span><br><span class="hljs-keyword">const</span> Tour = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../models/tourModel&#x27;</span>)<br><br><span class="hljs-keyword">const</span> tour = <span class="hljs-keyword">await</span> Tour.findByIdAndUpdate(req.params.id, req.body, &#123;<br>  <span class="hljs-comment">// [new] 設定 true 表示會返回修改後的 item ，而非原始 item</span><br>  <span class="hljs-attr">new</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-comment">// [runValidators] 若設定 true 將會觸發 Model Schema 重新驗證</span><br>  <span class="hljs-attr">runValidators</span>: <span class="hljs-literal">true</span>,<br>&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">await</span> UserTrackNftList.findOneAndUpdate(&#123; <span class="hljs-attr">name</span>: req.body.name &#125;,<br>  &#123; <span class="hljs-attr">$push</span>: &#123; <span class="hljs-attr">last_data</span>: result.data.collection.stats &#125; &#125;,<br>  &#123; <span class="hljs-attr">upsert</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">new</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">setDefaultsOnInsert</span>: <span class="hljs-literal">true</span> &#125;,<br>)<br></code></pre></td></tr></table></figure><p>找到對應的資料後，僅更新 last_data 的資料欄位</p><h2 id="瀏覽-Model-全部資料"><a href="#瀏覽-Model-全部資料" class="headerlink" title="瀏覽 Model 全部資料"></a>瀏覽 Model 全部資料</h2><ul><li>取出 Post 所有資料，使用 Post.find()，因為沒有傳入參數，因此會撈出所有資料</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> Post = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./models/post&#x27;</span>) <span class="hljs-comment">// 載入 Post model</span><br><br>app.get(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  Post.find() <span class="hljs-comment">// 取出 Post model 裡的所有資料</span><br>    .lean() <span class="hljs-comment">// 將 Model 物件轉成 js 陣列</span><br>    .then(<span class="hljs-function"><span class="hljs-params">posts</span> =&gt;</span> res.render(<span class="hljs-string">&#x27;index&#x27;</span>, &#123; posts &#125;)) <span class="hljs-comment">// 將資料傳給 index 樣板</span><br>    .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-built_in">console</span>.error(error)) <span class="hljs-comment">// 錯誤處理</span><br>&#125;)<br></code></pre></td></tr></table></figure><p>API 版本<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> Post = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./models/post&#x27;</span>) <span class="hljs-comment">// 載入 Post model</span><br><br>app.get(<span class="hljs-string">&#x27;/posts&#x27;</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; &#123;<br><br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">const</span> posts = <span class="hljs-keyword">await</span> Post.find()<br><br>    res.status(<span class="hljs-number">200</span>).json(&#123;<br>      <span class="hljs-attr">status</span>: <span class="hljs-string">&#x27;success&#x27;</span>,<br>      <span class="hljs-attr">data</span>: &#123;<br>        post<br>      &#125;,<br>    &#125;)<br>  &#125; <span class="hljs-keyword">catch</span>(error) &#123;<br>    <span class="hljs-built_in">console</span>.log(error)<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure></p><h2 id="新增資料"><a href="#新增資料" class="headerlink" title="新增資料"></a>新增資料</h2><p>使用 mongoose 提供的方法 Model.create 來建立資料</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js">app.post(<span class="hljs-string">&#x27;/posts&#x27;</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> name = req.body.name<br><br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">await</span> Post.create(&#123; name &#125;)     <span class="hljs-comment">// 存入資料庫</span><br>    res.status(<span class="hljs-number">200</span>).json(&#123;<br>      <span class="hljs-attr">status</span>: <span class="hljs-string">&#x27;success&#x27;</span>,<br>      <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;建立成功&#x27;</span>,<br>      <span class="hljs-attr">data</span>: &#123; name &#125;<br>    &#125;)<br>  &#125; <span class="hljs-keyword">catch</span> (error)&#123;<br>    res.status(<span class="hljs-number">400</span>).json(&#123;<br>      <span class="hljs-attr">statuss</span>: <span class="hljs-string">&#x27;fail&#x27;</span>,<br>      <span class="hljs-attr">msg</span>: error<br>    &#125;)<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="瀏覽特定一筆資料"><a href="#瀏覽特定一筆資料" class="headerlink" title="瀏覽特定一筆資料"></a>瀏覽特定一筆資料</h2><ol><li>資料庫查詢資料，使用 findById，使用此方法只會返回一筆資料，以 id 去尋找資料</li><li>若撈完資料後，要回傳給樣板使用 res.render()，則要用 lean()，將資料整理乾淨。口訣：「撈資料以後想用 res.render()，就要先用 .lean()」。</li></ol><ul><li>lean：把 Mongoose 的 Model 物件轉換成 Javascript 陣列</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> Post = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./models/post&#x27;</span>) <span class="hljs-comment">// 載入 Post model</span><br><br>app.get(<span class="hljs-string">&#x27;/posts/:id&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> id = req.params.id<br>  <span class="hljs-keyword">return</span> Post.findById(id)<br>    .lean()<br>    .then(<span class="hljs-function">(<span class="hljs-params">post</span>) =&gt;</span> res.render(<span class="hljs-string">&#x27;item&#x27;</span>, &#123; post &#125;))<br>    .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(error))<br>&#125;)<br></code></pre></td></tr></table></figure><p>API 版本<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> Post = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./models/post&#x27;</span>) <span class="hljs-comment">// 載入 Post model</span><br><br>app.get(<span class="hljs-string">&#x27;/posts&#x27;</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> post = <span class="hljs-keyword">await</span> Post.findById(req.params.id)<br><br>  <span class="hljs-keyword">if</span> (!post) &#123;<br>    <span class="hljs-keyword">return</span> next(<span class="hljs-keyword">new</span> AppError(<span class="hljs-string">&#x27;No post found with that ID&#x27;</span>, <span class="hljs-number">404</span>))<br>  &#125;<br><br>  res.status(<span class="hljs-number">200</span>).json(&#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-string">&#x27;success&#x27;</span>,<br>    <span class="hljs-attr">data</span>: &#123;<br>      post<br>    &#125;,<br>  &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure></p><h2 id="修改資料"><a href="#修改資料" class="headerlink" title="修改資料"></a>修改資料</h2><ol><li>資料庫查詢資料，使用 findById，使用此方法只會返回一筆資料</li><li>修改資料，post.name = name</li><li>儲存資料，post.save()，針對修改的資料儲存</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js">app.get(<span class="hljs-string">&#x27;/posts/:id/edit&#x27;</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> id = req.params.id<br><br>  <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">const</span> id = req.params.id<br>      <span class="hljs-keyword">const</span> name = req.body.name<br>      <span class="hljs-keyword">return</span> Post.findById(id)<br>        .then(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> &#123;<br>          post.name = name<br>          <span class="hljs-keyword">return</span> post.save()<br>        &#125;)<br>        .then(<span class="hljs-function">()=&gt;</span> &#123;<br>          res.status(<span class="hljs-number">200</span>).json(&#123;<br>            <span class="hljs-attr">status</span>: <span class="hljs-string">&#x27;success&#x27;</span>,<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;修改成功&#x27;</span>,<br>            <span class="hljs-attr">data</span>: post<br>          &#125;)<br>        &#125;)<br>        .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(error))<br><br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    res.status(<span class="hljs-number">400</span>).json(&#123;<br>      <span class="hljs-attr">statuss</span>: <span class="hljs-string">&#x27;fail&#x27;</span>,<br>      <span class="hljs-attr">msg</span>: error<br>    &#125;)<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="刪除資料"><a href="#刪除資料" class="headerlink" title="刪除資料"></a>刪除資料</h2><ol><li>資料庫查詢資料，使用 findById，使用此方法只會返回一筆資料</li><li>移除資料，post.remove()</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js">app.post(<span class="hljs-string">&#x27;/posts/:id/delete&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> id = req.params.id<br>  <span class="hljs-keyword">return</span> Post.findById(id)<br>    .then(<span class="hljs-function"><span class="hljs-params">post</span> =&gt;</span> post.remove())<br>    .then(<span class="hljs-function">() =&gt;</span> &#123;<br>      res.status(<span class="hljs-number">200</span>).json(&#123;<br>        <span class="hljs-attr">status</span>: <span class="hljs-string">&#x27;success&#x27;</span>,<br>        <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;刪除成功&#x27;</span>,<br>        <span class="hljs-attr">data</span>: post<br>      &#125;)<br>    &#125;)<br>    .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(error))<br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="更新某一筆資料的特定欄位-Array-push"><a href="#更新某一筆資料的特定欄位-Array-push" class="headerlink" title="更新某一筆資料的特定欄位 Array $push"></a>更新某一筆資料的特定欄位 Array $push</h2><p>MongoDB 有 <code>$push</code> 方法，語法如下<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">&#123; $push:&#123; <span class="hljs-operator">&lt;</span>field1<span class="hljs-operator">&gt;</span>:<span class="hljs-operator">&lt;</span>value1<span class="hljs-operator">&gt;</span>,<span class="hljs-operator">&lt;</span>field2<span class="hljs-operator">&gt;</span>:<span class="hljs-operator">&lt;</span>value2<span class="hljs-operator">&gt;</span> &#125; &#125;<br></code></pre></td></tr></table></figure></p><p>Express 操作範例<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">person.friends.push(friend);<br>person.save(done);<br><br>Model.update(<br>    &#123; <span class="hljs-attr">_id</span>: person._id &#125;, <br>    &#123; <span class="hljs-attr">$push</span>: &#123; <span class="hljs-attr">friends</span>: friend &#125; &#125;<br>);<br></code></pre></td></tr></table></figure></p><p>文件</p><ul><li><a href="https://docs.mongodb.com/manual/reference/operator/update/push/#up._S_push">官方文件 MongoDB $push</a></li></ul><h2 id="查詢一筆資料顯示特定欄位"><a href="#查詢一筆資料顯示特定欄位" class="headerlink" title="查詢一筆資料顯示特定欄位"></a>查詢一筆資料顯示特定欄位</h2><p>找 Model: UserTrackNftList，抓出 apple 資料，並只顯示 name, last_data 欄位</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> items = <span class="hljs-keyword">await</span> UserTrackNftList.find(&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;apple&#x27;</span> &#125;, <span class="hljs-string">&#x27;name last_data&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="資料庫找出所有資料，並-run-forEach"><a href="#資料庫找出所有資料，並-run-forEach" class="headerlink" title="資料庫找出所有資料，並 run forEach"></a>資料庫找出所有資料，並 run forEach</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">await</span> Post.find().exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, result</span>) </span>&#123;<br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-built_in">console</span>.log(err)<br><br>  result.forEach(<span class="hljs-function"><span class="hljs-params">post</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(post)<br>  &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> mongo </category>
          
          <category> mongoose </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue串接LineNotify</title>
      <link href="//LineNotify%E4%B8%B2%E6%8E%A5/"/>
      <url>//LineNotify%E4%B8%B2%E6%8E%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>此篇介紹怎麼串接 Line Notify，使用 Vue 來示範，也會寫下我踩過的坑紀錄下來，因為那些坑搞了我快兩個小時…<br>串接 Line Notify 總共會打三隻 API，接下來的 API 路徑會省略 <code>https://notify-api.line.me</code>，直接說是 <code>oauth/authorize</code> 或 <code>/oauth/token</code>，以方便閱讀。</p><ol><li>GET <code>https://notify-bot.line.me/oauth/authorize</code></li><li>POST <code>https://notify-bot.line.me/oauth/token</code></li><li>POST <code>https://notify-api.line.me/api/notify</code></li></ol><h2 id="步驟一：請求-authorize"><a href="#步驟一：請求-authorize" class="headerlink" title="步驟一：請求 authorize"></a>步驟一：請求 authorize</h2><p>第一步驟 GET 請求 <code>/oauth/authorize</code>，請求參數 client_id 可從 Line Notify 後台取得<br>較為敏感的參數可以設定在 .env，透過 <code>process.env</code> 來取得<br>由於是在 vue 設定，環境變數開頭必須以 <code>VUE_APP</code> 來命名，否則會抓取不到</p><p>較為特別的是直接設定 <code>window.open</code> 來開啟連結，需另外設定 redirect_uri 的網址<br>當使用者成功登入後，Line 會將使用者跳轉回來的目標網址，順利請求成功會回傳 code、state</p><p>踩到的坑：redirect_uri 不可設定 line、notify 等相關單字，會導致導向回來變成 404 Not Found的畫面<br>我的路由都設定為 <code>localhost:9527/line</code> 或 <code>localhost:9527/notify</code>，由於這個關係（腦袋單字不多ORZ）我卡住了兩個小時……<br>最後導向回來的 redirect_uri 設定為 <code>localhost:9527/auth-line</code>，才成功，希望看了這篇文章的讀者可以避免這個坑</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">v-btn</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;!isLogin&quot;</span> <span class="hljs-attr">elevation</span>=<span class="hljs-string">&quot;2&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;loginEvent()&quot;</span>&gt;</span>Line登入<span class="hljs-tag">&lt;/<span class="hljs-name">v-btn</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-comment">// 請求登入授權</span><br>    <span class="hljs-function"><span class="hljs-title">login</span>(<span class="hljs-params"></span>)</span> &#123;<br>      <span class="hljs-comment">// 必填</span><br>      <span class="hljs-keyword">let</span> loginUrl = <span class="hljs-string">&#x27;https://notify-bot.line.me/oauth/authorize?&#x27;</span><br>      loginUrl += <span class="hljs-string">&#x27;response_type=code&#x27;</span><br>      loginUrl += <span class="hljs-string">`&amp;client_id=<span class="hljs-subst">$&#123;process.env.VUE_APP_LINE_CHANNEL_ID&#125;</span>`</span><br>      loginUrl += <span class="hljs-string">`&amp;redirect_uri=<span class="hljs-subst">$&#123;process.env.VUE_APP_LINE_REDIRECT_URL&#125;</span>`</span> <span class="hljs-comment">// 要接收回傳訊息的網址</span><br>      loginUrl += <span class="hljs-string">`&amp;state=<span class="hljs-subst">$&#123;<span class="hljs-built_in">this</span>.stateCode&#125;</span>`</span><br>      loginUrl += <span class="hljs-string">&#x27;&amp;scope=openid%20profile&#x27;</span><br>      <span class="hljs-comment">// 選填</span><br>      loginUrl += <span class="hljs-string">&#x27;&amp;nonce=helloWorld&#x27;</span><br>      loginUrl += <span class="hljs-string">&#x27;&amp;prompt=consent&#x27;</span><br>      loginUrl += <span class="hljs-string">&#x27;&amp;max_age=3600&#x27;</span><br>      loginUrl += <span class="hljs-string">&#x27;&amp;ui_locales=zh-TW&#x27;</span><br>      loginUrl += <span class="hljs-string">&#x27;&amp;bot_prompt=normal&#x27;</span><br><br>      <span class="hljs-built_in">window</span>.open(loginUrl, <span class="hljs-string">&#x27;_self&#x27;</span>) <span class="hljs-comment">// 轉跳到該網址</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="步驟二：請求-token"><a href="#步驟二：請求-token" class="headerlink" title="步驟二：請求 token"></a>步驟二：請求 token</h2><p>在上一個步驟時請求成功會順利拿到 <code>code</code>，需要將此參數也放入進去<br>第二步驟 POST 請求 <code>/oauth/token</code>，比較需要注意的是 content-type 需要設定為 <code>application/x-www-form-urlencoded</code></p><p>我使用的是 axios，header <code>application/x-www-form-urlencoded</code> 格式需要另外處理<br>axios 數據都是 json 格式，要使用 <code>application/x-www-form-urlencoded</code> 格式要安裝 Qs 套件，用 <code>Qs.stringify()</code> 方法來轉換參數</p><ol><li><p>安裝 Qs</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i qs --save<br></code></pre></td></tr></table></figure></li><li><p>引用 Qs、使用方式</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> Qs <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;qs&#x27;</span><br><span class="hljs-comment">// 示範</span><br><span class="hljs-keyword">const</span> params = Qs.stringify(&#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;hazel&#x27;</span><br>&#125;)<br><br><span class="hljs-built_in">console</span>.log(params)<br></code></pre></td></tr></table></figure><p>以上是 Qs 使用範例</p></li></ol><p>繼續回到專案範例<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> params = Qs.stringify(&#123;<br>  <span class="hljs-attr">grant_type</span>: <span class="hljs-string">&#x27;authorization_code&#x27;</span>,<br>  <span class="hljs-attr">code</span>: <span class="hljs-built_in">this</span>.query.code,<br>  <span class="hljs-attr">redirect_uri</span>: process.env.VUE_APP_LINE_REDIRECT_URL,<br>  <span class="hljs-attr">client_id</span>: process.env.VUE_APP_LINE_CHANNEL_ID,<br>  <span class="hljs-attr">client_secret</span>: process.env.VUE_APP_LINE_CHANNEL_SECRET,<br>&#125;)<br><br></code></pre></td></tr></table></figure></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://jeremysu0131.github.io/axios-%E8%99%95%E7%90%86-x-www-form-urlencoded-%E6%A0%BC%E5%BC%8F%E5%95%8F%E9%A1%8C/">[axios] 處理 x-www-form-urlencoded 格式問題</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>架設Swagger在 nodejs express</title>
      <link href="//%E6%9E%B6%E8%A8%ADSwagger/"/>
      <url>//%E6%9E%B6%E8%A8%ADSwagger/</url>
      
        <content type="html"><![CDATA[<p>開發環境採用 </p><ul><li>Nodejs 12.6.0</li><li>Express 框架</li><li>MacOS</li></ul><p>我並未安裝 swagger-jsdoc，swagger-jsdoc是寫在註解內會自動產生 API 文件，但註解會越來越長，沒有很喜歡，只會另外用 swagger.yml 維護而已，相對簡單。</p><h2 id="安裝"><a href="#安裝" class="headerlink" title="安裝"></a>安裝</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i swagger-ui-express --save<br></code></pre></td></tr></table></figure><h2 id="app-js"><a href="#app-js" class="headerlink" title="app.js"></a>app.js</h2><p>在 app.js 引入套件<br>有分成 json、yml 的檔來撰寫 API 文件，以下會提供兩種範例，引入 yml 需要另外安裝 yamljs 套件</p><h3 id="引入-json-方式"><a href="#引入-json-方式" class="headerlink" title="引入 json 方式"></a>引入 json 方式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// Swagger</span><br><span class="hljs-keyword">const</span> swaggerUi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;swagger-ui-express&#x27;</span>);<br><span class="hljs-keyword">const</span> swaggerDocument = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./swagger.json&#x27;</span>);<br><span class="hljs-comment">// Application</span><br><span class="hljs-keyword">const</span> app = express()<br></code></pre></td></tr></table></figure><h3 id="引入-yaml-方式"><a href="#引入-yaml-方式" class="headerlink" title="引入 yaml 方式"></a>引入 yaml 方式</h3><p>在 src 根目錄建立 swagger.yml 檔，並用 <code>npm install yamljs</code>，才可引入 yml 檔<br><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">npm i yamljs <span class="hljs-comment">--save</span><br></code></pre></td></tr></table></figure><br>引入 yaml<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// Swagger</span><br><span class="hljs-keyword">const</span> YAML = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;yamljs&#x27;</span>)<br><span class="hljs-keyword">const</span> swaggerDocument = YAML.load(<span class="hljs-string">&#x27;./swagger.yml&#x27;</span>)<br><span class="hljs-comment">// Application</span><br><span class="hljs-keyword">const</span> app = express()<br></code></pre></td></tr></table></figure></p><p>引入相關套件後，接著在 app.js 使用 <code>app.use</code> 方法，<code>/apidoc</code> 可改成你想要的路徑</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// API Document</span><br>app.use(<br>  <span class="hljs-string">&#x27;/apidoc&#x27;</span>,<br>  swaggerUi.serve,<br>  swaggerUi.setup(swaggerDocument)<br>);<br></code></pre></td></tr></table></figure><p>接著重啟 server，如果 server 是在 localhost:3000，則 swagger api 網址是 <code>localhost:3000/apidoc</code>。個人較喜歡 yml 簡潔的模式，故引用的是 swagger.yml</p><p>完整程式碼<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// Swagger</span><br><span class="hljs-keyword">const</span> YAML = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;yamljs&#x27;</span>)<br><span class="hljs-keyword">const</span> swaggerDocument = YAML.load(<span class="hljs-string">&#x27;./swagger.yml&#x27;</span>)<br><span class="hljs-comment">// Application</span><br><span class="hljs-keyword">const</span> app = express()<br><br><span class="hljs-comment">// API Document</span><br>app.use(<br>  <span class="hljs-string">&#x27;/apidoc&#x27;</span>,<br>  swaggerUi.serve,<br>  swaggerUi.setup(swaggerDocument)<br>);<br></code></pre></td></tr></table></figure></p><h3 id="範例檔"><a href="#範例檔" class="headerlink" title="範例檔"></a>範例檔</h3><p>以下提供簡易的 swagger.json、swagger.yaml 範例檔</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;swagger&quot;</span>: <span class="hljs-string">&quot;2.0&quot;</span>,<br>  <span class="hljs-attr">&quot;info&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;version&quot;</span>: <span class="hljs-string">&quot;1.0.0&quot;</span>,<br>    <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;API 文件&quot;</span>,<br>    <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;API文件&quot;</span>,<br>    <span class="hljs-attr">&quot;license&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;MIT&quot;</span>,<br>      <span class="hljs-attr">&quot;url&quot;</span>: <span class="hljs-string">&quot;https://opensource.org/licenses/MIT&quot;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">&quot;host&quot;</span>: <span class="hljs-string">&quot;localhost:10991&quot;</span>,<br>  <span class="hljs-attr">&quot;basePath&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>  <span class="hljs-attr">&quot;tags&quot;</span>: [&#123;<br>    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Users&quot;</span>,<br>    <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;API for users in the system&quot;</span><br>  &#125;],<br>  <span class="hljs-attr">&quot;schemes&quot;</span>: [<span class="hljs-string">&quot;http&quot;</span>],<br>  <span class="hljs-attr">&quot;consumes&quot;</span>: [<span class="hljs-string">&quot;application/json&quot;</span>],<br>  <span class="hljs-attr">&quot;produces&quot;</span>: [<span class="hljs-string">&quot;application/json&quot;</span>]<br>&#125;<br></code></pre></td></tr></table></figure><p>yml 範例檔<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">openapi:</span> <span class="hljs-number">3.0</span><span class="hljs-number">.0</span><br><span class="hljs-attr">info:</span><br>  <span class="hljs-attr">title:</span> <span class="hljs-string">API</span> <span class="hljs-string">文件</span><br>  <span class="hljs-attr">description:</span> <span class="hljs-string">Optional</span> <span class="hljs-string">multiline</span> <span class="hljs-string">or</span> <span class="hljs-string">single-line</span> <span class="hljs-string">description</span> <span class="hljs-string">in</span> [<span class="hljs-string">CommonMark</span>]<span class="hljs-string">(http://commonmark.org/help/)</span> <span class="hljs-string">or</span> <span class="hljs-string">HTML.</span><br>  <span class="hljs-attr">version:</span> <span class="hljs-number">0.1</span><span class="hljs-number">.0</span><br><span class="hljs-attr">servers:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">http://api.example.com/v1</span><br>    <span class="hljs-attr">description:</span> <span class="hljs-string">Optional</span> <span class="hljs-string">server</span> <span class="hljs-string">description,</span> <span class="hljs-string">e.g.</span> <span class="hljs-string">Main</span> <span class="hljs-string">(production)</span> <span class="hljs-string">server</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">http://staging-api.example.com</span><br>    <span class="hljs-attr">description:</span> <span class="hljs-string">Optional</span> <span class="hljs-string">server</span> <span class="hljs-string">description,</span> <span class="hljs-string">e.g.</span> <span class="hljs-string">Internal</span> <span class="hljs-string">staging</span> <span class="hljs-string">server</span> <span class="hljs-string">for</span> <span class="hljs-string">testing</span><br><span class="hljs-attr">paths:</span><br>  <span class="hljs-string">/users:</span><br>    <span class="hljs-attr">get:</span><br>      <span class="hljs-attr">summary:</span> <span class="hljs-string">Returns</span> <span class="hljs-string">a</span> <span class="hljs-string">list</span> <span class="hljs-string">of</span> <span class="hljs-string">users.</span><br>      <span class="hljs-attr">description:</span> <span class="hljs-string">Optional</span> <span class="hljs-string">extended</span> <span class="hljs-string">description</span> <span class="hljs-string">in</span> <span class="hljs-string">CommonMark</span> <span class="hljs-string">or</span> <span class="hljs-string">HTML.</span><br>      <span class="hljs-attr">responses:</span><br>        <span class="hljs-attr">&#x27;200&#x27;:</span>    <span class="hljs-comment"># status code</span><br>          <span class="hljs-attr">description:</span> <span class="hljs-string">A</span> <span class="hljs-string">JSON</span> <span class="hljs-string">array</span> <span class="hljs-string">of</span> <span class="hljs-string">user</span> <span class="hljs-string">names</span><br>          <span class="hljs-attr">content:</span><br>            <span class="hljs-attr">application/json:</span><br>              <span class="hljs-attr">schema:</span> <br>                <span class="hljs-attr">type:</span> <span class="hljs-string">array</span><br>                <span class="hljs-attr">items:</span> <br>                  <span class="hljs-attr">type:</span> <span class="hljs-string">string</span><br></code></pre></td></tr></table></figure></p><h3 id="客製化-CSS"><a href="#客製化-CSS" class="headerlink" title="客製化 CSS"></a>客製化 CSS</h3><p>Swagger UI 也有提供客製化功能<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> cssOptions = &#123;<br>  <span class="hljs-attr">customCss</span>: <span class="hljs-string">`</span><br><span class="hljs-string">  .topbar-wrapper img &#123;content:url(https://img.icons8.com/doodle/2x/-freelancefirm.png); width:50px; height:auto;&#125;</span><br><span class="hljs-string">  .swagger-ui table &#123; margin-left: 20px;</span><br><span class="hljs-string">    margin-top: 30px; &#125;</span><br><span class="hljs-string">  .swagger-ui .model &#123; font-size: 14px;</span><br><span class="hljs-string">    font-family: -apple-system,BlinkMacSystemFont,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial,&quot;Noto Sans&quot;,&quot;Liberation Sans&quot;,sans-serif,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Noto Color Emoji&quot;; &#125;</span><br><span class="hljs-string">  .swagger-ui .topbar &#123; background-color: #000000; border-bottom: 20px solid #5dc6d1; &#125;`</span>,<br>  <span class="hljs-attr">customSiteTitle</span>: <span class="hljs-string">&quot;API文件 | Hazel&quot;</span><br>&#125;;<br><br>app.use(<span class="hljs-string">&#x27;/docs&#x27;</span>, swaggerUi.serve, swaggerUi.setup(swaggerSpec, cssOptions));<br></code></pre></td></tr></table></figure></p><h3 id="踩坑紀錄"><a href="#踩坑紀錄" class="headerlink" title="踩坑紀錄"></a>踩坑紀錄</h3><p>Hazel 專案設定 app.js 之外，另外建立了 server.js，主要是用來連接 mongoose 資料庫及啟動伺服器 <code>app.listen</code>，我用上述方法寫在 server.js 沒有成功，到 localhost/apidoc會顯示找不到路由，但將 code 引入到 app.js 就成功了…原因不得而知</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://levelup.gitconnected.com/how-to-add-swagger-ui-to-existing-node-js-and-express-js-project-2c8bad9364ce">How to add Swagger UI to an existing Node.js and Express.js project</a></li><li><a href="https://easonwang.gitbook.io/web_advance/api-ce-shi/swagger/zhu-jie-xie-zai-code-nei-sheng-cheng-swagger-uii">註解寫在Code內生成swagger UI</a></li><li><a href="https://israynotarray.com/nodejs/20201229/1974873838/">使用 Swagger 自動生成 API 文件</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> swagger </category>
          
          <category> express </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>nodejs-express-session登入機制</title>
      <link href="//nodejs-express-session%E7%99%BB%E5%85%A5%E6%A9%9F%E5%88%B6/"/>
      <url>//nodejs-express-session%E7%99%BB%E5%85%A5%E6%A9%9F%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h2 id="安裝"><a href="#安裝" class="headerlink" title="安裝"></a>安裝</h2><p>通常 exress 實作登入機制時都會使用知名的 express-session，按照下列指令來安裝套件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i express-session --save<br></code></pre></td></tr></table></figure></p><h2 id="設定-express-session"><a href="#設定-express-session" class="headerlink" title="設定 express-session"></a>設定 express-session</h2><p>在 express 專案的 app.js 引入 <code>express-session</code></p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">const</span> <span class="hljs-variable">session</span> = <span class="hljs-function"><span class="hljs-title">require</span>(<span class="hljs-string">&#x27;express-session&#x27;</span>)</span><br></code></pre></td></tr></table></figure><p>並且用 <code>app.use</code> 來設定初始值</p><p>express-session 設定說明<br>Cookie 存的是 session id ，而 session data 則存在 server</p><ul><li>secret：必填選項，存放在 cookie 的 session ID</li><li>resave：每一次與使用者互動，是否強制保存 session 並更新到 session store 裡，預設是 true</li><li>saveUninitialized強制將未初始化的 session 存回 session store。未初始化表示這個 session 是新的而且沒有被修改過，例如未登入的使用者的 session。設定 false 可避免存入太多空的 session</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// Cookie 存的是 session id，session data 存 server</span><br>app.use(session(&#123;<br>  <span class="hljs-attr">secret</span>: <span class="hljs-string">&#x27;K,_r*p3h~7G&#125;hq]iL~#jIe7|DMB?E&#x27;</span>, <span class="hljs-comment">// 存放在 cookie 的 session id</span><br>  <span class="hljs-attr">resave</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 是否強制保存 session，預設是 true</span><br>  <span class="hljs-attr">saveUninitialized</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// session 還沒修改前是否存入 cookie，設定 false 可避免存入太多空的值</span><br>&#125;))<br><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> express </category>
          
          <category> expresss-session </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>sequlize 筆記</title>
      <link href="//sequlize%E7%94%A2%E7%94%9F%E7%A8%AE%E5%AD%90%E6%AA%94seed/"/>
      <url>//sequlize%E7%94%A2%E7%94%9F%E7%A8%AE%E5%AD%90%E6%AA%94seed/</url>
      
        <content type="html"><![CDATA[<h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><p>使用 Sequelize CLI 時，會用 npx sequelize init 完成初始化<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-variable">$ </span>npm install --save-dev sequelize-cli<br><span class="hljs-variable">$ </span>npx sequelize init<br></code></pre></td></tr></table></figure><br>為什麼會使用 npx 來呼叫，而非 npm？<br>如果我們在專案內呼叫 sequelize，會從專案內的 <code>node_modules 裡的 .bin</code> 資料夾找 sequelie 相關執行檔，也就是 <code>node_modules/.bin/sequelize</code> </p><p>安裝 npm 5.2版開始，也會附帶安裝 npx 工具包，npx的功用是「自動定位套件真正的安裝路徑」。<br>每個人電腦環境設定不同，有些人設定套件執行檔並非安裝在 <code>node_modules/.bin</code>上，在執行 sequelize 前必須先搞懂套件安裝的路徑在哪裡，才能去呼叫，因此才有了 <code>npx</code> 的工具存在。<br>以下介紹的指令皆會由 npx 來呼叫</p><h2 id="Seequelize-指令"><a href="#Seequelize-指令" class="headerlink" title="Seequelize 指令"></a>Seequelize 指令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 安裝 sequelize-cli</span><br>$ npm install --save-dev sequelize-cli<br><br><span class="hljs-comment"># 建立 User Model，屬性 firstName, lastName, email</span><br>$ npx sequelize-cli model:generate --name User --attributes firstName:string, lastName:string, email:string<br><br><span class="hljs-comment"># 跑 Migration</span><br>$ npx sequelize-cli db:migrate<br><span class="hljs-comment"># Migration 倒退</span><br>$ npx sequelize-cli db:migrate:undo<br><span class="hljs-comment"># Migration 退回指定版本</span><br>$ npx sequelize-cli db:migrate:undo:all --to XXXXXXXXXXXXXX-create-posts.js<br><br><span class="hljs-comment"># 產生 Seed</span><br>$ npx sequelize-cli seed:generate --name default-data<br><span class="hljs-comment"># 執行所有 Seed 檔</span><br>$ npx sequelize db:seed:all<br><span class="hljs-comment"># 加上 Undo 執行 Down 動作，復原</span><br>$ npx sequelize db:seed:undo:all<br><span class="hljs-comment"># Undo 復原取消產生某一個 Seed</span><br>$ npx sequelize-cli db:seed:undo --seed name-of-seed-as-in-data<br></code></pre></td></tr></table></figure><h2 id="Model-Querying-查詢"><a href="#Model-Querying-查詢" class="headerlink" title="Model Querying 查詢"></a>Model Querying 查詢</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 建立一筆資料</span><br><span class="hljs-keyword">const</span> hazel = <span class="hljs-keyword">await</span> User.create(&#123; <span class="hljs-attr">firstName</span>: <span class="hljs-string">&#x27;Hazel&#x27;</span>, <span class="hljs-attr">lastName</span>: <span class="hljs-string">&#x27;Wu&#x27;</span> &#125;)<br><br><span class="hljs-comment">// 查詢多筆資料，raw: true, nest: true，將多筆資料轉換物件</span><br>Todo.findAll(&#123;<br>  <span class="hljs-attr">raw</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">nest</span>: <span class="hljs-literal">true</span><br>&#125;)<br><br><span class="hljs-comment">// 查詢特定屬性，等同於 SELECT firstName from ...</span><br>Model.findAll(&#123; <span class="hljs-attr">attributes</span>: [<span class="hljs-string">&#x27;firstName&#x27;</span>] &#125;)<br><span class="hljs-comment">// 查詢指令並加上 WHERE，等同於 SELECT * FROM user WHERE userId = 2;</span><br>Model.findAll(&#123; <span class="hljs-attr">where</span>: userId: <span class="hljs-number">2</span> &#125;)<br><br><span class="hljs-comment">// 用條件查詢一筆資料</span><br>Model.findOne(&#123; <span class="hljs-attr">where</span>: &#123; email &#125; &#125;)<br><span class="hljs-comment">// 用 id 查詢一筆資料</span><br>Model.findByPk()<br></code></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://sequelize.org/master/manual/model-querying-finders.html">官方文件 Model Querying - Finders</a></li><li><a href="http://www.ruanyifeng.com/blog/2019/02/npx.html">阮一峰-npx 使用教程</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> sequlize </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>nodejs-建立資料庫mysql連線</title>
      <link href="//nodejs-%E5%BB%BA%E7%AB%8B%E8%B3%87%E6%96%99%E5%BA%ABmysql%E9%80%A3%E7%B7%9A/"/>
      <url>//nodejs-%E5%BB%BA%E7%AB%8B%E8%B3%87%E6%96%99%E5%BA%ABmysql%E9%80%A3%E7%B7%9A/</url>
      
        <content type="html"><![CDATA[<p>建立資料庫連線</p><ol><li>MySQL 建立 Todo 資料庫</li><li>Express 設定資料庫連線<ul><li>安裝 mysql2、sequelie、sequelie-cli</li><li>初始化<ul><li>設定資料庫名稱、密碼</li></ul></li></ul></li><li>設定 Model<ul><li>Todo Model</li><li>User Model</li></ul></li><li>設定 Todo &amp; User 關聯</li><li>完成註冊功能</li></ol><h2 id="MySQL-建立-Todo-資料庫"><a href="#MySQL-建立-Todo-資料庫" class="headerlink" title="MySQL 建立 Todo 資料庫"></a>MySQL 建立 Todo 資料庫</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">drop</span> database if <span class="hljs-keyword">exists</span> todo;<br><span class="hljs-keyword">create</span> todo;<br>use todo;<br></code></pre></td></tr></table></figure><p>輸入指令後，在MySQL WorkBench 按「⚡️」執行<br><img src="/../../../images/20220131/excute-mysql.png" alt="mysql"></p><h2 id="Express-設定資料庫連線"><a href="#Express-設定資料庫連線" class="headerlink" title="Express 設定資料庫連線"></a>Express 設定資料庫連線</h2><p>安裝相關的套件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install mysql2 sequelize sequelize-cli<br>npm run dev<br></code></pre></td></tr></table></figure></p><p>初始化 sequelize 腳本<br>執行初始化指令會自動幫你建立檔案<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">npx sequelize <span class="hljs-keyword">init</span><br></code></pre></td></tr></table></figure></p><p>順利設定成功，應該會出現下面的訊息<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Sequelize CLI [Node: <span class="hljs-number">12.6</span><span class="hljs-number">.0</span>, CLI: <span class="hljs-number">6.4</span><span class="hljs-number">.1</span>, ORM: <span class="hljs-number">6.15</span><span class="hljs-number">.0</span>]<br><br>Created <span class="hljs-string">&quot;config/config.json&quot;</span><br>Successfully created models <span class="hljs-built_in">folder</span> <span class="hljs-keyword">at</span> <span class="hljs-string">&quot;/Users/hazel/vhost/todo/models&quot;</span>.<br>Successfully created migrations <span class="hljs-built_in">folder</span> <span class="hljs-keyword">at</span> <span class="hljs-string">&quot;/Users/hazel/vhost/todo/migrations&quot;</span>.<br>Successfully created seeders <span class="hljs-built_in">folder</span> <span class="hljs-keyword">at</span> <span class="hljs-string">&quot;/Users/hazel/vhost/todo/seeders&quot;</span>.<br></code></pre></td></tr></table></figure><br>建立了哪些呢</p><ul><li>config/config.json，資料庫的設定檔</li><li>todo/models，Model的設定檔</li><li>todo/migrations，資料庫遷移檔，紀錄資料庫新增、修改哪些欄位，以和其他協作成員同步</li><li>todo/seeders，資料庫種子檔，用來生成資料用</li></ul><p><img src="../../../images/20220131/npx-sequelize-init.png" alt="npx-sequelize-init"></p><p>自動生成的 config.json 檔<br>其中有三個區塊：development、test、production，各有不同的用途<br><img src="../../../images/20220131/squelize-config-json.png" alt="npx-sequelize-config-json"></p><h3 id="產生-Todo-Model"><a href="#產生-Todo-Model" class="headerlink" title="產生 Todo Model"></a>產生 Todo Model</h3><p>設定Todo Modal</p><ul><li>name String 任務名稱</li><li>isDone Boolean 是否完成</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npx sequelize-cli model:generate --name Todo --attributes name:string,isDone:boolean<br></code></pre></td></tr></table></figure><p>輸入完後終端機會返回以下訊息<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gradle">Sequelize CLI [Node: <span class="hljs-number">12.6</span>.<span class="hljs-number">0</span>, CLI: <span class="hljs-number">6.4</span>.<span class="hljs-number">1</span>, ORM: <span class="hljs-number">6.15</span>.<span class="hljs-number">0</span>]<br><br><span class="hljs-keyword">New</span> model was created at <span class="hljs-regexp">/Users/</span>hazel<span class="hljs-regexp">/vhost/</span>todo<span class="hljs-regexp">/models/</span>todo.js .<br><span class="hljs-keyword">New</span> migration was created at <span class="hljs-regexp">/Users/</span>hazel<span class="hljs-regexp">/vhost/</span>todo<span class="hljs-regexp">/migrations/</span><span class="hljs-number">20220131073523</span>-create-todo.js .<br></code></pre></td></tr></table></figure><br>自動建立了以下檔案</p><ul><li>models/todo.js Todo 的 Model 設定檔，可定義資料欄位、資料關聯</li><li>todo/migrations/20220131073523-create-todo.js 資料庫遷移紀錄，可當作是Git版的資料庫，所有版本紀錄都會在 migrations 資料夾內</li></ul><h3 id="小知識：Migration-用處"><a href="#小知識：Migration-用處" class="headerlink" title="小知識：Migration 用處"></a>小知識：Migration 用處</h3><p>當你在開發新功能，在 User 資料表多新增了一個欄位叫「memo」，<br>通知團隊成員說你新增了 memo 欄位，請大家同步<br>其他團隊成員在自己的本地環境也必須手動新增 User memo 的欄位<br>這樣團隊們才可以跑本地環境時不會因為自己新加上的功能，但自己本地資料庫沒有那個欄位，導致程式壞掉</p><p>只要有 migration 就不必這麼麻煩<br>Migration 是資料庫的版本紀錄，只需要跑一個指令，會自動將版本紀錄變更的欄位同步到你的資料庫</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">npx sequelize-<span class="hljs-keyword">cli</span> <span class="hljs-keyword">db</span>:migrate<br></code></pre></td></tr></table></figure><p>成功後會自動產生 Todo 資料表及建立欄位。如果沒有成功，表示資料庫連線並未設立完全<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">$ npx sequelize db:migrate<br><br>Sequelize CLI [Node: 12.6.0, CLI: 6.4.1, ORM: 6.15.0]<br><br>Loaded configuration file &quot;config/config.json&quot;.<br>Using environment &quot;development&quot;.<br><span class="hljs-section">== 20220131073523-create-todo: migrating =======</span><br><span class="hljs-section">== 20220131073523-create-todo: migrated (0.019s)</span><br></code></pre></td></tr></table></figure></p><h3 id="命名規範"><a href="#命名規範" class="headerlink" title="命名規範"></a>命名規範</h3><p>Todo、todos？傻傻分不清？<br>在 MVC 的設計裡，Todo model 的變數命名皆是用單數大寫「Todo」<br>而在 MySQL 的指令裡，則會用複數小寫 todos 來代表資料表的名稱</p><h3 id="Sqeuelize-Migration"><a href="#Sqeuelize-Migration" class="headerlink" title="Sqeuelize Migration"></a>Sqeuelize Migration</h3><p>Migration 的概念就是資料庫的版本控制，當我們改資料庫的 Schema時都會去新增一個 migration 檔案<br>Sequeuelize會追蹤哪些 migration 已經合併，哪些還沒有使用過，並根據定義的 migration 去修改資料庫的欄位，又稱之為資料庫的版本控制。</p><p>一個 migration 一生中只會執行一次，migration 代表著每次對資料庫的修改紀錄，如果改錯了就再新增一次 migration 覆蓋過去即可。</p><p>用指令產生的檔案稱 migration，用動作來同步資料庫的 Schema 稱 migrate，一個名詞一個動詞，不要搞混。</p><p>資料遷移<br>通常會使用在初始化專案或團隊改動了資料庫 Schema，便會跑 migrate 來同步<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">npx</span> sequelize db:migrate<br></code></pre></td></tr></table></figure></p><p>查看現有版本<br>如果不清楚現在資料庫現在版本是多少，可以藉由這個指令更清楚了解現在在哪一個版本<br><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fortran">npx sequelize db:migrate:<span class="hljs-keyword">status</span><br></code></pre></td></tr></table></figure></p><p>還原到上一個版本<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">npx sequelize d<span class="hljs-variable">b:migrate</span>:<span class="hljs-keyword">undo</span><br></code></pre></td></tr></table></figure></p><p>還原到最初始版本<br>等同於作業系統重灌的概念<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">npx sequelize d<span class="hljs-variable">b:migrate</span>:<span class="hljs-keyword">undo</span>:<span class="hljs-keyword">all</span><br></code></pre></td></tr></table></figure></p><p>還原到特定版本<br>等同於<code>git checkout [commitID]</code> 或是 <code>git reset --mixed [commitID]</code><br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">npx sequelize d<span class="hljs-variable">b:migrate</span>:<span class="hljs-keyword">undo</span>:<span class="hljs-keyword">all</span> --<span class="hljs-keyword">to</span> XXXXXXX-create-user.js<br></code></pre></td></tr></table></figure></p><h2 id="設定關聯-Model"><a href="#設定關聯-Model" class="headerlink" title="設定關聯 Model"></a>設定關聯 Model</h2><ul><li>一個 User 擁有多個 Todo</li><li>一個 Todo 屬於特定的 User</li></ul><p>找到 assoicate的 function，這個區域是專門寫關聯的</p><p>model/user.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">associate</span>(<span class="hljs-params">models</span>)</span> &#123;<br>  User.hasMany(models.Todo)<br>&#125;<br><br></code></pre></td></tr></table></figure><br>model/todo.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-title">associate</span>(<span class="hljs-params">models</span>)</span> &#123;<br>  Todo.belongsTo(models.User)<br>&#125;<br></code></pre></td></tr></table></figure></p><p>建立關聯<br>命名清楚一點，加入「xxx」到「哪張表」<br>例如：我這次 migration 將 userId 欄位新增到 Todo 資料表，就會變成<code>add-userId-to-todo</code>，藉由黨名可以非常清楚這次遷移改變了什麼<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs verilog">npx sequelize migration:<span class="hljs-keyword">generate</span> --name add-userId-to-todo<br></code></pre></td></tr></table></figure></p><p>開啟剛產生的 add-userId-to-todo 檔案，加上關聯設定<br>定義 reference，讓 Todos 欄位新增 UserId，且是來自 User 資料表裡的 ID<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim">reference<span class="hljs-variable">s:</span> &#123;<br>  <span class="hljs-keyword">mode</span><span class="hljs-variable">l:</span> <span class="hljs-string">&#x27;Users&#x27;</span>,<br>  key: <span class="hljs-string">&#x27;id&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><br>完整程式碼<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-title">up</span>(<span class="hljs-params">queryInterface, Sequelize</span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> queryInterface.addColumn(<span class="hljs-string">&#x27;Todos&#x27;</span>, <span class="hljs-string">&#x27;UserId&#x27;</span>, &#123;<br>      <span class="hljs-attr">type</span>: Sequelize.INTEGER,<br>      <span class="hljs-attr">allowNull</span>: <span class="hljs-literal">false</span>,<br>      <span class="hljs-attr">references</span>: &#123;<br>        <span class="hljs-attr">model</span>: <span class="hljs-string">&#x27;Users&#x27;</span>,<br>        <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;id&#x27;</span><br>      &#125;<br>    &#125;)<br>  &#125;,<br><br>  <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-title">down</span>(<span class="hljs-params">queryInterface, Sequelize</span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> queryInterface.removeColumn(<span class="hljs-string">&#x27;Todos&#x27;</span>, <span class="hljs-string">&#x27;UserId&#x27;</span>)<br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure></p><ul><li>addColumn：新增欄位，通常定義在 up 上</li><li>removeColumn：移除欄位</li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://sequelize.org/master/manual/migrations.html#bootstrapping">初始化 Sequelize</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> nodejs </category>
          
          <category> sequelie </category>
          
          <category> mysql </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>使用MySQL Workbench</title>
      <link href="//%E4%BD%BF%E7%94%A8MySQL-Workbench/"/>
      <url>//%E4%BD%BF%E7%94%A8MySQL-Workbench/</url>
      
        <content type="html"><![CDATA[<p>MySQL 簡易的 SQL 練習</p><ol><li>新增名為 menu 的資料庫</li><li>在 menu 新增一個叫 type 的資料表，並且定義 schema:id、name，寫進四種資料，漢堡、吐司、蛋餅、乳酪餅</li></ol><h2 id="下載-MySQL-WorkBench"><a href="#下載-MySQL-WorkBench" class="headerlink" title="下載 MySQL WorkBench"></a>下載 MySQL WorkBench</h2><p>MySQL WorkBench 是一套 MYSQL UI 軟體，方便我們建立資料庫、查詢資料庫的內容、將資料新增至資料庫<br>由於 Hazel 是使用 Mac x86系統，並非m1晶片，故選擇「macOS 11 (x86, 64-bit)」下載</p><p>MacOS 官方下載：<a href="https://dev.mysql.com/downloads/mysql">連結</a><br><img src="../../images/20220131/mysql.png" alt="MySql WorkBench"></p><h2 id="設定-localhost-本地資料庫"><a href="#設定-localhost-本地資料庫" class="headerlink" title="設定 localhost 本地資料庫"></a>設定 localhost 本地資料庫</h2><ul><li>Connection Name: 任意取名，我取名叫 local</li><li>Connection Method: Standard(TCP/IP)</li><li>Hostname: 127.0.0.1</li><li>Port: 3006</li><li>Username: root</li><li>Password: 我設定 password，安裝mysql時初始化密碼填什麼這邊就填什麼</li></ul><p><img src="../../images/20220131/mysql-workbench-setup.png" alt="MySql WorkBench"></p><h2 id="建立資料庫"><a href="#建立資料庫" class="headerlink" title="建立資料庫"></a>建立資料庫</h2><p>建立資料庫前，按照習慣來說會先確定是否已存在同名的資料庫，如果有，則會先刪除資料庫<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">drop</span> database if <span class="hljs-keyword">exists</span> menus;<br></code></pre></td></tr></table></figure><br>再開始建立新的資料庫 menus，並使用 menus 資料庫<br><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf">create database menus<span class="hljs-comment">;</span><br>use menus<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure></p><h2 id="建立-Table"><a href="#建立-Table" class="headerlink" title="建立 Table"></a>建立 Table</h2><p>我們將建立一個 type 的類型資料表，裡面會存放早餐種類<br>設定的屬性會有</p><ul><li>id，並設定自動累加，id1、id2、…每新增一筆資料id會自動增加，<code>auto_increment</code></li><li>name，名稱，不允許空值的字串 <code>NOT NULL</code></li><li>以id作為不重複的主鍵 <code>primary key</code><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> `type` (<br>  `id` <span class="hljs-type">INT</span>( <span class="hljs-number">11</span> ) auto_increment,<br>  `name` <span class="hljs-type">VARCHAR</span>( <span class="hljs-number">255</span> ) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>  <span class="hljs-keyword">primary</span> key (`id`)<br>)<br></code></pre></td></tr></table></figure></li></ul><h2 id="插入資料"><a href="#插入資料" class="headerlink" title="插入資料"></a>插入資料</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">use menus;<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> `type` (name) <span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;hamburger&#x27;</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> `type` (name) <span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;toast&#x27;</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> `type` (name) <span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;chinese omelet&#x27;</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> `type` (name) <span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;cheese flatbread&#x27;</span>);<br></code></pre></td></tr></table></figure><p>最後插入完資料後我們可以下 <code>select</code> 指令來查看成果<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> `menus`;<br></code></pre></td></tr></table></figure></p><h2 id="完整-SQL"><a href="#完整-SQL" class="headerlink" title="完整 SQL"></a>完整 SQL</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">drop</span> database if <span class="hljs-keyword">exists</span> menus;<br><span class="hljs-keyword">create</span> database menus;<br>use menus;<br><br><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> `types` (<br>`id` <span class="hljs-type">INT</span>(<span class="hljs-number">11</span>) auto_increment,<br>    `name` <span class="hljs-type">VARCHAR</span>( <span class="hljs-number">255</span> ) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>    <span class="hljs-keyword">primary</span> key (`id`)<br>);<br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> `types` (name) <span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;egg&#x27;</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> `types` (name) <span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;hamburger&#x27;</span>);<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> menus.types;<br></code></pre></td></tr></table></figure><h2 id="新手知識"><a href="#新手知識" class="headerlink" title="新手知識"></a>新手知識</h2><ol><li>SQL 指令每一行必須要有冒號「;」做為結尾</li><li>SQL 非「case sensitive」語言，輸入大小寫皆視為相同，如果要特別區分大小寫，需要使用反引號 `，這樣 SQL 才會將反引號的內容視為「字串」，而非動作的關鍵字</li><li>MYSQL WorkBench <a href="https://dev.mysql.com/doc/workbench/en/wb-intro.html">使用指南</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue3 基本用法</title>
      <link href="//vue3%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/"/>
      <url>//vue3%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>此篇是寫下關於 Vue3 Composition API 基本用法</p><h2 id="定義資料"><a href="#定義資料" class="headerlink" title="定義資料"></a>定義資料</h2><p>在 vue2 中定義資料總是在 <code>data()</code> 去宣告，而在 vue3 則不同，有 ref、reactive 的方式</p><h3 id="Reactive"><a href="#Reactive" class="headerlink" title="Reactive"></a>Reactive</h3><ul><li>宣告的值一定要是物件，不可是純值</li><li>需使用 const，不可用 let，否則會失去雙向綁定</li></ul><h3 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h3><ul><li>Vue 自行定義的屬性</li><li>和 Reactive 相同，需使用 const，不可用 let，否則會失去雙向綁定</li><li>宣告的值不限定任何型別，可以是純值</li></ul><p>在實戰中 ref 會比 reactive 好用，且也是比較不會出錯的方式<br>不管是 ref、reactive 都要用 const 做宣告，才不會失去雙向綁定</p><h3 id="Vue2-範例"><a href="#Vue2-範例" class="headerlink" title="Vue2 範例"></a>Vue2 範例</h3><p>傳統在 Vue2 方式宣告 num<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">    &#123;&#123; num &#125;&#125;</span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">  <span class="hljs-attr">data</span>: (<span class="hljs-function">() =&gt;</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-attr">num</span>: <span class="hljs-number">1</span></span></span><br><span class="javascript"><span class="xml">  &#125;)</span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure></p><h3 id="Vue3-範例"><a href="#Vue3-範例" class="headerlink" title="Vue3 範例"></a>Vue3 範例</h3><p>在 Vue3 則是要另外引入 ref 或 reactive，全部都在 setup() 裡完成，並在 return 時返回曾宣告的資料<br>讀取資料或設定資料都要加上 value，例如：<code>num.value</code>、<code>person.value</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">    &#123;&#123; num &#125;&#125;</span><br><span class="xml">    &#123;&#123; person &#125;&#125;</span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-keyword">const</span> num = ref(<span class="hljs-number">1</span>)</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-built_in">console</span>.log(num.value)</span></span><br><span class="javascript"><span class="xml">    num.value = <span class="hljs-number">17</span></span></span><br><span class="javascript"><span class="xml"></span></span><br><span class="javascript"><span class="xml">    <span class="hljs-keyword">const</span> person = ref(&#123;</span></span><br><span class="javascript"><span class="xml">      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Hazel&#x27;</span></span></span><br><span class="javascript"><span class="xml">    &#125;)</span></span><br><span class="javascript"><span class="xml"></span></span><br><span class="javascript"><span class="xml">    <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="javascript"><span class="xml">      num,</span></span><br><span class="javascript"><span class="xml">      person</span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml">  &#125;</span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h2 id="props-接收及傳遞"><a href="#props-接收及傳遞" class="headerlink" title="props 接收及傳遞"></a>props 接收及傳遞</h2><p>在 Vue2 中，我們通常會用 props 接收來自父元件的參數<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 父元件</span><br>&lt;template&gt;<br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">children</span> <span class="hljs-attr">:text</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span></span><br>&lt;/template&gt;<br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml">  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;傳給子元件&#x27;</span></span></span><br><span class="javascript"><span class="xml">  &#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><br><span class="hljs-comment">// 子元件</span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">  子元件</span><br><span class="xml">  &#123;&#123; text &#125;&#125;</span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">props</span>: &#123;<br>    <span class="hljs-attr">text</span>: &#123;<br>      <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,<br>      <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">default</span>: <span class="hljs-string">&#x27;&#x27;</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><br>而在 Vue3，改為 setup寫法後，setup可接收 props 值、context 值</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params">props</span>)</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(props.text)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>唯一要注意的是，props值不可直接寫成 ES6 解構，如果要使用解構 prop，必須用 <code>toRefs</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; toRefs &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex</span><br><span class="hljs-string"></span><br><span class="hljs-string">setup(props) &#123;</span><br><span class="hljs-string">  const &#123; text &#125; = toRefs(props)</span><br><span class="hljs-string">  console.log(text.value)</span><br><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="使用-emit"><a href="#使用-emit" class="headerlink" title="使用 emit"></a>使用 emit</h2><p>子元件呼叫父元件事件，都會使用到 <code>emit</code></p><h3 id="Vue2-範例-1"><a href="#Vue2-範例-1" class="headerlink" title="Vue2 範例"></a>Vue2 範例</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">    子元件</span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;emit(&#x27;emitToParent&#x27;, 123)&quot;</span>&gt;</span></span><br><span class="xml">      範例emit按鈕</span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml">  // 父元件</span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">children</span> @<span class="hljs-attr">emitToParent</span>=<span class="hljs-string">&quot;emitToParent&quot;</span> /&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-comment">// 父元件</span></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">  <span class="hljs-attr">components</span>: &#123;</span></span><br><span class="javascript"><span class="xml">    children</span></span><br><span class="javascript"><span class="xml">  &#125;,</span></span><br><span class="javascript"><span class="xml">  <span class="hljs-attr">methods</span>: &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-function"><span class="hljs-title">emitToParent</span>(<span class="hljs-params">value</span>)</span> &#123;</span></span><br><span class="javascript"><span class="xml">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;父層接收到子層資料&#x27;</span>, value)</span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml">  &#125;</span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h3 id="Vue3-範例-1"><a href="#Vue3-範例-1" class="headerlink" title="Vue3 範例"></a>Vue3 範例</h3><p>在 setup 引入 context.emit，也可以用解構 <code>&#123; emit &#125;</code>來使用 emit<br>setup 接收兩個參數，第一個參數是 <code>props</code>，第二個參數則是 <code>context</code></p><p>子元件範例：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">    子元件</span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;emitToParent&quot;</span>&gt;</span></span><br><span class="xml">      範例emit按鈕</span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">    父元件</span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">children</span> @<span class="hljs-attr">emitToParent</span>=<span class="hljs-string">&quot;getData&quot;</span> /&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-comment">// 子元件</span></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params">props, &#123; emit &#125;</span>)</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-built_in">console</span>.log(emit)</span></span><br><span class="javascript"><span class="xml"></span></span><br><span class="javascript"><span class="xml">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">emitToParent</span>(<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="javascript"><span class="xml">      emit(<span class="hljs-string">&#x27;emitToParent&#x27;</span>, <span class="hljs-string">&#x27;子元件 -&gt; 父元件資料&#x27;</span>)</span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml">  &#125;</span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"><span class="hljs-comment">// 父元件</span></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">  <span class="hljs-attr">components</span>: &#123; children &#125;,</span></span><br><span class="javascript"><span class="xml">  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getData</span>(<span class="hljs-params">text</span>) </span>&#123;</span></span><br><span class="javascript"><span class="xml">      <span class="hljs-built_in">console</span>.log(text) <span class="hljs-comment">// 子元件 -&gt; 父元件資料</span></span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml"></span></span><br><span class="javascript"><span class="xml">    <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="javascript"><span class="xml">      getData</span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml">  &#125;</span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure></p><h2 id="ref-取得-DOM-物件"><a href="#ref-取得-DOM-物件" class="headerlink" title="$ref 取得 DOM 物件"></a>$ref 取得 DOM 物件</h2><p>在 Vue2 中呼叫 DOM 物件用法 </p><ul><li>設定：<code>&lt;button ref=&quot;btn&quot; /&gt;</code></li><li><p>讀取：<code>this.$refs[&#39;btn&#39;]</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;btn&quot;</span>&gt;</span>示範按鈕<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-function"><span class="hljs-title">mounted</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.$refs.btn)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>而在 Vue3 則是改為以下寫法<br>設定和 Vue2相同，一樣在 HTML 標籤上加入 ref=”btn”<br>另外要引入 ref、onMounted，最後必須 <code>return btn</code></p></li><li><p>設定：<code>&lt;button ref=&quot;btn&quot; /&gt;</code></p></li><li>讀取：<code>btn.value</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;btn&quot;</span>&gt;</span>示範按鈕<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br>&lt;/template&gt;<br><span class="hljs-comment">// 宣告 ref, onMounted</span><br><span class="hljs-keyword">const</span> &#123; ref, onMounted &#125; = Vue<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">const</span> btn = ref(<span class="hljs-literal">null</span>) <span class="hljs-comment">// undefined</span><br><br>    onMounted(<span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-built_in">console</span>.log(btn.value)<br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> &#123;<br>      btn<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h2 id="Provider、Inject-方法"><a href="#Provider、Inject-方法" class="headerlink" title="Provider、Inject 方法"></a>Provider、Inject 方法</h2><p>跨元件層級的資料傳遞 Provider<br>假設是在最外層，可以運用 Provider 方法直接將資料傳到最內層<br>在父層使用 provide 傳出去，在子層用 inject 接收 <code>inject: [&#39;user&#39;]</code></p><p>傳遞<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">provide</span><span class="hljs-params">(<span class="hljs-string">&#x27;user&#x27;</span>, user)</span></span><br></code></pre></td></tr></table></figure><br>接收<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">inject</span><span class="hljs-params">(<span class="hljs-string">&#x27;user&#x27;</span>)</span></span><br></code></pre></td></tr></table></figure></p><h3 id="Vue2-寫法"><a href="#Vue2-寫法" class="headerlink" title="Vue2 寫法"></a>Vue2 寫法</h3><p>子層<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script&gt;<br><span class="hljs-keyword">const</span> children = &#123;<br>  <span class="hljs-attr">inject</span>: [<span class="hljs-string">&#x27;user&#x27;</span>],<br>  <span class="hljs-attr">template</span>: <span class="hljs-string">`&lt;div&gt;</span><br><span class="hljs-string">  &#123;&#123; user.name &#125;&#125;</span><br><span class="hljs-string">  &#123;&#123; user.uuid &#125;&#125;</span><br><span class="hljs-string">&lt;/div&gt;`</span>,<br><br>  <span class="hljs-function"><span class="hljs-title">created</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.user)<br>    <span class="hljs-built_in">this</span>.user.name = <span class="hljs-string">&#x27;Hazel&#x27;</span><br>  &#125;<br>&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><br>最外層<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script&gt;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">components</span>: &#123; children &#125;,<br>  <span class="hljs-function"><span class="hljs-title">data</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">user</span>: &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Ellie&#x27;</span>,<br>        <span class="hljs-attr">uuid</span>: <span class="hljs-number">1348560</span><br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-function"><span class="hljs-title">provide</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-comment">// provide function 也必須用 return</span><br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">user</span>: <span class="hljs-built_in">this</span>.user<br>    &#125;<br>  &#125;<br>&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure></p><h3 id="Vue3-範例-2"><a href="#Vue3-範例-2" class="headerlink" title="Vue3 範例"></a>Vue3 範例</h3><p>children 子元件，引入 inject 來接收 user 參數<br>子元件使用，如果會改變 user 值時，會避免影響到父層，建議使用淺層或深層拷貝方式處理</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; inject &#125; <span class="hljs-keyword">from</span> Vue<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params">props</span>)</span> &#123;<br>    <span class="hljs-keyword">const</span> person = inject(<span class="hljs-string">&#x27;user&#x27;</span>)<br><br>    <span class="hljs-keyword">return</span> &#123;<br>      person<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>父元件引入 provide，傳遞 user 物件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; ref, provide &#125; = Vue<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">components</span>: &#123; children &#125;,<br>  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">const</span> user = ref(&#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Ellie&#x27;</span>,<br>      <span class="hljs-attr">uuid</span>: <span class="hljs-number">1348560</span><br>    &#125;)<br><br>    <span class="hljs-comment">// 自定義名稱，要發送的資料內容</span><br>    provide(<span class="hljs-string">&#x27;user&#x27;</span>, user)<br><br>    <span class="hljs-keyword">return</span> &#123;<br>      user<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="Watch"><a href="#Watch" class="headerlink" title="Watch"></a>Watch</h2><p>引入 watch，在 setup 設定 watch function</p><h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; watch &#125; = Vue<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> &#123;<br>    watch(監聽的變數, <span class="hljs-function">(<span class="hljs-params">newValue, oldValue</span>) =&gt;</span> &#123;<br>      ...<br>    &#125;)<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="深層監聽"><a href="#深層監聽" class="headerlink" title="深層監聽"></a>深層監聽</h3><p>深層監聽物件屬性，加上 <code>deep: true</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">watch(<span class="hljs-function">() =&gt;</span> watchObject.value.skill, <span class="hljs-function">(<span class="hljs-params">newVal, oldVal</span>) =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(newVal, oldVal)<br>&#125;)<br>watch(watchObject, <span class="hljs-function">(<span class="hljs-params">newVal, oldVal</span>) =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(newVal, oldVal)<br>&#125;, &#123; <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> &#125;)<br></code></pre></td></tr></table></figure></p><h3 id="多值監聽"><a href="#多值監聽" class="headerlink" title="多值監聽"></a>多值監聽</h3><p>需要監聽多個變數，可以用陣列監聽。但如果在同一個 function 裡同時改變這些監聽來源，watch 只會執行一次<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> firstName = ref(<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-keyword">const</span> lastName = ref(<span class="hljs-string">&#x27;&#x27;</span>)<br><br>watch([firstName, lastName], <span class="hljs-function">(<span class="hljs-params">newValues, preValues</span>) =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(newValues, preValues)<br>&#125;)<br><span class="hljs-comment">// 若監聽是深度嵌套对象或数组中的屬性改變，要加上 deep</span><br>watch([firstName, lastName], <span class="hljs-function">(<span class="hljs-params">newValues, preValues</span>) =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(newValues, preValues)<br>  &#125;, <br>  &#123; <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> &#125;<br>)<br><br>firstName.value = <span class="hljs-string">&#x27;Hazel&#x27;</span> <span class="hljs-comment">// Logs: [&#x27;Hazel&#x27;, &#x27;&#x27;] [&#x27;&#x27;, &#x27;&#x27;]</span><br>lastName.value = <span class="hljs-string">&#x27;Wu&#x27;</span> <span class="hljs-comment">// Logs: [&#x27;Hazel&#x27;, &#x27;Wu&#x27;] [&#x27;Hazel&#x27;, &#x27;&#x27;]</span><br></code></pre></td></tr></table></figure></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; ref, watch &#125; = Vue<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params">props</span>)</span> &#123;<br><br>    <span class="hljs-comment">// 文字</span><br>    <span class="hljs-keyword">const</span> name = ref(<span class="hljs-string">&#x27;Hazel&#x27;</span>)<br>  <br>    watch(name, <span class="hljs-function">(<span class="hljs-params">newValue, oldValue</span>) =&gt;</span> &#123;<br>      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`新：<span class="hljs-subst">$&#123;newValue&#125;</span>，舊：<span class="hljs-subst">$&#123;oldValue&#125;</span>`</span>)<br>    &#125;)<br><br>    <span class="hljs-comment">// 物件</span><br>    <span class="hljs-keyword">const</span> watchObject = ref(&#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Hazel&#x27;</span>,<br>      <span class="hljs-attr">skill</span>: [<br>        <span class="hljs-string">&#x27;js&#x27;</span>,<br>        <span class="hljs-string">&#x27;vue&#x27;</span>,<br>        <span class="hljs-string">&#x27;nodejs&#x27;</span><br>      ]<br>    &#125;)<br><br>    <span class="hljs-comment">// 物件深層監聽，需要加上箭頭函示</span><br>    watch(<span class="hljs-function">() =&gt;</span> watchObject.value.skill, <span class="hljs-function">(<span class="hljs-params">newValue, oldValue</span>) =&gt;</span> &#123;<br>      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`新：<span class="hljs-subst">$&#123;newValue&#125;</span>，舊：<span class="hljs-subst">$&#123;oldValue&#125;</span>`</span>)<br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> &#123;<br>      name,<br>      watchObject<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="WatchEffect"><a href="#WatchEffect" class="headerlink" title="WatchEffect"></a>WatchEffect</h2><p>WatchEffect 是 Vue3 獨有的，和 Watch 有些不同</p><p>WatchEffect</p><ol><li>使用上較隨性，不需要指定需要監聽的變數。但 Watch 需要指定監聽哪個變數</li><li>WatchEffect 可以被停止，但 Watch 不能</li><li>WatchEffect 無法取得前一個值，但 Watch 可以取得被修改前的值</li></ol><h3 id="基本用法-1"><a href="#基本用法-1" class="headerlink" title="基本用法"></a>基本用法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; watchEffect &#125; <span class="hljs-keyword">from</span> Vue<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-function"><span class="hljs-title">setup</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">const</span> num = ref(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">const</span> name = ref(<span class="hljs-string">&#x27;Hazel&#x27;</span>)<br><br>    watchEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-built_in">console</span>.log(num)<br>      <span class="hljs-built_in">console</span>.log(name)<br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="WatchEffect-停止"><a href="#WatchEffect-停止" class="headerlink" title="WatchEffect 停止"></a>WatchEffect 停止</h3><p>宣告變數 stopWatchEffect 並執行 watchEffect function<br>只要執行 <code>stopWatchEffect</code> 監聽便會停止<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> stopWatchEffect = watchEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>  num.value++<br>  <span class="hljs-built_in">console</span>.log(num)<br><br>  <span class="hljs-keyword">if</span> (num.value === <span class="hljs-number">5</span>) stopWatchEffect()<br>&#125;)<br></code></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> vue3 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>JS常用正則</title>
      <link href="//JS%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%89%87/"/>
      <url>//JS%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%89%87/</url>
      
        <content type="html"><![CDATA[<p>專案常用的 Javascript 正則表達</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 驗證金額，格式：正整數、小數點不超過兩位</span><br><span class="hljs-keyword">const</span> amountReg = <span class="hljs-regexp">/^(([1-9][0-9]*)|(([0]\.\d&#123;1,2&#125;|[1-9][0-9]*\.\d&#123;1,2&#125;)))$/</span><br><span class="hljs-comment">// 版本號限制，格式v1.0.1，不可輸入到百位數字，例如：v000.000.000, v.00.00.00</span><br><span class="hljs-keyword">const</span> versionReg = <span class="hljs-regexp">/^v[1-9]?\d&#123;1&#125;\.[1-9]?\d&#123;1&#125;\.[1-9]?\d&#123;1&#125;$/</span><br><span class="hljs-comment">// 加上千分位，例 7654321 -&gt; 7,654,321</span><br><span class="hljs-keyword">let</span> num = num.toString()<br><span class="hljs-keyword">return</span> num.replace(<span class="hljs-regexp">/\B(?&lt;!\.\d*)(?=(\d&#123;3&#125;)+(?!\d))/g</span>, <span class="hljs-string">&#x27;,&#x27;</span>)<br><span class="hljs-comment">// IP驗證</span><br><span class="hljs-keyword">const</span> ipReg = <span class="hljs-regexp">/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.)&#123;3&#125;(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/</span><br><span class="hljs-comment">// 只允許輸入小數點第0-5位</span><br><span class="hljs-keyword">const</span> validateRtp = <span class="hljs-regexp">/^(([1-9]&#123;1&#125;\d*)|0).\d&#123;0,5&#125;$/</span><br><span class="hljs-comment">// 大小寫英文+數字+下底線</span><br><span class="hljs-keyword">const</span> validEnAndNumberAndSymbolsReg = <span class="hljs-regexp">/^[a-zA-Z0-9_]+$/</span><br><span class="hljs-comment">// 僅接受大小寫英文、數字、-、底線，不能含有空格</span><br><span class="hljs-keyword">const</span> pattern = <span class="hljs-regexp">/^[A-Za-z0-9-_/S]*$/</span><br><span class="hljs-keyword">return</span> pattern.test(str)<br><br><span class="hljs-comment">// 檢查網址是否為圖片檔</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkUrlIsImage</span>(<span class="hljs-params">url</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> (url.match(<span class="hljs-regexp">/\.(jpeg|jpg|gif|png|svg)$/</span>) != <span class="hljs-literal">null</span>)<br>&#125;<br><span class="hljs-comment">// 檢查網址是否為檔案</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkUrlIsFile</span>(<span class="hljs-params">url</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> (url.match(<span class="hljs-regexp">/\.(xlsx|xls|doc|txt|text)$/</span>) != <span class="hljs-literal">null</span>)<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>常用指令</title>
      <link href="//%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/"/>
      <url>//%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h3 id="重新命名-Key"><a href="#重新命名-Key" class="headerlink" title="重新命名 Key"></a>重新命名 Key</h3><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery">db.cost_set.<span class="hljs-keyword">update</span>(&#123;&#125;, &#123; <span class="hljs-variable">$rename:</span> &#123; <span class="hljs-string">&quot;rate.1&quot;</span>: <span class="hljs-string">&quot;rate.hazel&quot;</span>&#125;&#125;,<span class="hljs-built_in"> false</span>,<span class="hljs-built_in"> true</span>);<br></code></pre></td></tr></table></figure><h3 id="移除-Key-值"><a href="#移除-Key-值" class="headerlink" title="移除 Key 值"></a>移除 Key 值</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">db.&lt;collection-name&gt;.update(&#123;&#125;, &#123;<span class="hljs-symbol">$u</span>nset: &#123;&lt;field1&gt;:<span class="hljs-number">1</span>&#125;&#125;, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);<br>db.cost_set.update(&#123;&#125;, &#123; <span class="hljs-symbol">$u</span>nset: &#123; <span class="hljs-string">&quot;rate.2&quot;</span>: <span class="hljs-number">1</span> &#125;&#125;, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);<br></code></pre></td></tr></table></figure><h1 id="檢查資料-key-值是否有重複"><a href="#檢查資料-key-值是否有重複" class="headerlink" title="檢查資料 key 值是否有重複"></a>檢查資料 key 值是否有重複</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-title">checkDuplicateKey</span>(<span class="hljs-params"></span>)</span> &#123;<br>  <span class="hljs-keyword">const</span> keyArray = <span class="hljs-built_in">this</span>.form.param.map(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.code)<br>  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>()<br>  <span class="hljs-keyword">const</span> repeat = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>()<br><br>  keyArray.forEach(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>    result.has(item) ? repeat.add(item) : result.add(item)<br>  &#125;)<br><br>  <span class="hljs-keyword">if</span> (repeat.size &gt; <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-comment">// 警示訊息：有重複設定參數，請再重新檢查</span><br>    <span class="hljs-built_in">this</span>.$alert(<span class="hljs-built_in">this</span>.$t(<span class="hljs-string">&#x27;error.duplicateDarameter&#x27;</span>), <span class="hljs-built_in">this</span>.$t(<span class="hljs-string">&#x27;global.error&#x27;</span>), &#123;<br>      <span class="hljs-attr">confirmButtonText</span>: <span class="hljs-built_in">this</span>.$t(<span class="hljs-string">&#x27;global.ok&#x27;</span>),<br>      <span class="hljs-attr">dangerouslyUseHTMLString</span>: <span class="hljs-literal">true</span><br>    &#125;)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>  &#125;<br><br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://studio3t.com/knowledge-base/articles/common-mongodb-commands/">13 Most Common MongoDB Commands</a></li><li><a href="https://www.youtube.com/watch?v=hCS-F0vD_sw&amp;list=PLRTey0Iqj9jh-jHliSx7VraA99N7s5RtN&amp;index=5">MongoDB 201_L2-E1 » Using IntelliShell to build and run find statements</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Vscode eslint 與 prettier 衝突</title>
      <link href="//Vscode-eslint-%E8%88%87-prettier-%E8%A1%9D%E7%AA%81/"/>
      <url>//Vscode-eslint-%E8%88%87-prettier-%E8%A1%9D%E7%AA%81/</url>
      
        <content type="html"><![CDATA[<p>解決 Eslint 與 Prettier 之間的衝突</p><p>使用 Vscode 同時設定了 Prettier、Eslint 存檔時自動格式化，導致會出現衝突，如下圖<br><img src="../../../images/20211112/vscodeAndEslintAndPrettier.gif" alt="Vscode Prettier Eslint 衝突"><br>可以看見點擊 cmd+s 存檔後，格式化成功了又會馬上變回別種不合格的格式，這個問題困擾了我很久，在此紀錄</p><h2 id="衝突原因"><a href="#衝突原因" class="headerlink" title="衝突原因"></a>衝突原因</h2><p>衝突的原因不外乎是專使用 Prettier, Eslint，而且也同時開啟自動格式化、自動 fix 程式碼的功能，就是下面這兩行，罪魁禍首！</p><p>// .vscode/setting.json<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-comment">// 存檔後，prettier 自動格式化</span><br>  <span class="hljs-attr">&quot;eslint.enable&quot;</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-comment">// 存檔後，啟用 eslint --fix 自動格式化程式碼</span><br>  <span class="hljs-attr">&quot;editor.codeActionsOnSave&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;source.fixAll.stylelint&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">&quot;source.fixAll&quot;</span>: <span class="hljs-literal">true</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><br>不過我設定寫的很分散，一個 prettier 設定在 .vscode/setting.json，另一個 eslint 格式化設定在 vscode/setting.json 自身的設定檔內<br>如果你的專案有和其他人一起合作，建議直接寫在 .vscode/setting.json 資料夾內，優先順序會先讀取專案內的 .vscode/setting.json，再來才是讀取 vscode 本身的偏好設定</p><h2 id="解決方式"><a href="#解決方式" class="headerlink" title="解決方式"></a>解決方式</h2><p>把 prettier 的自動格式化關閉即可<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-comment">// eslint.enable 改為 false</span><br>  <span class="hljs-attr">&quot;eslint.enable&quot;</span>: <span class="hljs-literal">false</span>,<br><br>  <span class="hljs-comment">// 存檔後，啟用 eslint --fix 自動格式化程式碼</span><br>  <span class="hljs-attr">&quot;editor.codeActionsOnSave&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;source.fixAll.stylelint&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">&quot;source.fixAll&quot;</span>: <span class="hljs-literal">true</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://juejin.cn/post/7012160233061482532">解决Eslint 和 Prettier 之间的冲突</a></li><li><a href="https://zhuanlan.zhihu.com/p/103492877">詳解VSCode 格式化不符合预期的问题</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Nodejs 使用 JWT 送 Cookie</title>
      <link href="//Nodejs-%E4%BD%BF%E7%94%A8-JWT-%E9%80%81-Cookie/"/>
      <url>//Nodejs-%E4%BD%BF%E7%94%A8-JWT-%E9%80%81-Cookie/</url>
      
        <content type="html"><![CDATA[<p>Express 框架利用 Cookie 來送出 JWT，進行安全驗證。我們會利用 express 提供的 res.cookie 來進行實作</p><h2 id="設定環境變數"><a href="#設定環境變數" class="headerlink" title="設定環境變數"></a>設定環境變數</h2><p>打開 config.env 檔，這個檔案主要存放所有的環境變數，設定JWT_COOKIE_EXPIRES_IN，我們預設 Cookie 90天後過期</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs env">JWT_SECRET=sVNJpMqNcYwJ.lahq2343x4$234123^Ll!&amp;H&gt;+B&#123;*]QS/i+zCw+y1&gt;QRlMMf8Viiz2345+d<br>JWT_EXPIRES_IN=90d<br>JWT_COOKIE_EXPIRES_IN=90<br></code></pre></td></tr></table></figure><h2 id="設定-cookie"><a href="#設定-cookie" class="headerlink" title="設定 cookie"></a>設定 cookie</h2><h3 id="參數說明"><a href="#參數說明" class="headerlink" title="參數說明"></a>參數說明</h3><p>res.cookie 的參數說明</p><ul><li>expire<br>expires 表示 cookie 什麼時後過期，我們希望90天後過期，取得環境變數 process.env.JWT_COOKIE_EXPIRES_IN 之後，乘上 24 (轉換天數)，乘上 60(轉換成小時)，再乘上 60(轉換成分)，最後再乘 1000(轉換成毫秒)<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">expires: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<br>  <span class="hljs-built_in">Date</span>.now() + process.env.JWT_COOKIE_EXPIRES_IN * <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span><br>)<br></code></pre></td></tr></table></figure></li><li><p>secure<br>secure 在官方文件上解釋：<code>Marks the cookie to be used with HTTPS only.</code>，有設 定 secure 表示只含有 HTTPS 才會送出。當你的客戶端是 HTTP，沒有含有 SSL憑證時，cookie 便不會送出。<br>但在開發環境時通常不會設定 HTTPS，可以特別加上判斷，如果環境是production，才加上 <code>secure: true</code></p></li><li><p>httpOnly<br>httpOnly 官方文件解釋：<code>Flags the cookie to be accessible only by the web server.</code>，若設定 httpOnly: true，表示 cookie 標記只能由 Web Server 來訪問</p></li></ul><p>官方範例<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">res.cookie(<span class="hljs-string">&#x27;rememberme&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>, &#123; <br>  <span class="hljs-attr">expires</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-built_in">Date</span>.now() + <span class="hljs-number">900000</span>), <br>  <span class="hljs-attr">httpOnly</span>: <span class="hljs-literal">true</span> <br>&#125;)<br></code></pre></td></tr></table></figure></p><h3 id="完整程式碼"><a href="#完整程式碼" class="headerlink" title="完整程式碼"></a>完整程式碼</h3><p>Express 提供 res.cookie 方法<br><code>res.cookie(name, value [, options])</code><br>我們設定傳給客戶端 jwt 的 cookie，值是 jwt 產生</p><ul><li>返回的 cookie 名稱: jwt</li><li>cookie jwt 值則是 jsonwebtoken 產生的 Token 值，帶入變數 token</li><li>cookieOptions: 我們設定 expires, httpOnly 這兩個選項，並特別設定如果是 production 環境時才將 secure 設定為 true</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> cookieOptions = &#123;<br>  <span class="hljs-attr">expires</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<br>    <span class="hljs-built_in">Date</span>.now() + process.env.JWT_COOKIE_EXPIRES_IN * <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>,<br>  ),<br>  <span class="hljs-attr">httpOnly</span>: <span class="hljs-literal">true</span>,<br>&#125;<br><br>res.cookie(<span class="hljs-string">&#x27;jwt&#x27;</span>, token, cookieOptions)<br></code></pre></td></tr></table></figure><p>因此 API 除了返回 json 也會返回名叫 jwt 的 cookie ，並於 90 天後過期</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> jwt = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;jsonwebtoken&#x27;</span>)<br><span class="hljs-keyword">const</span> signToken = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> jwt.sign(&#123;id&#125;, process.env.JWT_SECRET, &#123;<br>  <span class="hljs-attr">expiresIn</span>: process.env.JWT_EXPIRES_IN<br>&#125;)<br><br><span class="hljs-keyword">const</span> createSendToken = <span class="hljs-function">(<span class="hljs-params">user, statusCode, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> token = signToken(user._id)<br>  <span class="hljs-keyword">const</span> cookieOptions = &#123;<br>    <span class="hljs-attr">expires</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<br>      <span class="hljs-built_in">Date</span>.now() + process.env.JWT_COOKIE_EXPIRES_IN * <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>,<br>    ),<br>    <span class="hljs-attr">httpOnly</span>: <span class="hljs-literal">true</span>,<br>  &#125;<br><br>  res.cookie(<span class="hljs-string">&#x27;jwt&#x27;</span>, token, cookieOptions)<br><br>  <span class="hljs-comment">// Remove password from output</span><br>  user.password = <span class="hljs-literal">undefined</span><br><br>  res.status(statusCode).json(&#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,<br>    token,<br>    <span class="hljs-attr">data</span>: &#123;<br>      user,<br>    &#125;,<br>  &#125;)<br>&#125;<br><br><span class="hljs-built_in">exports</span>.signup = catchAsync(<span class="hljs-keyword">async</span> (req, res, next) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> &#123;<br>    name, email, password, passwordConfirm, passwordChangedAt,<br>  &#125; = req.body<br><br>  <span class="hljs-keyword">const</span> newUser = <span class="hljs-keyword">await</span> User.create(&#123;<br>    name,<br>    email,<br>    password,<br>    passwordConfirm,<br>    passwordChangedAt,<br>  &#125;)<br><br>  createSendToken(newUser, <span class="hljs-number">201</span>, res)<br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="測試"><a href="#測試" class="headerlink" title="測試"></a>測試</h2><p>在 Postman 打註冊或登入 API，如果上述都有設定成功，預期成功的結果會返回 Cookie，如下圖所示<br><img src="../../../images/20211108/使用 JWT 送 Cookie.png" alt="Postman成功返回Cookie"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://expressjs.com/zh-tw/api.html">Express官方文件：res.cookie</a></li><li><a href="https://www.udemy.com/course/nodejs-express-mongodb-bootcamp/learn/lecture/15065340?start=15#overview">[Udemy]Nodejs Express Bootcamp: Sending JWT via Cookie</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解決 Cannot read property range of null 錯誤</title>
      <link href="//%E8%A7%A3%E6%B1%BA-Cannot-read-property-range-of-null-%E9%8C%AF%E8%AA%A4-1/"/>
      <url>//%E8%A7%A3%E6%B1%BA-Cannot-read-property-range-of-null-%E9%8C%AF%E8%AA%A4-1/</url>
      
        <content type="html"><![CDATA[<h1 id="解決-Cannot-read-property-‘range’-of-null-錯誤"><a href="#解決-Cannot-read-property-‘range’-of-null-錯誤" class="headerlink" title="解決 Cannot read property ‘range’ of null 錯誤"></a>解決 Cannot read property ‘range’ of null 錯誤</h1><p>原因：.eslintrc.js 設置的 parser: ‘babel-eslint’<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">parserOptions: &#123;<br>  <span class="hljs-attr">parser</span>: <span class="hljs-string">&#x27;babel-eslint&#x27;</span>,<br>  <span class="hljs-attr">ecmaVersion</span>: <span class="hljs-number">2017</span>,<br>  <span class="hljs-attr">sourceType</span>: <span class="hljs-string">&#x27;module&#x27;</span><br>&#125;,<br></code></pre></td></tr></table></figure></p><p>之所以報錯，原因來自於 Router import 元件採用動態引入的方式<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js">component: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">`@/views/<span class="hljs-subst">$&#123;param&#125;</span>/5.index/home`</span>) <span class="hljs-comment">// 首頁</span><br><br>&#123;<br>  <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/preferentialActivity&#x27;</span>,<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;preferentialActivity&#x27;</span>,<br>  <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span><br>    <span class="hljs-keyword">import</span>(<br>      <span class="hljs-comment">/* webpackChunkName: &quot;preferential-activity&quot; */</span> <span class="hljs-string">`../views/<span class="hljs-subst">$&#123;param&#125;</span>/2.preferentialActivity`</span><br>    ), <span class="hljs-comment">// 優惠活動</span><br>  <span class="hljs-attr">meta</span>: &#123;<br>    <span class="hljs-attr">requiresAuth</span>: <span class="hljs-literal">true</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><br>網路上查到兩種解法，第一種是降低babel-eslint 的版本、第二種是改懶加載的寫法</p><p>先說第二種，改寫懶加載寫法</p><p>將 <code>() =&gt; import</code> 懶加載改成舊寫法便可以成功，但問題在於 <code>resolve =&gt; require</code> 這種寫法無法使用 Webpack 異步分組模塊 webpackChunkName，神奇的註解可以打包時，將相同元件打包成同一隻 js。由於專案日漸龐大，需要懶加載但又不希望分太多隻 js，所以這個方法雖然可以解決問題，但並不採用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 改寫成 resolve =&gt; require</span><br><span class="hljs-attr">component</span>: <span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">require</span>([<span class="hljs-string">`@/views/<span class="hljs-subst">$&#123;param&#125;</span>/5.index/home`</span>], resolve)<br></code></pre></td></tr></table></figure><p>看官方文件 babel-eslint，發現已不支援<br><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ceylon">babel-eslint <span class="hljs-keyword">is</span> now <span class="hljs-meta">@babel</span>/eslint-parser. This <span class="hljs-keyword">package</span> will no longer receive updates.<br><span class="hljs-meta">@babel</span>/eslint-parser<br></code></pre></td></tr></table></figure></p><h2 id="無效方法"><a href="#無效方法" class="headerlink" title="無效方法"></a>無效方法</h2><h3 id="babel-eslint-升級版本-11-0-0-beta-2-D"><a href="#babel-eslint-升級版本-11-0-0-beta-2-D" class="headerlink" title="babel-eslint 升級版本 11.0.0-beta.2 -D"></a>babel-eslint 升級版本 11.0.0-beta.2 -D</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">npm</span> i babel-eslint@<span class="hljs-number">11</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>-beta.<span class="hljs-number">2</span> -D<br></code></pre></td></tr></table></figure><p>宣告無效</p><h4 id="babel-eslint-升級版本-10-0-3"><a href="#babel-eslint-升級版本-10-0-3" class="headerlink" title="babel-eslint 升級版本 10.0.3"></a>babel-eslint 升級版本 10.0.3</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">npm</span> i babel-eslint@<span class="hljs-number">10</span>.<span class="hljs-number">0</span>.<span class="hljs-number">3</span> -D<br></code></pre></td></tr></table></figure><p>宣告無效</p><h3 id="安裝-babel-plugin-syntax-dynamic-import"><a href="#安裝-babel-plugin-syntax-dynamic-import" class="headerlink" title="安裝 @babel/plugin-syntax-dynamic-import"></a>安裝 @babel/plugin-syntax-dynamic-import</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install --save-dev @babel/plugin-syntax-dynamic-import<br></code></pre></td></tr></table></figure><p>宣告無效</p><h3 id="安裝-babel-plugin-syntax-dynamic-import-1"><a href="#安裝-babel-plugin-syntax-dynamic-import-1" class="headerlink" title="安裝 @babel/plugin-syntax-dynamic-import"></a>安裝 @babel/plugin-syntax-dynamic-import</h3><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">plugins:</span> [<span class="hljs-string">&quot;@babel/plugin-syntax-dynamic-import&quot;</span>]<br></code></pre></td></tr></table></figure><p>宣告無效</p><p>###</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> install --save-dev @babel/eslint-parser @babel/eslint-plugin<br></code></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://www.twblogs.net/a/5ee5c8ceb4c39c99158fb321">解決Cannot read property ‘range’ of null 錯誤</a></li><li><a href="https://segmentfault.com/q/1010000020957304">vue路由懒加载报错</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Postman] 設定 JWT Token 環境變數</title>
      <link href="//Postman-%E8%A8%AD%E5%AE%9A-JWT-Token-%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8/"/>
      <url>//Postman-%E8%A8%AD%E5%AE%9A-JWT-Token-%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8/</url>
      
        <content type="html"><![CDATA[<h2 id="Postman-Test-設定"><a href="#Postman-Test-設定" class="headerlink" title="Postman Test 設定"></a>Postman Test 設定</h2><p>Login API 選擇 TEST 設定<br><img src="../../../images/20211020/postman-test.png" alt="Postman Test to setting environment accessToken"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">pm.environment.set(<span class="hljs-string">&#x27;accessToken&#x27;</span>, pm.response.json().token)<br></code></pre></td></tr></table></figure><p>根據你的 API 吐回的 Token 設定到 Postman 環境變數裡<br>設定好之後，每次打登入，API吐回的 token 會寫進 Postman 環境變數 accessToken 裡。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;status&quot;</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;token&quot;</span>: <span class="hljs-string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYxNmVlZTk5YWVlNjdiNDRkZWU5ODIyMCIsImlhdCI6MTYzNDY2MDQ3OCwiZXhwIjoxNjQyNDM2NDc4fQ.tyq6Dd32ROnIuVdCed3xQel6E-jg8YcaCRcoEqSQs44&quot;</span>,<br>    <span class="hljs-attr">&quot;message&quot;</span>: <span class="hljs-string">&quot;success!&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>登入 API，因返回 JSON 格式是 data.token，故在測試裡，pm.response.json() 表示返回來的 data，而要取得 token，故寫成 pm.response.json().token。</p><h3 id="Postman-Console"><a href="#Postman-Console" class="headerlink" title="Postman Console"></a>Postman Console</h3><p>如果一直取得不了你要的值，可以用 console.log 印出來，如圖下所示，開啟 Postman Console 視窗，在 Test 寫下 console.log 後重新請求，便會看到 console 控制台出現 pm.response.json()</p><p><img src="../../../images/20211020/postman-console.png" alt="Postman ConsoleLog"></p><h2 id="新增-Headers-Authoriazation"><a href="#新增-Headers-Authoriazation" class="headerlink" title="新增 Headers Authoriazation"></a>新增 Headers Authoriazation</h2><p>需要登入才可以請求的 API，例如 <code>/api/v1/tours</code>，開啟 Postman 這單支 API 切換到 headers<br>新增 Authorization: Bearer ，設定好後，當請求 <code>/api/v1/tours</code>，便會自動帶入 Postman accessToken 變數囉</p><p><img src="../../../images/20211020/postman-addHeaders.png" alt="Postman Add Headers Authorization"></p><p>另外也可以在 Tab Authorization 這裡設定，帶入  即可，兩個地方擇一都會有一樣效果，請求會自動代入環境變數 accessToken</p><p><img src="../../../images/20211020/postman-authorization.png" alt="Postman Authorization"></p>]]></content>
      
      
      
        <tags>
            
            <tag> postman </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Git] 寫一個好的 Commit Message</title>
      <link href="//Git-%E5%AF%AB%E4%B8%80%E5%80%8B%E5%A5%BD%E7%9A%84-Commit-Message/"/>
      <url>//Git-%E5%AF%AB%E4%B8%80%E5%80%8B%E5%A5%BD%E7%9A%84-Commit-Message/</url>
      
        <content type="html"><![CDATA[<ul><li>區分標題(Subject)與內容(body)，用一個斷行符合隔開</li></ul><h2 id="Subject-標題"><a href="#Subject-標題" class="headerlink" title="Subject 標題"></a>Subject 標題</h2><ol><li>首字大寫</li><li>標題不要超過 50 字，若超過50字，表示你這次 commit 太多東西，最好分拆開來</li><li>標題結尾不需要用句號來結尾</li></ol><h2 id="Body-內容"><a href="#Body-內容" class="headerlink" title="Body 內容"></a>Body 內容</h2><ol><li>每一行的內容控制在 72 字內</li><li>用內容來詳細解釋這個 commit 做了什麼</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Nodejs] Express 使用者註冊利用 JWT(jsonwebtoke)驗證</title>
      <link href="//Nodejs-Express-%E4%BD%BF%E7%94%A8%E8%80%85%E8%A8%BB%E5%86%8A%E5%88%A9%E7%94%A8-JWT-jsonwebtoke-%E9%A9%97%E8%AD%89/"/>
      <url>//Nodejs-Express-%E4%BD%BF%E7%94%A8%E8%80%85%E8%A8%BB%E5%86%8A%E5%88%A9%E7%94%A8-JWT-jsonwebtoke-%E9%A9%97%E8%AD%89/</url>
      
        <content type="html"><![CDATA[<p>Nodejs 用 Express 框架，使用者註冊 API，利用 JWT 產生令牌驗證使用者</p><h2 id="安裝-jsonwebtoken"><a href="#安裝-jsonwebtoken" class="headerlink" title="安裝 jsonwebtoken"></a>安裝 jsonwebtoken</h2><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> i jsonwebtoken<br><span class="hljs-built_in">npm</span> run start<br></code></pre></td></tr></table></figure><h2 id="使用-JWT"><a href="#使用-JWT" class="headerlink" title="使用 JWT"></a>使用 JWT</h2><p>在 authController.js 在 signup 時引用 jwt</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> jwt = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;jsonwebtoken&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="設定-JWT-環境變數"><a href="#設定-JWT-環境變數" class="headerlink" title="設定 JWT 環境變數"></a>設定 JWT 環境變數</h3><p>我們在環境變數上新增 JWT_SECRET、JWT_EXPIRES_IN<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs env">JWT_SECRET=sVNJpMqN34i5$JkSK4E%#255CK#sV3<br>JWT_EXPIRES_IN=90d<br></code></pre></td></tr></table></figure><br>JWT_EXPIRES_IN 90d 意味者 90天後過期，90天後 JWT 不再會有效，即使簽名是正確的，是一種額外的安全措施。<br>接著在回到 authController.js，利用 jwt.sign 方法，引用剛剛建立的 JWT 環境變數，來產生令牌</p><h3 id="設定-token"><a href="#設定-token" class="headerlink" title="設定 token"></a>設定 token</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> token = jwt.sign(&#123; <span class="hljs-attr">id</span>: newUser._id &#125;, process.env.JWT_SECRET, &#123;<br>  <span class="hljs-attr">expiresIn</span>: process.env.JWT_EXPIRES_IN,<br>&#125;)<br></code></pre></td></tr></table></figure><p>若令牌正確，回傳給客戶端令牌，Client端會以 cookie/storage 儲存令牌(token)</p><h3 id="回傳-Client端-token"><a href="#回傳-Client端-token" class="headerlink" title="回傳 Client端 token"></a>回傳 Client端 token</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> token = jwt.sign(&#123; <span class="hljs-attr">id</span>: newUser._id &#125;, process.env.JWT_SECRET, &#123;<br>  <span class="hljs-attr">expiresIn</span>: process.env.JWT_EXPIRES_IN,<br>&#125;)<br><br>res.status(<span class="hljs-number">201</span>).json(&#123;<br>  <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,<br>  token,<br>  <span class="hljs-attr">data</span>: &#123;<br>    <span class="hljs-attr">user</span>: newUser<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> jwt = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;jsonwebtoken&#x27;</span>)<br><span class="hljs-keyword">const</span> User = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../models/userModel&#x27;</span>)<br><span class="hljs-keyword">const</span> catchAsync = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../utils/catchAsync&#x27;</span>)<br><br><span class="hljs-built_in">exports</span>.signup = catchAsync(<span class="hljs-keyword">async</span> (req, res, next) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> &#123; name, email, password, passwordConfirm&#125;<br><br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="測試"><a href="#測試" class="headerlink" title="測試"></a>測試</h2><p>設定好之後，我們用 postman 打 /signup API，如果設定都正確，預期結果會回傳 JWT 產生的 token<br><img src="../../../images/20211018/token.png" alt="jwt success"></p><h2 id="JWT-Debugger"><a href="#JWT-Debugger" class="headerlink" title="JWT Debugger"></a>JWT Debugger</h2><p>Token 部分是由 Base64 編碼，我們可以在 <a href="jwt.io">jwt.io</a> 調試我們產生的 JWT Token，轉換回原本的 JSON 資料，同時也可以驗證該 Token 的正確性</p><p><img src="../../../images/20211018/jwtio.png" alt="JWT IO Screen Shot"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://medium.com/%E9%BA%A5%E5%85%8B%E7%9A%84%E5%8D%8A%E8%B7%AF%E5%87%BA%E5%AE%B6%E7%AD%86%E8%A8%98/%E7%AD%86%E8%A8%98-%E9%80%8F%E9%81%8E-jwt-%E5%AF%A6%E4%BD%9C%E9%A9%97%E8%AD%89%E6%A9%9F%E5%88%B6-2e64d72594f8">[筆記] 透過 JWT 實作驗證機制</a></li><li><a href="https://www.udemy.com/course/nodejs-express-mongodb-bootcamp/learn/lecture/15065210">[Udemy] Nodejs Express Mongodb Bootcamp - 註冊用戶</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Nodejs] bycrptjs 加密密碼</title>
      <link href="//Nodejs-bycrptjs-%E5%8A%A0%E5%AF%86%E5%AF%86%E7%A2%BC/"/>
      <url>//Nodejs-bycrptjs-%E5%8A%A0%E5%AF%86%E5%AF%86%E7%A2%BC/</url>
      
        <content type="html"><![CDATA[<p>打註冊（signup）API，使用者輸入的密碼，利用 Library bycrptjs 來加密密碼<br>成功畫面如下<br><img src="../../../images/20211018/20211018-brycptjs-pd.png" alt="signup success crypt password"></p><h2 id="安裝"><a href="#安裝" class="headerlink" title="安裝"></a>安裝</h2><p>會利用到 Mongoose、bycrptjs、validator，安裝後需重啟 Server<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> i brycrptjs<br><span class="hljs-built_in">npm</span> run start<br></code></pre></td></tr></table></figure></p><h2 id="建立-UserModel"><a href="#建立-UserModel" class="headerlink" title="建立 UserModel"></a>建立 UserModel</h2><p>建立 models/userModel.js，並定義 Schema，需要定義的欄位有 name, email, photo, password, passwordConfirm</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mongoose&#x27;</span>)<br><span class="hljs-keyword">const</span> validator = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;validator&#x27;</span>)<br><span class="hljs-keyword">const</span> bycrpt = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;bcryptjs)</span><br><span class="hljs-string"></span><br><span class="hljs-string">const userSchema = new mongoose.Schema(&#123;</span><br><span class="hljs-string">  name: &#123;</span><br><span class="hljs-string">    type: String,</span><br><span class="hljs-string">    required: [true, &#x27;</span>Please tell us your name!<span class="hljs-string">&#x27;],</span><br><span class="hljs-string">  &#125;,</span><br><span class="hljs-string">  email: &#123;</span><br><span class="hljs-string">    type: String,</span><br><span class="hljs-string">    required: [true, &#x27;</span>Please provide your email<span class="hljs-string">&#x27;],</span><br><span class="hljs-string">    unique: true,</span><br><span class="hljs-string">    lowercase: true,</span><br><span class="hljs-string">    validate: [validator.isEmail, &#x27;</span>Please provide a valid email<span class="hljs-string">&#x27;],</span><br><span class="hljs-string">  &#125;,</span><br><span class="hljs-string">  photo: String,</span><br><span class="hljs-string">  password: &#123;</span><br><span class="hljs-string">    type: String,</span><br><span class="hljs-string">    required: [true, &#x27;</span>Please provide a password<span class="hljs-string">&#x27;],</span><br><span class="hljs-string">    trim: true,</span><br><span class="hljs-string">    minlength: 8,</span><br><span class="hljs-string">  &#125;,</span><br><span class="hljs-string">  passwordConfirm: &#123;</span><br><span class="hljs-string">    type: String,</span><br><span class="hljs-string">    required: [true, &#x27;</span>Please confirm your password<span class="hljs-string">&#x27;],</span><br><span class="hljs-string">    validate: &#123;</span><br><span class="hljs-string">      // This only works on CREATE or SAVE!!</span><br><span class="hljs-string">      validator(el) &#123;</span><br><span class="hljs-string">        return el === this.password</span><br><span class="hljs-string">      &#125;,</span><br><span class="hljs-string">      message: &#x27;</span>Password are not the same!<span class="hljs-string">&#x27;,</span><br><span class="hljs-string">    &#125;,</span><br><span class="hljs-string">  &#125;,</span><br><span class="hljs-string">&#125;)</span><br><span class="hljs-string"></span><br><span class="hljs-string">const User = mongoose.model(&#x27;</span>User<span class="hljs-string">&#x27;, userSchema)</span><br><span class="hljs-string">module.exports = User</span><br></code></pre></td></tr></table></figure><h2 id="定義-Route"><a href="#定義-Route" class="headerlink" title="定義 Route"></a>定義 Route</h2><p>routes/userRoutes.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> userController = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../controllers/userController&#x27;</span>)<br><span class="hljs-keyword">const</span> authController = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../controllers/authController&#x27;</span>)<br><br>router.post(<span class="hljs-string">&#x27;/signup&#x27;</span>, authController.signup)<br></code></pre></td></tr></table></figure></p><h2 id="定義-AuthController"><a href="#定義-AuthController" class="headerlink" title="定義 AuthController"></a>定義 AuthController</h2><p>controllers/authController.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> User = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../models/userModel&#x27;</span>)<br><span class="hljs-keyword">const</span> catchAsync = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../utils/catchAsync&#x27;</span>)<br><br><span class="hljs-built_in">exports</span>.signup = catchAsync(<span class="hljs-keyword">async</span> (req, res, next) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> newUser = <span class="hljs-keyword">await</span> User.create(req.body)<br><br>  res.status(<span class="hljs-number">201</span>).json(&#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">data</span>: &#123;<br>      <span class="hljs-attr">user</span>: newUser,<br>    &#125;,<br>  &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure></p><h2 id="加密密碼"><a href="#加密密碼" class="headerlink" title="加密密碼"></a>加密密碼</h2><p>開啟 userModel.js，在存入 user 資料前做加密，會利用到 bycrpt.hash 方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js">userSchema.pre(<span class="hljs-string">&#x27;save&#x27;</span>, <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">next</span>) </span>&#123;<br>  <span class="hljs-comment">// Only run this function if password was actually modifeid</span><br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.isModified(<span class="hljs-string">&#x27;password&#x27;</span>)) <span class="hljs-keyword">return</span> next()<br><br>  <span class="hljs-comment">// Hash the password with cost of 12 加密密碼</span><br>  <span class="hljs-built_in">this</span>.password = <span class="hljs-keyword">await</span> bycrpt.hash(<span class="hljs-built_in">this</span>.password, <span class="hljs-number">12</span>)<br><br>  <span class="hljs-comment">// Delete passwordConfirm field</span><br>  <span class="hljs-built_in">this</span>.passwordConfirm = <span class="hljs-literal">undefined</span><br><br>  <span class="hljs-comment">// next step</span><br>  next()<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="完整程式碼"><a href="#完整程式碼" class="headerlink" title="完整程式碼"></a>完整程式碼</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mongoose&#x27;</span>)<br><span class="hljs-keyword">const</span> validator = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;validator&#x27;</span>)<br><span class="hljs-keyword">const</span> bycrpt = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;bcryptjs&#x27;</span>)<br><br><span class="hljs-comment">// name, email. photo, password, passwordConfirm</span><br><br><span class="hljs-keyword">const</span> userSchema = <span class="hljs-keyword">new</span> mongoose.Schema(&#123;<br>  <span class="hljs-attr">name</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,<br>    <span class="hljs-attr">required</span>: [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Please tell us your name!&#x27;</span>],<br>  &#125;,<br>  <span class="hljs-attr">email</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,<br>    <span class="hljs-attr">required</span>: [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Please provide your email&#x27;</span>],<br>    <span class="hljs-attr">unique</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">lowercase</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">validate</span>: [validator.isEmail, <span class="hljs-string">&#x27;Please provide a valid email&#x27;</span>],<br>  &#125;,<br>  <span class="hljs-attr">photo</span>: <span class="hljs-built_in">String</span>,<br>  <span class="hljs-attr">password</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,<br>    <span class="hljs-attr">required</span>: [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Please provide a password&#x27;</span>],<br>    <span class="hljs-attr">trim</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">minlength</span>: <span class="hljs-number">8</span>,<br>  &#125;,<br>  <span class="hljs-attr">passwordConfirm</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,<br>    <span class="hljs-attr">required</span>: [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Please confirm your password&#x27;</span>],<br>    <span class="hljs-attr">validate</span>: &#123;<br>      <span class="hljs-comment">// This only works on CREATE or SAVE!!</span><br>      <span class="hljs-function"><span class="hljs-title">validator</span>(<span class="hljs-params">el</span>)</span> &#123;<br>        <span class="hljs-keyword">return</span> el === <span class="hljs-built_in">this</span>.password<br>      &#125;,<br>      <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Password are not the same!&#x27;</span>,<br>    &#125;,<br>  &#125;,<br>&#125;)<br><br>userSchema.pre(<span class="hljs-string">&#x27;save&#x27;</span>, <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">next</span>) </span>&#123;<br>  <span class="hljs-comment">// Only run this function if password was actually modifeid</span><br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.isModified(<span class="hljs-string">&#x27;password&#x27;</span>)) <span class="hljs-keyword">return</span> next()<br><br>  <span class="hljs-comment">// Hash the password with cost of 12</span><br>  <span class="hljs-built_in">this</span>.password = <span class="hljs-keyword">await</span> bycrpt.hash(<span class="hljs-built_in">this</span>.password, <span class="hljs-number">12</span>)<br><br>  <span class="hljs-comment">// Delete passwordConfirm field</span><br>  <span class="hljs-built_in">this</span>.passwordConfirm = <span class="hljs-literal">undefined</span><br>  next()<br>&#125;)<br><br><span class="hljs-keyword">const</span> User = mongoose.model(<span class="hljs-string">&#x27;User&#x27;</span>, userSchema)<br><span class="hljs-built_in">module</span>.exports = User<br></code></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://www.udemy.com/course/nodejs-express-mongodb-bootcamp/learn/lecture/15065288#overview">[Udemy] Nodejs Express Mongodb Bootcamp - 126. Managing Password</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Vue] 錯誤 @import directive requires a url or quoted</title>
      <link href="//Vue-%E9%8C%AF%E8%AA%A4-import-directive-requires-a-url-or-quoted/"/>
      <url>//Vue-%E9%8C%AF%E8%AA%A4-import-directive-requires-a-url-or-quoted/</url>
      
        <content type="html"><![CDATA[<h1 id="錯誤-import-directive-requires-a-url-or-quoted-path"><a href="#錯誤-import-directive-requires-a-url-or-quoted-path" class="headerlink" title="錯誤 @import directive requires a url or quoted path"></a>錯誤 @import directive requires a url or quoted path</h1><h2 id="發生情況"><a href="#發生情況" class="headerlink" title="發生情況"></a>發生情況</h2><p>在 config.js 引入 scss 檔案 (color.scss) 作為全域使用時，出現 @import directive requires a url or quoted path 錯誤</p><hr><h2 id="發生原因"><a href="#發生原因" class="headerlink" title="發生原因"></a>發生原因</h2><p> scss 檔案 (color.scss) 裡引入了外部網址<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-keyword">@import</span> url(<span class="hljs-string">&quot;https://fonts.googleapis.com/css?family=Roboto:400,500,700&quot;</span>)<br></code></pre></td></tr></table></figure></p><p>sass-resources-loader 會替換成內部路徑，造成錯誤<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">../assets/css/url/https://fonts.googleapis.com/css?family=Roboto:<span class="hljs-number">400</span>,<span class="hljs-number">500</span>,<span class="hljs-number">700</span><br></code></pre></td></tr></table></figure></p><hr><h2 id="解決方法"><a href="#解決方法" class="headerlink" title="解決方法"></a>解決方法</h2><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><pre><code>- 不要在此檔案 (color.scss) 引入外部連結，改在別的檔案引入，並在 main.js 引入</code></pre><h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><pre><code>- 在 index.html CDN 引入</code></pre><hr><h2 id="無效方法"><a href="#無效方法" class="headerlink" title="無效方法"></a>無效方法</h2><p>文章提到的改引入方法，試驗後無效<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-comment">// 原本</span><br><span class="hljs-keyword">@import</span> <span class="hljs-string">&quot;https://fonts.googleapis.com/icon?family=Material+Icons&quot;</span><br><span class="hljs-comment">// 更改後無效</span><br><span class="hljs-variable">@import</span> url(<span class="hljs-string">https://fonts.googleapis.com/icon?family=Material+Icons</span>)<br></code></pre></td></tr></table></figure></p><hr><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul><li><a href="https://github.com/webpack/webpack/issues/8865">https://github.com/webpack/webpack/issues/8865</a></li></ul><p>#vue/config/sccss</p>]]></content>
      
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Nodejs] 重構 Controller try catch</title>
      <link href="//Nodejs-%E9%87%8D%E6%A7%8B-Controller-try-catch/"/>
      <url>//Nodejs-%E9%87%8D%E6%A7%8B-Controller-try-catch/</url>
      
        <content type="html"><![CDATA[<h3 id="重構"><a href="#重構" class="headerlink" title="重構"></a>重構</h3><p>在 tourController 裡有許多重複的 code，寫法並不清晰<br>目標：寫下將以下的 code 重構，變得易懂<br><img src="https://github.com/Hazelwu2/nodejs-practice/commit/ba4f93c52ac32e7a46bfeb506827b14e20402dd2" alt="完整程式碼"></p><p>tourController.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">exports</span>.createTour = <span class="hljs-keyword">async</span> (req, res) =&gt; &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">const</span> newTour = <span class="hljs-keyword">await</span> Tour.create(req.body)<br><br>    res.status(<span class="hljs-number">201</span>).json(&#123;<br>      <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">data</span>: &#123;<br>        <span class="hljs-attr">tour</span>: newTour,<br>      &#125;,<br>    &#125;)<br>  &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>    res.status(<span class="hljs-number">400</span>).json(&#123;<br>      <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Invalid Data Sent!&#x27;</span>,<br>      err,<br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="開始重構"><a href="#開始重構" class="headerlink" title="開始重構"></a>開始重構</h2><h3 id="catchAsync"><a href="#catchAsync" class="headerlink" title="catchAsync"></a>catchAsync</h3><ol><li>建立一個 catchAsync 函數，並傳入參數 fn<br>為了避免每一段都是寫 try catch，顯得程式碼很亂，我們建立一個函數 catchAsync<br>來幫助我們簡單捕捉錯誤，並回傳一個匿名函數，將其分配給 createTour</li></ol><p>catchAsync：捕捉 async function 的 Error，在 ES7 中 async function 會回傳 Promise，也就意味者：若 async function 捕捉到 Error Promise 會被 reject</p><ol start="2"><li>將 try, catch 程式碼移除<br>而原本的 createTour 將 try 裡的程式碼挪到 try 外，也就是下面範例程式碼註解的部分移除</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> catchAsync = <span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> &#123;<br>  fn(req, res, next).catch(next)<br>&#125;<br><br><span class="hljs-built_in">exports</span>.createTour = catchAsync(<span class="hljs-keyword">async</span> (req, res) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> newTour = <span class="hljs-keyword">await</span> Tour.create(req.body)<br><br>  res.status(<span class="hljs-number">201</span>).json(&#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">data</span>: &#123;<br>      <span class="hljs-attr">tour</span>: newTour,<br>    &#125;,<br>  &#125;)<br>  <span class="hljs-comment">// try &#123;</span><br>  <span class="hljs-comment">// &#125; catch (err) &#123;</span><br>  <span class="hljs-comment">//   res.status(400).json(&#123;</span><br>  <span class="hljs-comment">//     status: 0,</span><br>  <span class="hljs-comment">//     message: &#x27;Invalid Data Sent!&#x27;,</span><br>  <span class="hljs-comment">//     err,</span><br>  <span class="hljs-comment">//   &#125;)</span><br>  <span class="hljs-comment">// &#125;</span><br>&#125;)<br></code></pre></td></tr></table></figure><p>重構，將 catchAsync 獨立一個檔案<br>在 utils 建立 catchAsync.js，並 export module</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> &#123;<br>  fn(req, res, next).catch(next)<br>&#125;<br></code></pre></td></tr></table></figure><p>在 tourController 引入，並將所有的路由加上 catchAsync<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> Tour = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../models/tourModel&#x27;</span>)<br><span class="hljs-keyword">const</span> APIFeatures = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../utils/apiFeatures&#x27;</span>)<br><span class="hljs-keyword">const</span> catchAsync = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../utils/catchAsync&#x27;</span>)<br><br><span class="hljs-built_in">exports</span>.getTour = catchAsync(<span class="hljs-keyword">async</span> (req, res, next) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> tour = <span class="hljs-keyword">await</span> Tour.findById(req.params.id)<br><br>  res.status(<span class="hljs-number">200</span>).json(&#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;success&#x27;</span>,<br>    <span class="hljs-attr">data</span>: &#123;<br>      tour,<br>    &#125;,<br>  &#125;)<br>&#125;)<br><br><span class="hljs-built_in">exports</span>.createTour = catchAsync(<span class="hljs-keyword">async</span> (req, res) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> newTour = <span class="hljs-keyword">await</span> Tour.create(req.body)<br><br>  res.status(<span class="hljs-number">201</span>).json(&#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">data</span>: &#123;<br>      <span class="hljs-attr">tour</span>: newTour,<br>    &#125;,<br>  &#125;)<br>&#125;)<br><br><span class="hljs-built_in">exports</span>.updateTour = catchAsync(<span class="hljs-keyword">async</span> (req, res, next) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> tour = <span class="hljs-keyword">await</span> Tour.findByIdAndUpdate(req.params.id, req.body, &#123;<br>    <span class="hljs-comment">// [new] 設定 true 表示會返回修改後的 item ，而非原始 item</span><br>    <span class="hljs-attr">new</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-comment">// [runValidators] 若設定 true 將會觸發 Model Schema 重新驗證</span><br>    <span class="hljs-attr">runValidators</span>: <span class="hljs-literal">true</span>,<br>  &#125;)<br><br>  res.status(<span class="hljs-number">200</span>).json(&#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;success&#x27;</span>,<br>    <span class="hljs-attr">data</span>: &#123;<br>      tour,<br>    &#125;,<br>  &#125;)<br>&#125;)<br><br><span class="hljs-built_in">exports</span>.deleteTour = catchAsync(<span class="hljs-keyword">async</span> (req, res, next) =&gt; &#123;<br>  <span class="hljs-keyword">await</span> Tour.findByIdAndDelete(req.params.id)<br><br>  res.status(<span class="hljs-number">204</span>).json(&#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;success&#x27;</span>,<br>    <span class="hljs-attr">data</span>: <span class="hljs-literal">null</span>,<br>  &#125;)<br>&#125;)<br><br></code></pre></td></tr></table></figure></p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://www.udemy.com/course/nodejs-express-mongodb-bootcamp/learn/lecture/15065210">[Udemy] Nodejs Express Mongodb Bootcamp</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Nodejs] ES6 class 重構擴展 Error 類 AppError</title>
      <link href="//Nodejs-ES6-class-%E9%87%8D%E6%A7%8B%E6%93%B4%E5%B1%95-Error-%E9%A1%9E-AppError/"/>
      <url>//Nodejs-ES6-class-%E9%87%8D%E6%A7%8B%E6%93%B4%E5%B1%95-Error-%E9%A1%9E-AppError/</url>
      
        <content type="html"><![CDATA[<p>當 Error 發生時，通常會拋出一個 Error 物件，也可以看成是一個 Error 原型<br>筆記利用 ES6 語法 Class，建立一個 AppError 類，並繼承 Error，重構 app.js<br><img src="https://github.com/Hazelwu2/nodejs-practice/tree/17c5130980087e5ff31135fe345bcda303f9e12c" alt="Github 完成程式碼"></p><h3 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h3><p>對於 Class 並沒有很熟悉，這裡寫下 Class 基本概念，建議可以到阮一峰的 ES6 介紹文章，寫得很清楚完整</p><p>Class 定義：ES6 語法，實際上就是一個 function<br>ES6 Class 的寫法，在 ES5 裡也同樣可以做得到，所以常會聽到 class 是語法糖，它讓物件原型的寫法更清晰，更像物件程式設計的語法<br>Class 可用 extends 關鍵字來繼承，比起改 Javascript 原型鏈實現繼承，要更清晰也更方便</p><ul><li>constructor：建造方法，通過 new 生成實例時，會自動呼叫 constructor，每個類都一定會有 constructor，每個類都一定會有</li><li>super：extends 繼承父類的 constructor 屬性與方法，像是 super.toValue() ，意思就是使用父層的 toValue() 方法<br>Class 侷限：不存在變數提升 Hoist，一定要先定義才能使用，若先使用再定義會報錯</li></ul><h4 id="appError-類"><a href="#appError-類" class="headerlink" title="appError 類"></a>appError 類</h4><p>建立 utils/appError.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">message, statusCode</span>)</span> &#123;<br>    <span class="hljs-built_in">super</span>(message)<br><br>    <span class="hljs-built_in">this</span>.statusCode = statusCode<br>    <span class="hljs-built_in">this</span>.status = <span class="hljs-string">`<span class="hljs-subst">$&#123;statusCode&#125;</span>`</span>.startsWith(<span class="hljs-string">&#x27;4&#x27;</span>) ? <span class="hljs-string">&#x27;fail&#x27;</span> : <span class="hljs-string">&#x27;error&#x27;</span><br>    <span class="hljs-built_in">this</span>.isOperational = <span class="hljs-literal">true</span><br><br>    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, <span class="hljs-built_in">this</span>.constructor)<br>  &#125;<br>&#125;<br><br><span class="hljs-built_in">module</span>.exports = AppError<br></code></pre></td></tr></table></figure><br>class 使用到 extends， 繼承 Error 的原型</p><h3 id="Stack-Trace"><a href="#Stack-Trace" class="headerlink" title="Stack Trace"></a>Stack Trace</h3><p>Stack Trace 堆疊追蹤<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">console.<span class="hljs-built_in">log</span>(<span class="hljs-keyword">err</span>.<span class="hljs-keyword">stack</span>)<br></code></pre></td></tr></table></figure><br>Stact 印出來的模樣<br><img src="../../../images/20211014/20211014nodejs-class.png" alt="Stack Trace 堆疊追蹤"></p><p><code>Error.captureStackTrace</code> 當 catch 到 error 時會取得 error.stack，便會調用此函數。<br>函數第一個參數要放 Object 物件，第二個參數則放選填的 function，它的作用是捕捉當前堆疊的路徑，並在傳入的物件裡（第一個參數）建立一個 stack 屬性來儲存，如果有傳入第二個參數，則會當成這次堆疊調用的最終站，程式只會跑到這個函數，也就是 this.constructor 被調用之前<br>可以用 console.log 印出來看看到底存入了什麼<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, <span class="hljs-built_in">this</span>.constructor)<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;stack&#x27;</span>, <span class="hljs-built_in">this</span>.stack) <span class="hljs-comment">// stack Error: Can&#x27;t find /api/v1/asd on this server</span><br></code></pre></td></tr></table></figure><br>最後打印出來 stack: ‘Error: Can’t find /api/v1/asd on this server’</p><h4 id="實際應用-new-appError"><a href="#實際應用-new-appError" class="headerlink" title="實際應用 new appError"></a>實際應用 new appError</h4><p>回到 app.js，引用 AppError，並在 MiddleWare 攔截 * 路由時 new AppError 類<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><br><span class="hljs-keyword">const</span> AppError = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./utils/appError&#x27;</span>)<br><span class="hljs-keyword">const</span> app = express()<br><br><br>app.use(<span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">//* 以下是尚未重構前的代碼</span><br>  <span class="hljs-comment">// res.status(404).json(&#123;</span><br>  <span class="hljs-comment">//   status: 0,</span><br>  <span class="hljs-comment">//   message: `Can&#x27;t find $&#123;req.originalUrl&#125; on this server`,</span><br>  <span class="hljs-comment">// &#125;)</span><br>  <span class="hljs-comment">// err.status = &#x27;fail&#x27;</span><br>  <span class="hljs-comment">// err.statusCode = 404</span><br><br>  <span class="hljs-comment">// 重構後的代碼</span><br>  next(<span class="hljs-keyword">new</span> AppError(<span class="hljs-string">`Can&#x27;t find <span class="hljs-subst">$&#123;req.originalUrl&#125;</span> on this server`</span>), <span class="hljs-number">404</span>))<br>&#125;)<br></code></pre></td></tr></table></figure><br>接下來重構這段程式碼，當遇到錯誤時 json 吐回訊息<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js">app.use(<span class="hljs-function">(<span class="hljs-params">err, req, res, next</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// Stack Trace 堆疊追蹤</span><br>  <span class="hljs-built_in">console</span>.log(err.stack)<br><br>  err.statusCode = err.statusCode || <span class="hljs-number">500</span><br>  err.status = err.status || <span class="hljs-string">&#x27;error&#x27;</span><br><br>  <span class="hljs-comment">// 回傳錯誤訊息</span><br>  res.status(err.statusCode).json(&#123;<br>    <span class="hljs-attr">status</span>: err.status,<br>    <span class="hljs-attr">message</span>: err.message,<br>  &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure><br>新增檔案 controllers/errorController.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">err, req, res, next</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// Stack Trace 堆疊追蹤</span><br>  <span class="hljs-built_in">console</span>.log(err.stack)<br><br>  err.statusCode = err.statusCode || <span class="hljs-number">500</span><br>  err.status = err.status || <span class="hljs-string">&#x27;error&#x27;</span><br><br>  <span class="hljs-comment">// 回傳錯誤訊息</span><br>  res.status(err.statusCode).json(&#123;<br>    <span class="hljs-attr">status</span>: err.status,<br>    <span class="hljs-attr">message</span>: err.message,<br>  &#125;)<br>&#125;<br></code></pre></td></tr></table></figure></p><p>回到 app.js，將內容刪除，並引入 errorController，再將原本的程式碼刪除，替代為 globalErrorHandler，將 app.js 精簡很多<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> globalErrorHandler = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./controllers/errorController)</span><br><span class="hljs-string"></span><br><span class="hljs-string">app.use(globalErrorHandler)</span><br></code></pre></td></tr></table></figure></p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://yucj.gitbooks.io/ecmascript-6/content/docs/class.html">ES6-Class的繼承</a></li><li><a href="http://jartto.wang/2017/12/09/grasp-js-stack-trace/">掌握 JS Stack Trace</a></li><li><a href="https://www.bennadel.com/blog/2828-creating-custom-error-objects-in-node-js-with-error-capturestacktrace.htm">Creating Custom Error Objects In Node.js With Error.captureStackTrace()</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Vue] i18n 神器 i18n-ally</title>
      <link href="//Vue-i18n-%E7%A5%9E%E5%99%A8-i18n-ally/"/>
      <url>//Vue-i18n-%E7%A5%9E%E5%99%A8-i18n-ally/</url>
      
        <content type="html"><![CDATA[<p>VS Code 開發一個套件叫 i18n-ally，常常我們需要對照 i18n 翻譯，要另外再開啟 json 檔非常混亂，安裝此套件後就可以輕鬆對照啦，此外還有提供進度表，可以告訴我們各種語言翻譯的進度，非常方便的神器<br><img src="../../../images/20211013-vue-i18n-ally.png" alt="i18n-ally"></p><ol><li>點擊 VSCode 套件安裝 i18n-ally</li><li>編輯 setting.js<br>可用 「cmd+,」，再點開右上角的 A4 檔案 Icon，會開啟 setting.json 檔<br>在最下面加上你的 i18n 路徑。<br>例如以下的範例，我的 i18n json 檔放在 src/i18n/config 底下，調整成你放的實際目錄<br>預設顯示語言可以設定，像我的語系有 en, zh, tw，也可以預設顯示為 tw<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-comment">// 語系檔路徑</span><br>  <span class="hljs-attr">&quot;i18n-ally.localesPaths&quot;</span>: [<br>    <span class="hljs-string">&quot;src/i18n/config&quot;</span><br>  ],<br>  <span class="hljs-comment">// 默認顯示翻譯文字</span><br>  <span class="hljs-attr">&quot;i18n-ally.displayLanguage&quot;</span>: <span class="hljs-string">&quot;cn&quot;</span>,<br>&#125;<br></code></pre></td></tr></table></figure>編輯完成！<br>在左側旁邊的功能列找到 i18n-ally，也可以看到當前檔案及翻譯進度<br>當前檔案會列出所有 json 第一層的檔案<br><img src="../../../images/20211013-vue-i18n-ally2.png" alt="i18n-ally"></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Vue] Vxe-Table 保存滾動捲軸的位置</title>
      <link href="//Vue-Vxe-Table%20%E4%BF%9D%E5%AD%98%E6%BB%BE%E5%8B%95%E6%8D%B2%E8%BB%B8%E7%9A%84%E4%BD%8D%E7%BD%AE/"/>
      <url>//Vue-Vxe-Table%20%E4%BF%9D%E5%AD%98%E6%BB%BE%E5%8B%95%E6%8D%B2%E8%BB%B8%E7%9A%84%E4%BD%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<p>今天要做的需求是，使用者不管點擊上一頁或下一頁，或是點擊頁面上任何連結，再次返回到那一頁，會保留原本瀏覽的位置。也就是說一開始進入 A 頁滑到頁面最尾端，跳轉到 B 頁，再回到 A 頁，我們希望 A頁進入後是在最尾端的位置。</p><p>官方文件提供 scrollBehavior 函式來自動記載捲軸滾動的位置，但僅限於點擊瀏覽器按上一頁、下一頁才會有作用。點擊 router-link 並不會有任何作用，console 出來 scrollBehavior 會發現是 null 值。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js">scrollBehavior (to, <span class="hljs-keyword">from</span>, savedPosition) &#123;<br>  <span class="hljs-keyword">if</span> (savedPosition) &#123;<br>    <span class="hljs-comment">// 若點擊 router-link，savedPosition 會是 null 值</span><br>    <span class="hljs-comment">// 並不會有任何作用</span><br>    <span class="hljs-keyword">return</span> savedPosition <br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><br>為了彌補 scrollBehavior 少做的功能，我們必須再多做點事。</p><h2 id="外部"><a href="#外部" class="headerlink" title="外部"></a>外部</h2><p>將 router 掛載的物件加入 meta.scrollTop 以方便去紀錄每個分頁的 Y軸位置，並在 router.beforeEach 離開頁面前寫入，進入頁面後 (router.afterEach) 滾動到指定位置</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./router&#x27;</span><br><br><span class="hljs-comment">// 設定 scrollBehavior</span><br><span class="hljs-keyword">new</span> Router(&#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;history&#x27;</span>, <span class="hljs-comment">// require service support</span><br>  <span class="hljs-function"><span class="hljs-title">scrollBehavior</span>(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, savedPosition</span>)</span> &#123;<br>    <span class="hljs-keyword">const</span> scrollPos = &#123;<br>      <span class="hljs-attr">top</span>: to.meta.scrollTop,<br>      <span class="hljs-attr">left</span>: <span class="hljs-number">0</span><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> savedPosition || scrollPos<br>  &#125;,<br>  <span class="hljs-attr">routes</span>: constantRoutes<br>&#125;)<br><br>router.beforeEach(<span class="hljs-keyword">async</span>(to, <span class="hljs-keyword">from</span>, next) =&gt; &#123;<br>  <span class="hljs-comment">// 離開頁面後，紀錄捲軸高度 (Y) 位置</span><br>  <span class="hljs-keyword">from</span>.meta.scrollTop = <span class="hljs-built_in">window</span>.scrollY<br>  next()<br>&#125;)<br><br>router.afterEach(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span></span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 頁面移動到上次瀏覽的位置</span><br>  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-built_in">window</span>.scrollTo(<span class="hljs-number">0</span>, to.meta.scrollTop)<br>  &#125;, <span class="hljs-number">100</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><p>也可以改寫，將 left, top 位置一併紀錄<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>  <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/&#x27;</span>,<br>  <span class="hljs-attr">component</span>: Layout,<br>  <span class="hljs-attr">redirect</span>: <span class="hljs-string">&#x27;/dashboard&#x27;</span>,<br>  <span class="hljs-attr">children</span>: [<br>    &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Dashboard&#x27;</span>,<br>      <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;dashboard&#x27;</span>,<br>      <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/other/dashboard/index&#x27;</span>),<br>      <span class="hljs-attr">children</span>: [],<br>      <span class="hljs-attr">meta</span>: &#123;<br>        <span class="hljs-attr">title</span>: &#123;<br>          <span class="hljs-attr">en</span>: <span class="hljs-string">&#x27;dashboard&#x27;</span>,<br>          <span class="hljs-attr">zh</span>: <span class="hljs-string">&#x27;儀表板&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;dashboard&#x27;</span>,<br>        <span class="hljs-attr">affix</span>: <span class="hljs-literal">true</span>,<br>        scrollPos = &#123;<br>          <span class="hljs-attr">top</span>: <span class="hljs-number">0</span>,<br>          <span class="hljs-attr">left</span>: <span class="hljs-number">0</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  ]<br>&#125;,<br>router.beforeEach(<span class="hljs-keyword">async</span>(to, <span class="hljs-keyword">from</span>, next) =&gt; &#123;<br>  <span class="hljs-comment">// 離開頁面後，紀錄捲軸高度 (Y) 位置</span><br>  <span class="hljs-keyword">from</span>.meta.scrollPos.top = <span class="hljs-built_in">window</span>.scrollY<br>  <span class="hljs-keyword">from</span>.meta.scrollPos.left = <span class="hljs-built_in">window</span>.scrollX<br>  next()<br>&#125;)<br><br>router.afterEach(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span></span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 頁面移動到上次瀏覽的位置</span><br>  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-built_in">window</span>.scrollTo(to.meta.scrollPos.left, to.meta.scrollPos.top)<br>  &#125;, <span class="hljs-number">100</span>)<br>&#125;)<br></code></pre></td></tr></table></figure></p><h2 id="元件內部"><a href="#元件內部" class="headerlink" title="元件內部"></a>元件內部</h2><p>使用 vxe-table 套件，只要設定 max-height後，即可紀錄保存位置</p><ul><li>scrollTo 移動到指定位置</li><li>getScroll 取得表格的滾動狀態，必須設定 max-height 虛擬滾動表格才會紀錄，物件有  { virtualX, virtualY, scrollTop, scrollLeft }</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><br>&lt;button @change=<span class="hljs-string">&quot;scrollTo&quot;</span>&gt;移動到指定<span class="hljs-number">1500</span>位置&lt;/button&gt;<br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">vxe-table</span> </span></span><br><span class="hljs-tag"><span class="xml">  <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;xTable&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">  <span class="hljs-attr">show-overflow</span></span></span><br><span class="hljs-tag"><span class="xml">  <span class="hljs-attr">highlight-hover-row</span></span></span><br><span class="hljs-tag"><span class="xml">  <span class="hljs-attr">max-height</span>=<span class="hljs-string">&quot;800&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">  <span class="hljs-attr">:data</span>=<span class="hljs-string">&quot;tableData&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">vxe-table-column</span> <span class="hljs-attr">field</span>=<span class="hljs-string">&quot;test&quot;</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span> /&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">vxe-table-column</span>&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-title">mounted</span>(<span class="hljs-params"></span>)</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.$refs.xTable)<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.$refs.xTable.$el)<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.$refs.xTable.$el.offsetTop)<br>&#125;,<br><span class="hljs-attr">methods</span>: &#123;<br>  <span class="hljs-function"><span class="hljs-title">getScroll</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.$refs.xTable.getScroll())<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">      &#123; virtualX, virtualY, scrollTop, scrollLeft &#125;</span><br><span class="hljs-comment">    */</span><br>  &#125;,<br><br>  <span class="hljs-comment">// 指定移動到 Y 軸 1500px 位置</span><br>  <span class="hljs-function"><span class="hljs-title">scrollTo</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">this</span>.$refs.xTable.scrollTo(<span class="hljs-number">0</span>, <span class="hljs-number">1500</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://juejin.cn/post/6975851743573868551">使用keep-alive保存滚动条的位置</a></li><li><a href="https://medium.com/@aryan02420/vue-router-restore-scroll-position-with-router-link-and-transition-61396af48ba2">Vue Router: Restore Scroll Position with <router-link> and <transition></a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> vxe-table </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Nodejs] 用 Middleware Global 全域處理錯誤</title>
      <link href="//Nodejs-%E7%94%A8-Middleware-Global-%E5%85%A8%E5%9F%9F%E8%99%95%E7%90%86%E9%8C%AF%E8%AA%A4/"/>
      <url>//Nodejs-%E7%94%A8-Middleware-Global-%E5%85%A8%E5%9F%9F%E8%99%95%E7%90%86%E9%8C%AF%E8%AA%A4/</url>
      
        <content type="html"><![CDATA[<p>在 Nodejs Express 中用 Middleware 錯誤處理<br>官方提供錯誤處理的函數，參數有 err, req, res, next。<br>我們可以使用 app.use 方式來呼叫</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">app.use(<span class="hljs-function">(<span class="hljs-params">err, req, res, next</span>) =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">&#x27;有錯誤&#x27;</span>)<br>  res.status(<span class="hljs-number">500</span>).json(&#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-number">500</span><br>    <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Ohhh, 發生錯誤&#x27;</span><br>  &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure><p>app.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><br>app.all(<span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> err = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Ohhhh, cannot find this <span class="hljs-subst">$&#123;req.originalUrl&#125;</span>`</span>)<br>  err.status = <span class="hljs-string">&#x27;fail&#x27;</span><br>  err.statusCode = <span class="hljs-number">404</span><br><br>  next(err)<br>&#125;)<br><br>app.use(<span class="hljs-function">(<span class="hljs-params">err, req, res, next</span>) =&gt;</span> &#123;<br>  err.statusCode = err.statusCode || <span class="hljs-number">500</span><br>  err.status = err.status || <span class="hljs-string">&#x27;error&#x27;</span><br><br>  res.status(err.statusCode).json(&#123;<br>    <span class="hljs-attr">status</span>: err.status,<br>    <span class="hljs-attr">message</span>: err.message<br>  &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure></p><h3 id="成果"><a href="#成果" class="headerlink" title="成果"></a>成果</h3><p>輸入不存在的 routes 時便會出現錯誤訊息<br><img src="/images/202111009-nodejs-error-handle.png" alt="最後呈現的結果"></p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://expressjs.com/zh-tw/guide/error-handling.html">Express Error Handle</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>[Nodejs] Mongoose Virtual Properties</title>
      <link href="//Nodejs-Mongoose-Virtual-Properties/"/>
      <url>//Nodejs-Mongoose-Virtual-Properties/</url>
      
        <content type="html"><![CDATA[<h1 id="Nodejs-Mongoose-Virtual-Properties"><a href="#Nodejs-Mongoose-Virtual-Properties" class="headerlink" title="[Nodejs] Mongoose Virtual Properties"></a>[Nodejs] Mongoose Virtual Properties</h1><h2 id="什麼是-Virtual-Properties"><a href="#什麼是-Virtual-Properties" class="headerlink" title="什麼是 Virtual Properties"></a>什麼是 Virtual Properties</h2><p>它是 Mongoose 提供的功能之一，Model 可以在 Schema 定義虛擬屬性(Virtual Properties)，它並不會被存入資料庫，但是我們可以使用和讀取，這樣做為了可以節省空間</p><h3 id="優缺點"><a href="#優缺點" class="headerlink" title="優缺點"></a>優缺點</h3><ul><li>優點：節省資料庫空間</li><li>缺點：由於Virtual 沒有儲存在資料庫中，因此無法查詢</li></ul><p>它的概念其實就是 Vue 裡的 computed 屬性</p><p>例如：lastName, firstName，最常看到的範例是 Vue2 computed 設定 lastName, firstName, fullName</p><h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><p>定義了 tourSchema，在 tourSchema 最後定義完後加上設定 <code>toJSON: &#123; virtuals: true &#125;, toObject: &#123; virtuals: true &#125;</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-comment">// 這是最後要加上的設定</span><br><span class="hljs-attr">toJSON</span>: &#123; <span class="hljs-attr">virtuals</span>: <span class="hljs-literal">true</span> &#125;<br><span class="hljs-comment">// 舉例</span><br><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mongoose&#x27;</span>)<br><br><span class="hljs-keyword">const</span> testSchema = <span class="hljs-keyword">new</span> mongoose.Schema(<br>&#123; ...自定義Schema &#125;, <br>&#123;<br><span class="hljs-attr">toJSON</span>: &#123; <span class="hljs-attr">virtuals</span>: <span class="hljs-literal">true</span> &#125;,<br>  <span class="hljs-attr">toObject</span>: &#123; <span class="hljs-attr">virtuals</span>: <span class="hljs-literal">true</span> &#125;,<br>&#125;<br>)<br></code></pre></td></tr></table></figure><h3 id="設定虛擬屬性"><a href="#設定虛擬屬性" class="headerlink" title="設定虛擬屬性"></a>設定虛擬屬性</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jsx">schema.virtual(<span class="hljs-string">&#x27;定義虛擬屬性名稱&#x27;</span>).get(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-comment">// 這個值要 return 什麼</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;This is Virtual Properities&#x27;</span><br>&#125;)<br></code></pre></td></tr></table></figure><p>在以下程式碼，設定了 durationWeeks，根據 duration / 7 而得來，後面要接的是 callback function</p><p>注意：不可用箭頭Function來寫，傳回的值會是 null</p><p>❌：get.(() ⇒ { this.duration / 7 })<br>🆗：get.(function() { return this.duration / 7 })</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jsx">tourSchema.virtual(<span class="hljs-string">&#x27;durationWeeks&#x27;</span>).get(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.duration / <span class="hljs-number">7</span><br>&#125;)<br></code></pre></td></tr></table></figure><p><img src="/images/20210628-virtual-properties.png" alt="Postman Final Result"></p><h2 id="完整程式碼"><a href="#完整程式碼" class="headerlink" title="完整程式碼"></a>完整程式碼</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mongoose&#x27;</span>)<br><br><span class="hljs-keyword">const</span> tourSchema = <span class="hljs-keyword">new</span> mongoose.Schema(&#123;<br>  <span class="hljs-attr">name</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,<br>    <span class="hljs-attr">required</span>: [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;A tour must have a name&#x27;</span>],<br>    <span class="hljs-attr">unique</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">trim</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">duration</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>,<br>    <span class="hljs-attr">required</span>: [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;A tour must hava a duration&#x27;</span>],<br>  &#125;,<br>  <span class="hljs-attr">maxGroupSize</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>,<br>    <span class="hljs-attr">required</span>: [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;A tour must have a group size&#x27;</span>],<br>  &#125;,<br>  <span class="hljs-attr">difficulty</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,<br>    <span class="hljs-attr">required</span>: [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;A tour must have a difficulty&#x27;</span>],<br>  &#125;,<br>  <span class="hljs-attr">price</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>,<br>    <span class="hljs-attr">required</span>: [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;A tour must have a price&#x27;</span>],<br>  &#125;,<br>  <span class="hljs-attr">ratingsAverage</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>,<br>    <span class="hljs-attr">default</span>: <span class="hljs-number">4.5</span>,<br>  &#125;,<br>  <span class="hljs-attr">ratingsQuantity</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>,<br>    <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>,<br>  &#125;,<br>  <span class="hljs-attr">priceDiscount</span>: <span class="hljs-built_in">Number</span>,<br>  <span class="hljs-attr">summary</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,<br>    <span class="hljs-attr">trim</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">required</span>: [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;A tour must have a description&#x27;</span>],<br>  &#125;,<br>  <span class="hljs-attr">description</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,<br>    <span class="hljs-attr">trim</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">imageCover</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,<br>    <span class="hljs-attr">required</span>: [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;A tour must have a cover image&#x27;</span>],<br>  &#125;,<br>  <span class="hljs-attr">images</span>: [<span class="hljs-built_in">String</span>],<br>  <span class="hljs-attr">createdAt</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">Date</span>,<br>    <span class="hljs-attr">default</span>: <span class="hljs-built_in">Date</span>.now(),<br>    <span class="hljs-attr">select</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// API 永遠不顯示在 Client 端</span><br>  &#125;,<br>  <span class="hljs-attr">startDates</span>: [<span class="hljs-built_in">Date</span>],<br>&#125;, &#123;<br>  <span class="hljs-attr">toJSON</span>: &#123; <span class="hljs-attr">virtuals</span>: <span class="hljs-literal">true</span> &#125;,<br>  <span class="hljs-attr">toObject</span>: &#123; <span class="hljs-attr">virtuals</span>: <span class="hljs-literal">true</span> &#125;,<br>&#125;)<br><br><span class="hljs-comment">// eslint-disable-next-line func-names</span><br>tourSchema.virtual(<span class="hljs-string">&#x27;durationWeeks&#x27;</span>).get(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.duration / <span class="hljs-number">7</span><br>&#125;)<br><br><span class="hljs-keyword">const</span> Tour = mongoose.model(<span class="hljs-string">&#x27;Tour&#x27;</span>, tourSchema)<br><br><span class="hljs-built_in">module</span>.exports = Tour<br></code></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue 與 Slot 結合</title>
      <link href="//Vue-%E8%88%87-Slot-%E7%B5%90%E5%90%88/"/>
      <url>//Vue-%E8%88%87-Slot-%E7%B5%90%E5%90%88/</url>
      
        <content type="html"><![CDATA[<h1 id="Vue-與-Slot-結合"><a href="#Vue-與-Slot-結合" class="headerlink" title="Vue 與 Slot 結合"></a>Vue 與 Slot 結合</h1><h2 id="Slot"><a href="#Slot" class="headerlink" title="Slot"></a>Slot</h2><p>Slot是什麼？可以讓你插入HTML內容。會使用的時機通常是結構都相同，但是裡面的HTML需要更改，CSS表現方式可能有三四種，這時Slot就可以派上用場了。</p><h2 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h2><h3 id="匿名插槽"><a href="#匿名插槽" class="headerlink" title="匿名插槽"></a>匿名插槽</h3><p>匿名插槽就是slot不設定name屬性，通常用在屬性較單純，只需要插入一個地方處。他會抓父元件template裡的內容。</p><p>子元件<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">&lt;template&gt;<br>  &lt;div <span class="hljs-keyword">class</span>=&quot;<span class="hljs-symbol">content</span>&quot;&gt;<br>    &lt;<span class="hljs-symbol">header</span> <span class="hljs-symbol">class</span>=&quot;<span class="hljs-symbol">text</span>&quot;&gt;<br>      &lt;<span class="hljs-symbol">slot</span>&gt;預設值&lt;/<span class="hljs-symbol">slot</span>&gt;<br>    &lt;/<span class="hljs-symbol">header</span>&gt;<br>  &lt;/<span class="hljs-symbol">div</span>&gt;<br>&lt;/<span class="hljs-symbol">template</span>&gt;<br></code></pre></td></tr></table></figure><br>父元件，在template中的內容都會被帶入slot上。如果slot是變數，那他可以帶HTML各種格式填入進去。</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="xml">// 父元件</span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">child</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">child</span>&gt;</span></span><br><span class="xml"></span><br><span class="xml">    // 插槽上寫v-slot=&quot;slotProps&quot;，父元件就可以讀取到子元件的data屬性</span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">child</span> <span class="hljs-attr">v-slot</span>=<span class="hljs-string">&quot;slotProps&quot;</span>&gt;</span></span><br><span class="xml">      </span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">slotProps.user</span> &#125;&#125;</span><span class="xml"></span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">child</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h3 id="具名插槽"><a href="#具名插槽" class="headerlink" title="具名插槽"></a>具名插槽</h3><p>最近流行武漢肺炎，去藥局都需要實名購買，Slot也是有實名制的！Slot有一個叫<code>name</code>的屬性，根據name來認內容。就和我們要去買口罩，他是看健保卡認的，才會給你買口罩喔XD。</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-comment">// 子元件</span><br>&lt;template&gt;<br>  &lt;div <span class="hljs-keyword">class</span>=&quot;<span class="hljs-symbol">content</span>&quot;&gt;<br>    &lt;<span class="hljs-symbol">main</span>&gt;<br>      &lt;<span class="hljs-symbol">slot</span> <span class="hljs-symbol">name</span>=&quot;<span class="hljs-symbol">main</span>&quot;&gt;&lt;/<span class="hljs-symbol">slot</span>&gt;<br>    &lt;/<span class="hljs-symbol">main</span>&gt;<br>    &lt;<span class="hljs-symbol">footer</span>&gt;<br>      &lt;<span class="hljs-symbol">slot</span> <span class="hljs-symbol">name</span>=&quot;<span class="hljs-symbol">footer</span>&quot;&gt;&lt;/<span class="hljs-symbol">slot</span>&gt;<br>    &lt;/<span class="hljs-symbol">footer</span>&gt;<br>  &lt;/<span class="hljs-symbol">div</span>&gt;<br>&lt;/<span class="hljs-symbol">template</span>&gt;<br></code></pre></td></tr></table></figure><p>子元件做了<code>main</code>與<code>footer</code>的插槽，接著來看父元件怎麼做設定</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml">// 父元件<br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">child</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-slot:main</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://www.zcygov.cn&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;_blank&quot;</span>&gt;</span>导航<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">footer</span>&gt;</span>页脚（具名插槽的缩写#）<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">footer</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--  v-slot 重复定义同样的 name 后只会加载最后一个定义的插槽内容 --&gt;</span><br>        v-slot只会添加在一个 template 上面<br>      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">child</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure><p>v-slot 如果定義同樣的 name，只會加載最後一個定義的slot內容。可以用#來做縮小<br><code>name=&quot;footer&quot;</code> 等同於 <code>#footer</code></p><h3 id="作用域插槽"><a href="#作用域插槽" class="headerlink" title="作用域插槽"></a>作用域插槽</h3><p>作用域插槽就是可以讓父元件讀取到子元件的data及method，平常不是使用slot情況，父元件要吃子元件的method或data，是用<code>$emit</code>或<code>eventBus</code>來傳值。接下來示範在slot情況下，要怎麼父傳給子</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="xml">// 子元件</span><br><span class="xml"> <span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml">   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span></span><br><span class="xml">     <span class="hljs-comment">&lt;!-- 作用域插槽 --&gt;</span></span><br><span class="xml">     <span class="hljs-tag">&lt;<span class="hljs-name">footer</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;text&quot;</span>&gt;</span></span><br><span class="xml">       <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;footer&quot;</span> <span class="hljs-attr">:user</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">:testClick</span>=<span class="hljs-string">&quot;testClick&quot;</span>&gt;</span></span><br><span class="xml">         </span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">user.name</span>&#125;&#125;</span><span class="xml"></span><br><span class="xml">       <span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span></span><br><span class="xml">     <span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span></span><br><span class="xml">   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml"> <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml"></span><br><span class="xml"> <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"> <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">   <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;child&#x27;</span>,</span></span><br><span class="javascript"><span class="xml">   data () &#123;</span></span><br><span class="javascript"><span class="xml">     <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="javascript"><span class="xml">       <span class="hljs-attr">user</span>: &#123;</span></span><br><span class="javascript"><span class="xml">         <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;Hazel Wu 你知道的 Hello&#x27;</span>,</span></span><br><span class="javascript"><span class="xml">         <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Hazel&#x27;</span></span></span><br><span class="javascript"><span class="xml">       &#125;</span></span><br><span class="javascript"><span class="xml">     &#125;;</span></span><br><span class="javascript"><span class="xml">   &#125;,</span></span><br><span class="javascript"><span class="xml">   <span class="hljs-attr">methods</span>:&#123;</span></span><br><span class="javascript"><span class="xml">     <span class="hljs-function"><span class="hljs-title">testClick</span>(<span class="hljs-params"></span>)</span>&#123;</span></span><br><span class="javascript"><span class="xml">         <span class="hljs-comment">// 這是子元件的方法，但也可以給父元件一起使用喔</span></span></span><br><span class="javascript"><span class="xml">       alert(<span class="hljs-string">&#x27;123&#x27;</span>);</span></span><br><span class="javascript"><span class="xml">     &#125;</span></span><br><span class="javascript"><span class="xml">   &#125;</span></span><br><span class="javascript"><span class="xml"> &#125;;</span></span><br><span class="javascript"><span class="xml"> </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>接著是父元件的設定，我們會在父元件定義<code>v-slot:xxx=&quot;slotProps&quot;</code>或是<code>#xxx=&quot;slotProps&quot;</code>，總之怎麼樣都一定少不了<code>slotProps</code>，當然<code>slotProps</code>也可以重新命名，他就是用來讀取子元件的資料或方法</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="xml">// 父元件</span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">child</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">footer</span>=<span class="hljs-string">&quot;slotProps&quot;</span>&gt;</span></span><br><span class="xml">        </span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">slotProps.user.title</span>&#125;&#125;</span><span class="xml"></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;slotProps.testClick&quot;</span>&gt;</span>點我<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">footer</span>=<span class="hljs-string">&quot;&#123;user,testClick&#125;&quot;</span>&gt;</span></span><br><span class="xml">        </span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">user.title</span>&#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span><br><span class="xml">        解構插槽prop <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span><br><span class="xml">        <span class="hljs-comment">&lt;!-- 子組件的 testClick方法，在父元件也可以使用喔 --&gt;</span></span><br><span class="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;testClick&quot;</span>&gt;</span>点我<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">child</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml"></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">import</span> Child <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./component/child.vue&#x27;</span>;</span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;demo&#x27;</span>,</span></span><br><span class="javascript"><span class="xml">  <span class="hljs-attr">components</span>: &#123;</span></span><br><span class="javascript"><span class="xml">    Child</span></span><br><span class="javascript"><span class="xml">  &#125;,</span></span><br><span class="javascript"><span class="xml">&#125;;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>我們剛剛在子元件定義了<code>user的data</code>、<code>testClick的方法</code>，你看，我們在父元件都用得上，很方便！</p><h2 id="實戰：Menu"><a href="#實戰：Menu" class="headerlink" title="實戰：Menu"></a>實戰：Menu</h2><p>我們的Menu有點複雜，我希望他有兩種型態，第一種型態是直接跳連結、第二種型態是show wrapper。</p><p>第一種型態：有li<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xml">// 父元件：展開Menu，有li<br><span class="hljs-tag">&lt;<span class="hljs-name">MenuItem</span> <span class="hljs-attr">:show</span>=<span class="hljs-string">&quot;showMenu = true&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">name</span>&gt;</span>關於我們<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">content</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col d-flex justify-content-center align-items-end&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;menu-item__wrapper__content&quot;</span>&gt;</span>Show Content<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col d-flex justify-content-center align-items-end&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>         還在等什麼？快來訂閱我！<br>       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col d-flex justify-content-center align-items-end&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;menu-item__wrapper__content&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">MenuItem</span>&gt;</span><br></code></pre></td></tr></table></figure><br>你可以看到父元件我用了兩個插槽，分別是<code>#name</code>, <code>#content</code>，由於選單都是用CSS的變化操作，所以並沒有用到slotProps，也就是子元件的資料及方法。</p><p>第二種型態：直接跳新頁面<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 父元件：第二種型態，直接跳新頁面</span><br>&lt;MenuItem :show=<span class="hljs-string">&quot;showMenu = false&quot;</span>&gt;<br>   <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">name</span>&gt;</span></span><br><span class="xml">     優惠活動</span><br><span class="xml">   <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br> &lt;/MenuItem&gt;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-function"><span class="hljs-title">data</span>(<span class="hljs-params"></span>)</span> &#123;<br><span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">showMenu</span>: <span class="hljs-literal">true</span> &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><br>接著來看看子元件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;menu-item&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;position-absolute&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;d-inline-block mr-2&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;fas fa-chevron-up&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;menu-item__line&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;menu-item__wrapper&quot;</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;show&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row d-flex align-items-center justify-content-between h-100&quot;</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span><br><span class="javascript">  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="javascript">    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;MenuItem&#x27;</span>,</span><br><span class="javascript">    <span class="hljs-attr">props</span>: [<span class="hljs-string">&#x27;show&#x27;</span>],</span><br><span class="javascript">  &#125;</span><br><span class="javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>子元件除了設定要插在哪裏的<code>name</code>、<code>content</code>之外，在<code>menu-item__wrapper</code>內另外用<code>v-if</code>來傳值，切換第一種型態、第二種型態選單的關鍵，再用props去接收show的值。</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://cn.vuejs.org/v2/guide/components-slots.html#%E6%8F%92%E6%A7%BD%E5%86%85%E5%AE%B9">官方文件：插槽內容</a></li><li><a href="https://www.zoo.team/article/slot">让你的组件千变万化，Vue slot 剖玄析微</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 動態切換元件</title>
      <link href="//Vue-%E5%8B%95%E6%85%8B%E5%88%87%E6%8F%9B%E5%85%83%E4%BB%B6/"/>
      <url>//Vue-%E5%8B%95%E6%85%8B%E5%88%87%E6%8F%9B%E5%85%83%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="Vue-動態切換元件"><a href="#Vue-動態切換元件" class="headerlink" title="Vue 動態切換元件"></a>Vue 動態切換元件</h1><p>根據API取得的資料，動態切換元件。公司需要做模板切換，使用者可以在後台選擇layout1、layout2、layout3，分別會載入不同的layout</p><p>我們將API取得的資料放在<code>sessionStorage.siteInfo</code>裡，<br>接著利用<code>:is</code>來做動態切換。</p><p>當是layout1時，便會切換layout-1的元件。<br>比較特別的是，使用:is作法不需要在components再宣告一次<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;template&gt;<br>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">&quot;hotGame&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="hljs-keyword">import</span> layout1 <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../12.index/hot_layout/layout-1.vue&#x27;</span><br><span class="hljs-keyword">import</span> layout2 <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../12.index/hot_layout/layout-2.vue&#x27;</span>;<br><span class="hljs-keyword">import</span> layout3 <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../12.index/hot_layout/layout-3.vue&#x27;</span>;<br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">  <span class="hljs-function"><span class="hljs-title">data</span>(<span class="hljs-params"></span>)</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="javascript"><span class="xml">      <span class="hljs-attr">hotGame</span>: <span class="hljs-built_in">this</span>.selectLayout()</span></span><br><span class="javascript"><span class="xml">    &#125;;</span></span><br><span class="javascript"><span class="xml">  &#125;,</span></span><br><span class="javascript"><span class="xml">  <span class="hljs-attr">methods</span>: &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-function"><span class="hljs-title">selectLayout</span>(<span class="hljs-params"></span>)</span> &#123;</span></span><br><span class="javascript"><span class="xml">      <span class="hljs-keyword">let</span> layout = <span class="hljs-built_in">JSON</span>.parse(sessionStorage.getItem(<span class="hljs-string">&#x27;siteInfo&#x27;</span>)).site_params.hot_layout</span></span><br><span class="javascript"><span class="xml">      <span class="hljs-keyword">switch</span> (layout) &#123;</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;layout1&#x27;</span>:</span></span><br><span class="javascript"><span class="xml">          <span class="hljs-keyword">return</span> layout1;</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;layout2&#x27;</span>:</span></span><br><span class="javascript"><span class="xml">          <span class="hljs-keyword">return</span> layout2;</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;layout3&#x27;</span>:</span></span><br><span class="javascript"><span class="xml">          <span class="hljs-keyword">return</span> layout3;</span></span><br><span class="javascript"><span class="xml">      &#125;</span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml">  &#125; </span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure></p><h2 id="動態載入"><a href="#動態載入" class="headerlink" title="動態載入"></a>動態載入</h2><p>import 使用變數來動態載入模組<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> &#123; hot_layout &#125; = <span class="hljs-built_in">this</span>.$store.dispatch(<span class="hljs-string">&#x27;index.siteInfo&#x27;</span>);<br><span class="hljs-keyword">var</span> &#123; vendor_layout &#125; = <span class="hljs-built_in">JSON</span>.parse(sessionStorage.getItem(<span class="hljs-string">&#x27;siteInfo&#x27;</span>));<br><span class="hljs-keyword">var</span> HotGame = <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">`@/views/12.index/hot_layout/<span class="hljs-subst">$&#123;hot_layout&#125;</span>.vue`</span>)<br><span class="hljs-keyword">var</span> VendorGame = <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">`@/views/12.index/vendor_layout/<span class="hljs-subst">$&#123;vendor_layout&#125;</span>.vue`</span>)<br><br><span class="hljs-keyword">var</span> c = <span class="hljs-string">&#x27;components&#x27;</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">components</span>: &#123;<br>    <span class="hljs-attr">Slider</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">`@/views/12.index/<span class="hljs-subst">$&#123;c&#125;</span>/Slider.vue`</span>),<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><br>但是這個方法取得API總會遲一步，所以暫緩沒有使用此方法，在這邊做個紀錄。</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://cn.vuejs.org/v2/guide/components-dynamic-async.html#%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6">官方文件：異步組件</a></li><li><a href="https://cythilya.github.io/2017/10/22/vue-component-dynamic-components/">Vue.js: 動態元件 Dynamic Components</a></li><li><a href="https://blog.hinablue.me/2019-ithome-ironman-day-5/">IT 鐵人賽 - Component 魔術方法 Day 5</a></li><li><a href="https://blog.hinablue.me/vuejs-guan-yu-vue-router-wai-mian-de-liang-san-shi/">VueJS - 關於 vue-router 外面的兩三事</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 自動化導入 SASS Mixin</title>
      <link href="//Vue-%E8%87%AA%E5%8B%95%E5%8C%96%E5%B0%8E%E5%85%A5-SASS-Mixin/"/>
      <url>//Vue-%E8%87%AA%E5%8B%95%E5%8C%96%E5%B0%8E%E5%85%A5-SASS-Mixin/</url>
      
        <content type="html"><![CDATA[<p>專案需要導入全域的 Mixin，以下會介紹要怎麼設定。專案使用的是Vue CLI 3建立的，因此需要自行建立一個<code>vue.config.js</code>檔來修改Webpack設定</p><p>在<a href="https://cli.vuejs.org/zh/guide/css.html#%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8">官方Vue文件的自动化导入</a>說明，我們可以用style-resourses-loader來加載mixin、color等需要全域使用的CSS檔。</p><p>安裝 style-resources-loader<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">npm <span class="hljs-keyword">install</span> style-resources-loader<br></code></pre></td></tr></table></figure><br>接著在專案目錄最外層新增<code>vue.config.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// vue.config.js</span><br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-attr">chainWebpack</span>: <span class="hljs-function"><span class="hljs-params">config</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> oneOfsMap = config.module.rule(<span class="hljs-string">&#x27;scss&#x27;</span>).oneOfs.store<br>    oneOfsMap.forEach(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>      item<br>        .use(<span class="hljs-string">&#x27;sass-resources-loader&#x27;</span>)<br>        .loader(<span class="hljs-string">&#x27;sass-resources-loader&#x27;</span>)<br>        .options(&#123;<br>          <span class="hljs-comment">// 單隻檔案引入</span><br>          <span class="hljs-attr">resources</span>: [path.resolve(__dirname, <span class="hljs-string">&#x27;./src/style/mixin.scss&#x27;</span>)],<br><br>          <span class="hljs-comment">// 多檔案引入</span><br>          <span class="hljs-comment">// resources: [&#x27;./path/to/vars.scss&#x27;, &#x27;./path/to/mixins.scss&#x27;]</span><br>        &#125;)<br>        .end()<br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></p><p>設定完後，重新啟動<code>npm run serve</code>，即可不用個別在component引入mixin.scss，也可以使用@include了</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://cli.vuejs.org/zh/guide/css.html#%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8">Vue - 自动化导入</a></li><li><a href="https://github.com/yenshih/style-resources-loader">Github Style-resources-loader</a></li><li><a href="https://github.com/shakacode/sass-resources-loader/issues/38">Module build failed: Error: Something wrong with provided resources. Make sure ‘options.resources’ is String or Array of Strings. </a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Docker Network</title>
      <link href="//Docker-Network/"/>
      <url>//Docker-Network/</url>
      
        <content type="html"><![CDATA[<p>Docker Network 筆記及練習</p><h2 id="Docker-Network-指令"><a href="#Docker-Network-指令" class="headerlink" title="Docker Network 指令"></a>Docker Network 指令</h2><h3 id="Container-Port-與協議"><a href="#Container-Port-與協議" class="headerlink" title="Container Port 與協議"></a>Container Port 與協議</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> port<span class="hljs-meta"> [container_ID]</span><br></code></pre></td></tr></table></figure><h3 id="Docker-Container-IP"><a href="#Docker-Container-IP" class="headerlink" title="Docker Container IP"></a>Docker Container IP</h3><p>顯示Container IP</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> inspect<span class="hljs-meta"> [container_ID]</span><br></code></pre></td></tr></table></figure><h3 id="顯示所有-networks"><a href="#顯示所有-networks" class="headerlink" title="顯示所有 networks"></a>顯示所有 networks</h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">docker network ls</span><br></code></pre></td></tr></table></figure><h3 id="篩選-network"><a href="#篩選-network" class="headerlink" title="篩選 network"></a>篩選 network</h3><p>篩選bridge的network</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="xml">docker network ls -f driver=bridge</span><br><span class="xml">自訂格式 ID: Driver方式顯示</span><br><span class="xml">docker network ls --format &#x27;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">.ID</span>&#125;&#125;</span><span class="xml"> : </span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">.Driver</span>&#125;&#125;</span><span class="xml">&#x27;</span><br><span class="xml"></span><br></code></pre></td></tr></table></figure><p>打這個指令結果應該會像下面這樣</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ada">ec113447cb40 : <span class="hljs-type">bridge</span><br><span class="hljs-number">226</span>c9faec426 : <span class="hljs-type">host</span><br><span class="hljs-number">27315156</span>c58a : <span class="hljs-keyword"><span class="hljs-keyword">null</span></span><br><span class="hljs-number">1395</span>d970d6de : <span class="hljs-type">bridge</span><br><span class="hljs-number">2</span>cad3a8f93b4 : <span class="hljs-type">bridge</span><br></code></pre></td></tr></table></figure><h3 id="建立-network"><a href="#建立-network" class="headerlink" title="建立 network"></a>建立 network</h3><p>建立 network 在 host 上，會建立預設的 bridge network<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">docker network create</span><br></code></pre></td></tr></table></figure></p><h3 id="建立-bridge-network"><a href="#建立-bridge-network" class="headerlink" title="建立 bridge network"></a>建立 bridge network</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">docker<span class="hljs-built_in"> network </span>create -d<span class="hljs-built_in"> bridge </span>my-bridge-network<br></code></pre></td></tr></table></figure><p>檢查是否建立成功</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">docker network ls</span><br></code></pre></td></tr></table></figure><p>你應該會看到多出一行 network 是 my-bridge-network</p><p>將network和container 連在一起<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> network connect network<span class="hljs-number">1</span><span class="hljs-meta"> [container1]</span><br></code></pre></td></tr></table></figure></p><p>[container1]可以輸入container的name或ID<br>連線成功後，[container1]即可和其他用my-bridge-network的容器溝通</p><h3 id="建立容器並連到network"><a href="#建立容器並連到network" class="headerlink" title="建立容器並連到network"></a>建立容器並連到network</h3><p>範例<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">docker<span class="hljs-built_in"> network </span>create -d<span class="hljs-built_in"> bridge </span>mynetwork<br>docker<span class="hljs-built_in"> network </span>ls<br>docker <span class="hljs-builtin-name">run</span> -d --name my_nginx --network mynetwork nginx<br>docker<span class="hljs-built_in"> network </span>inspect mynetwork<br></code></pre></td></tr></table></figure><br>檢查JSON有個container物件，有出現<code>&quot;Name&quot;: &quot;my_nginx&quot;</code>，表示加入成功<br><img src="../../../images/docker-network.jpg" alt="Docker my_ngix"></p><p>開新的容器叫cool，並連到mynetwork<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">docker <span class="hljs-builtin-name">run</span> -d --name cool --network mynetwork nginx<br>docker<span class="hljs-built_in"> network </span>connect mynetwork cool<br>docker<span class="hljs-built_in"> network </span>inspect mynetwork<br>docker container inspect cool<br></code></pre></td></tr></table></figure></p><h3 id="中斷連線"><a href="#中斷連線" class="headerlink" title="中斷連線"></a>中斷連線</h3><p>cool Container與 mynetwork中斷連線<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">docker network disconnect mynetwork cool<br></code></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MacOS 安裝 GVM</title>
      <link href="//MacOS-%E5%AE%89%E8%A3%9D-GVM/"/>
      <url>//MacOS-%E5%AE%89%E8%A3%9D-GVM/</url>
      
        <content type="html"><![CDATA[<p>我用MacOS作業系統，iterm2、zsh環境，這邊做個紀錄</p><h2 id="移除-Mac-官方-go-安裝檔"><a href="#移除-Mac-官方-go-安裝檔" class="headerlink" title="移除 Mac 官方 go 安裝檔"></a>移除 Mac 官方 go 安裝檔</h2><p>我們要裝GVM，要先移除官方版本的GO 安裝檔，<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">rm <span class="hljs-regexp">/usr/</span>local/go<br>rm <span class="hljs-regexp">/etc/</span>paths.d/go<br></code></pre></td></tr></table></figure></p><h2 id="安裝-GVM"><a href="#安裝-GVM" class="headerlink" title="安裝 GVM"></a>安裝 GVM</h2><p>zsh<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">zsh &lt; &lt;(curl -s -S -L https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/moovweb/g</span>vm<span class="hljs-regexp">/master/</span>binscripts/gvm-installer)<br></code></pre></td></tr></table></figure><br>bash<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">bash &lt; &lt;(curl -s -S -L https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/moovweb/g</span>vm<span class="hljs-regexp">/master/</span>binscripts/gvm-installer)<br></code></pre></td></tr></table></figure></p><p>安裝完後重啟終端機，輸入gvm就會有東西了</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://andyyou.github.io/2019/04/14/gvm-cheat-sheet/">gvm on macOS installation cheatsheet</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Go </tag>
            
            <tag> GVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>攻略：用Jenkins 從 0 到 1 打造強大的前端自動化工作流</title>
      <link href="//%E6%94%BB%E7%95%A5%EF%BC%9A%E7%94%A8Jenkins-%E5%BE%9E-0-%E5%88%B01-%E6%89%93%E9%80%A0%E5%BC%B7%E5%A4%A7%E7%9A%84%E5%89%8D%E7%AB%AF%E8%87%AA%E5%8B%95%E5%8C%96%E5%B7%A5%E4%BD%9C%E6%B5%81/"/>
      <url>//%E6%94%BB%E7%95%A5%EF%BC%9A%E7%94%A8Jenkins-%E5%BE%9E-0-%E5%88%B01-%E6%89%93%E9%80%A0%E5%BC%B7%E5%A4%A7%E7%9A%84%E5%89%8D%E7%AB%AF%E8%87%AA%E5%8B%95%E5%8C%96%E5%B7%A5%E4%BD%9C%E6%B5%81/</url>
      
        <content type="html"><![CDATA[<p>這篇要教導你如何用CI/CD最可靠的工具：Jenkins來打造自動化的前端環境。會有這篇文章是因為公司的專案一直以來都是手動部署的方式，每當更新程式碼要測試時，都需要找有權限的同事幫忙手動部署，一天請同事幫忙五六次都會覺得不好意思。非常希望能夠每次在git push專案時，便會自動抓最新的程式碼並部署在測試伺服器上。</p><p>持續整合、持續交付（Continuous Integration &amp; Continous Delivery）簡稱CI/CD，盡量減少手動人力，將一些日常工作交給自動化工具，例如：環境建置、單元測試、日誌紀錄、產品部署。</p><p>如果沒有 <code>CI/CD</code>，前端要更新程式碼的工作流程會是這樣</p><ol><li>本地端寫程式</li><li>提交程式碼，Push到Git Reporistory</li><li>提交程式碼，Push到Git Reporistory</li><li>終端機輸入npm run test:unit，看單元測試結果</li><li>存檔程式碼，Git Commit後並Push到Github Reporistory</li><li>連線到測試伺服器，移動到專案，git pull下來、執行npm run build</li></ol><p>有了CI/CD後，整個流程就會變成像下面這樣</p><ol><li>本地端寫程式</li><li></li></ol><h2 id="專案用了哪些工具"><a href="#專案用了哪些工具" class="headerlink" title="專案用了哪些工具"></a>專案用了哪些工具</h2><ul><li>Git 版本控制</li><li>GitHub 程式碼託管、審查</li><li>Jenkins 自動化建置、測試、部署</li><li>Docker 可攜式、輕量級的執行環境</li><li>Slack 團隊溝通、日誌、通知</li></ul><h2 id="看完這篇你能得到什麼？"><a href="#看完這篇你能得到什麼？" class="headerlink" title="看完這篇你能得到什麼？"></a>看完這篇你能得到什麼？</h2><ul><li>實際操作，瞭解CI/CD的好處</li><li>瞭解如何設定 Jenkins 在前端 Vue 的專案上</li></ul><h2 id="專案環境"><a href="#專案環境" class="headerlink" title="專案環境"></a>專案環境</h2><p>以下的專案環境是用CentoOS Linux 7.7.1908做安裝及設定<br>前端專案Vue、後端專案Laravel，專案有設定前後端分離，也就是前端一包專案、後端一包專案，後端只產生API給前端接<br>Vue專案及Jenkins都安裝在測試主機上，並沒有個開</p><h2 id="自動部署做了哪些事？"><a href="#自動部署做了哪些事？" class="headerlink" title="自動部署做了哪些事？"></a>自動部署做了哪些事？</h2><p>自動部署會先去Github將專案最新程式碼拉下來，並開始安裝套件<code>npm install</code>，接著再用webpack打包檔案<code>npm run build:prod</code><br>打包完會產生一包<code>dist</code>資料夾，dist資料夾會對應到後端專案的MVC裡的View。</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> cache clean -force<br><span class="hljs-built_in">npm</span> install<br><span class="hljs-built_in">npm</span> run build:prod<br></code></pre></td></tr></table></figure><h2 id="步驟"><a href="#步驟" class="headerlink" title="步驟"></a>步驟</h2><p>我會分成下面幾個步驟</p><ol start="0"><li>Centos 安裝 Docker </li><li>用 Docker來安裝 Jenkins</li><li>設定Github hook時觸發 Jenkins</li><li>設定前後端分離</li><li>Jenkins和Slack串接，當Jenkins部署時，Slack會發出通知</li></ol><h3 id="Centos-安裝-Docker"><a href="#Centos-安裝-Docker" class="headerlink" title="Centos 安裝 Docker"></a>Centos 安裝 Docker</h3><p>先在Centos卸載舊版本，以避免後續的錯誤<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs livescript">sudo yum remove docker <span class="hljs-string">\</span><br>  docker-client <span class="hljs-string">\</span><br>  docker-client-latest <span class="hljs-string">\</span><br>  docker-common <span class="hljs-string">\</span><br>  docker-latest <span class="hljs-string">\</span><br>  docker-latest-logrotate <span class="hljs-string">\</span><br>  docker-logrotate <span class="hljs-string">\</span><br>  docker-engine<br></code></pre></td></tr></table></figure><br>接著再來安裝 Docker<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs vim">sudo yum <span class="hljs-keyword">update</span><br>sudo yum install -<span class="hljs-keyword">y</span> yum-utils \<br>  device-mapper-persistent-data \<br>  lvm2<br>sudo yum-config-manager \<br>  --<span class="hljs-built_in">add</span>-repo \<br>http<span class="hljs-variable">s:</span>//download.docker.<span class="hljs-keyword">com</span>/linux/centos/docker-<span class="hljs-keyword">ce</span>.repo<br>sudo yum install docker-<span class="hljs-keyword">ce</span><br></code></pre></td></tr></table></figure><br>啟動 Docker<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">sudo systemctl <span class="hljs-literal">start</span> docker<br></code></pre></td></tr></table></figure><br>設定每次開機都會自動啟動 Docker<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">duso systemctl <span class="hljs-builtin-name">enable</span> docker<br></code></pre></td></tr></table></figure></p><h3 id="建立客製化DockerFile"><a href="#建立客製化DockerFile" class="headerlink" title="建立客製化DockerFile"></a>建立客製化DockerFile</h3><p>新增一個Dockerfile檔在伺服器的/var/dockerContainer資料夾<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">cd <span class="hljs-regexp">/var/</span>dockerContainer<br>touch Dockerfile<br></code></pre></td></tr></table></figure><br>編輯Dockerfile檔，我們會下載jenkinsci/blueocean的image並先安裝nodejs與npm，之所以要客製化是因為我安裝很多次Jenkins的NodeJS Plugin一直失敗，沒辦法跑<code>npm install</code>，一直報錯說找不到npm，只好徒法煉鋼，先客製化images，在images除了用現成的jenkins blueocean版本，另外也先裝好nodeJS、npm。</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Dockerfile"><span class="hljs-comment"># 從 DockerHub 安裝 Jenkinsci/blueocean image。</span><br><span class="hljs-keyword">FROM</span> jenkinsci/blueocean<br><br><span class="hljs-comment"># 指定 User 是 root，有最大權限。</span><br><span class="hljs-keyword">USER</span> root<br><br><span class="hljs-comment"># 設定 Container 的預設目錄位置。</span><br><span class="hljs-keyword">WORKDIR</span><span class="bash"> /var/jenkins_home/workspace/project</span><br><br><span class="hljs-comment"># 安裝 NodeJS、Npm。</span><br><span class="hljs-keyword">RUN</span><span class="bash"> apk add --no-cache --update nodejs npm</span><br></code></pre></td></tr></table></figure><p>編輯好Dockerfile並存檔，我們先來build image<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">docker build -t frontend-ui-image .<br></code></pre></td></tr></table></figure><br>成功跑完後你可以輸入<code>docker images</code>會看到frontend-ui的images檔，接著利用它為基底，啟動container<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livescript">docker run -d<br>  --name frontend-ui <span class="hljs-string">\</span><br>  -p <span class="hljs-number">8080</span>:<span class="hljs-number">8080</span> <span class="hljs-string">\</span><br>  -u root <span class="hljs-string">\</span><br>  -e JAVA_OPTS=-Dorg.apache.commons.jelly.tags.fmt.timeZone=Asia/Taipei <span class="hljs-string">\</span><br>  -v /<span class="hljs-keyword">var</span>/data:/<span class="hljs-keyword">var</span>/jenkins_home <span class="hljs-string">\</span><br>  -v /<span class="hljs-keyword">var</span>/run/docker.sock:/<span class="hljs-keyword">var</span>/run/docker.sock <span class="hljs-string">\</span><br>  -v <span class="hljs-string">&quot;$HOME&quot;</span>:/home <span class="hljs-string">\</span><br>  --restart=always <span class="hljs-string">\</span><br>  frontend-ui-image<br></code></pre></td></tr></table></figure><br>以下將說明參數的用途</p><ul><li>–name frontend-ui：容器名稱命名為frontend-ui</li><li>-p 8080:8080：映射出8080 Port與容器裡的8080 Port 相應</li><li>-u root：以User root身份執行，否則會沒有權限</li><li>-e JAVA_OPTS=-Dorg.apache.commons.jelly.tags.fmt.timeZone=Asia/Taipei，設定環境變數時區，沒有設定此選項，會導致Jenkins的時間不是UTM+8</li><li>-v /var/data:/var/jenkins_home：容器的儲存空間/var/jenkins_home 此目錄會映射到容器外的/var/data資料夾</li><li>–restart=always：當容器遇到例外的情況被STOP掉，例如是重新開機，Docker 會試著重新啟動此容器</li><li>frontend-ui-image：用Images frontend-ui-image啟動容器</li></ul><p>順利啟動容器後，打開伺服器網址：xxx.xxx.xxx.xxx:8080，便會看到Jenkin成功畫面<br><img src="../../../images/jenkins-success.png" alt="Jenkins"></p><p>進入Jenkins後，請先安裝Jenkins預設外掛<br><img src="../../../images/jenkins-install.png" alt="Jenkins Install"></p><h3 id="設定-Github-Hook-觸發-Jenkins"><a href="#設定-Github-Hook-觸發-Jenkins" class="headerlink" title="設定 Github Hook 觸發 Jenkins"></a>設定 Github Hook 觸發 Jenkins</h3><p>接著我們要來設定每次Git Push時會觸發專案啟動Jenkins，在設定前我們需要先新增專案<br>Jenkins點擊新增作業，選取「建置 Free-Style 軟體專案」</p><p><img src="../../../images/jenkins-free-style.jpg" alt="Jenkins 建置 Free-Style 軟體專案"></p><p>選好之後點OK進入到下一步，接著近一步細部設定，原始碼管理區塊要設定專案網址，並設定Github的帳號密碼，讓Jenkins有權限可以讀取專案。<br>在建置觸發程序要打勾「GitHub hook trigger for GITScm polling」，當GitHub Repository有變動時會自動通知 Jenkins 來進行編譯<br><img src="../../../images/jenkins-step3.jpg" alt="Jenkins 原始碼管理、建置觸發程序"></p><p>除了設定Jenkins要進行編譯之外，Github Repository這端也要設定 Webhook</p><ul><li>Github 點擊專案的 Setting，加入 web-hook<br>Payload URL 網址設定為你的Jenkins Server 網址，例：<a href="http://serverIP:8080/github-webhook/，Content">http://serverIP:8080/github-webhook/，Content</a> Type 要設定 application/json<br>Secret設定為空沒有關係，另外有詢問你什麼時候要觸發這個webhook，在圖片上是設定當只有push 事件發生時，才會觸發，當然你也可以客製化</li><li>Jest the push event：只有push事件發生才會觸發 webhook</li><li>Send me everything：不管發生什麼事，都會觸發 webhook</li><li>Let me select individual events.：選取這個可以客製化哪些event才要觸發</li></ul><p><img src="../../../images/webhook-add.jpg" alt="加入webhook設定"><br>設定完會像下面這張圖片一樣<br><img src="../../../images/webhook.jpg" alt="webhook"></p><ul><li>確保Server 8080的Port有開啟，沒有被防火牆擋住，開8080 Port才能讓流量進來，Github才能Call得到Jenkins</li></ul><h3 id="設定前後端分離"><a href="#設定前後端分離" class="headerlink" title="設定前後端分離"></a>設定前後端分離</h3><p>Web Server是採用nginx，後端是用Php Laravel框架，前端是用webpack打包成一包dist資料夾後，用軟連結映射到後端專案的public/static、/resources/views/index.blade.php，才能順利以view方式顯示，同時也可以解決前端打後端專案的API有CROS跨網域問題。</p><p>project 是前端專案名稱<br>backend-project 是後端專案名稱<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gradle"># 直接在server上做設定<br>ln -s <span class="hljs-regexp">/var/</span>data<span class="hljs-regexp">/workspace/</span><span class="hljs-keyword">project</span><span class="hljs-regexp">/dist/</span><span class="hljs-keyword">static</span> <span class="hljs-regexp">/home/</span>vhost<span class="hljs-regexp">/backend-project/</span><span class="hljs-keyword">public</span>/<span class="hljs-keyword">static</span><br>ln -s <span class="hljs-regexp">/var/</span>data<span class="hljs-regexp">/workspace/</span><span class="hljs-keyword">project</span><span class="hljs-regexp">/dist/i</span>ndex.html <span class="hljs-regexp">/home/</span>vhost<span class="hljs-regexp">/backend-project/</span>resources<span class="hljs-regexp">/views/i</span>ndex.blade.php<br></code></pre></td></tr></table></figure></p><p>nginx 設定<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment"># /etc/nginx/conf.d/project</span><br><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">listen</span> [::]:<span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">root</span> /home/vhost/backend-project/public;<br>    <span class="hljs-attribute">index</span> index.php index.html index.htm;<br><br>    <span class="hljs-attribute">server_name</span> xx.xx.xxxx.xx;<br><br>    <span class="hljs-attribute">location</span> / &#123;<br>        <span class="hljs-attribute">try_files</span> $uri $uri/ /index.php?$query_string;<br>    &#125;<br>    <span class="hljs-attribute">location</span> <span class="hljs-regexp">~ \.php$</span> &#123;<br>        <span class="hljs-attribute">fastcgi_pass</span>   <span class="hljs-number">127.0.0.1:9000</span>;<br>        <span class="hljs-attribute">fastcgi_index</span>  index.php;<br>        <span class="hljs-attribute">fastcgi_param</span>  SCRIPT_FILENAME  $document_root$fastcgi_script_name;<br>        <span class="hljs-attribute">include</span>        fastcgi_params;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></p><h3 id="在Jenkins上串Salck"><a href="#在Jenkins上串Salck" class="headerlink" title="在Jenkins上串Salck"></a>在Jenkins上串Salck</h3><p>接著設定Slack，先在Jenkins安裝Slack外掛<br>點選「管理Jenins」-&gt; 「設定系統」-&gt; Slack區塊，設定Workspace、Credential<br>這邊是屬於全域設定的部分，皆會套用到所有Jenkins的專案</p><p><img src="../../../images/Slack.png" alt="slack"><br>Credential的Kind選Secret text，Secret填Slack給的Token Key，ID和Description可以自由選填<br>至於Token Key可以從Slack 的Jenkins頁面拿到<br><img src="../../../images/jenken-slack-token.jpg" alt="Token"></p><p><img src="../../../images/Jenkins-credential.png" alt="slack"><br>設定成功後，可以試試看點按鈕「Test Connection」，如果成功的話，會在下方顯示Success，且Slack頻道上會有機器人說話<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">Slack/Jenkins <span class="hljs-keyword">plugin</span>: you&#x27;re all <span class="hljs-keyword">set</span> <span class="hljs-keyword">on</span> http:<span class="hljs-comment">//www.test-jenkins:8080/</span><br></code></pre></td></tr></table></figure><br><img src="../../../images/Jenkins-Slack-success.jpg" alt="Slack"></p><h2 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h2><p>一開始安裝Jenkins是用Docker Images: jenkins，預設外掛都不能安裝，才發現要裝 Images: jenkins/jenkins，而不是jenkins。<br>用Images jenkins/jenkins啟動容器後發現第二個問題是容器內沒有node.js，裝了外掛NodeJS仍無法解決我的問題，最後還是自製Images比較快。<br>不過CI/CD還是很單調的流程，還沒有到很複雜，至今也還在學習中，如果有問題或是有寫錯的地方，歡迎下面留言喔</p><ul><li>[X] jenkins：images版本過舊</li><li>[X] jenkins/jenins：沒有nodeJS，Jenkins 外掛 NodeJS也無法使用</li><li>[X] jenkinsci/blueocean：沒有nodeJS，Jenkins 外掛 NodeJS也無法使用</li><li>[O] frontend-ui-image：自製images，jenkinsci/blueocean + 自行安裝nodeJS</li></ul><p>之所以後來選擇images是採用jenkinsci/blueocean的版本，也是看上它有很漂亮的UI、使用者體驗佳，至今還在摸索中，如果有更多的心得會再多寫一篇文章分享，謝謝看到這裡<br><img src="../../../images/jenkins-blueocean.jpg" alt="Jenkins BlueOcean Snapper"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://docs.docker.com/install/linux/docker-ce/centos/">Centos Install Docker Document</a></li><li><a href="https://samkuo.me/post/2013/11/principles-continuous-delivery/">持續交付的8條原則</a></li><li><a href="https://samkuo.me/post/2013/10/continuous-integration-deployment-delivery/">山姆鍋對持續整合、持續部署、持續交付的定義</a></li><li><a href="https://www.jianshu.com/p/47d767cf893d">永久修改以容器化方式运行的Jenkins系统时间</a></li><li><a href="https://jenkins.io/blog/2016/05/26/introducing-blue-ocean/">Introducing Blue Ocean: a new user experience for Jenkins</a></li><li><a href="https://juejin.im/entry/5a8f919af265da4e8e787606">前端开发如何让持续集成 / 持续部署 (CI/CD) 跑起来</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 自動部署 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Jenkins </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 元件之間的傳話筒 總整理</title>
      <link href="//Vue-%E5%85%83%E4%BB%B6%E4%B9%8B%E9%96%93%E7%9A%84%E5%82%B3%E8%A9%B1%E7%AD%92-%E7%B8%BD%E6%95%B4%E7%90%86/"/>
      <url>//Vue-%E5%85%83%E4%BB%B6%E4%B9%8B%E9%96%93%E7%9A%84%E5%82%B3%E8%A9%B1%E7%AD%92-%E7%B8%BD%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>使用 Vue 建構網站，會越來越多元件，元件之間的溝通非常重要，常常需要傳遞資訊，讓彼此知道，讓資訊流通是一件非常重要的事！</p><ol><li>Props 父傳子<ul><li>Parent =&gt; Child Communication</li></ul></li><li>$emit 子傳父<ul><li>自定義事件，Child =&gt; Parent Communication</li></ul></li><li>Event Bus<ul><li>類似於 Angular 2 的 services 用法</li></ul></li></ol><h3 id="Props-父傳子"><a href="#Props-父傳子" class="headerlink" title="Props 父傳子"></a>Props 父傳子</h3><p>用 Props 來傳遞資料，主元件要在外圍寫要傳什麼值進去，像是下面的範例，父元件傳了name給子元件值是Hazel。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 父元件 User.vue</span><br>&lt;user-detail :myName=<span class="hljs-string">&quot;Hazel&quot;</span>&gt;&lt;/user-detail&gt;<br></code></pre></td></tr></table></figure><p>子元件要新增 props 屬性來接收資料，接收到的name可以直接使用在其他地方，像是下面範例，接收到從父元件傳來的name，並使用在<code>switchName()的Methods</code>裡。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 子元件 UserDetail.vue</span><br>&lt;template&gt;<br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span> User Name: &#123;&#123; switchName() &#125;&#125; <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-attr">props</span>: [<span class="hljs-string">&#x27;myName&#x27;</span>],<br>    <span class="hljs-attr">methods</span>: &#123;<br>        <span class="hljs-function"><span class="hljs-title">switchName</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.myName.split(<span class="hljs-string">&#x27;&#x27;</span>).reverse().join(<span class="hljs-string">&#x27;&#x27;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></p><h4 id="限制-Props-資料類型"><a href="#限制-Props-資料類型" class="headerlink" title="限制 Props 資料類型"></a>限制 Props 資料類型</h4><p>Prop 還能夠驗證資料型態，比如說在子元件下我們可以這樣寫<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 驗證 Props</span><br><span class="hljs-attr">props</span>: [<span class="hljs-string">&#x27;myName&#x27;</span>, <span class="hljs-string">&#x27;age&#x27;</span>, <span class="hljs-string">&#x27;book&#x27;</span>]<br><span class="hljs-attr">props</span>: &#123;<br>    <span class="hljs-string">&#x27;myName&#x27;</span>: <span class="hljs-built_in">String</span>,<br>    <span class="hljs-string">&#x27;age&#x27;</span>: <span class="hljs-built_in">Number</span>,<br>    <span class="hljs-string">&#x27;book&#x27;</span>: <span class="hljs-built_in">Object</span><br>&#125;<br></code></pre></td></tr></table></figure><br>當myName值傳來不是String格式便會報錯，會在 Console.log 提示開發者由於傳遞錯誤的型態。<br>我們可以用這種方式來驗證資料，以避免程式出錯。</p><h3 id="Emit-子傳父"><a href="#Emit-子傳父" class="headerlink" title="Emit 子傳父"></a>Emit 子傳父</h3><p>剛剛介紹了 Prop：父元件傳遞資料給子元件，但當子元件想要傳遞資料給父元件，該如何傳遞？我們會用到 <code>emit</code> 客製化事件來做到這件事</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-symbol">$emit</span>(<span class="hljs-string">&#x27;事件名稱&#x27;</span>, 要傳遞的值)<br></code></pre></td></tr></table></figure><p>以下程式碼做的處理</p><ol><li>從子元件接收到myName的值</li><li>子元件內 reset myName 值</li><li>回傳給父元件</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// UserDetail.vue 子元件</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-attr">props</span>: &#123;<br>        <span class="hljs-attr">myName</span>: &#123;<br>            <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span><br>        &#125;<br>    &#125;,<br>    <span class="hljs-attr">methods</span>: &#123;<br>        <span class="hljs-function"><span class="hljs-title">switchName</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.myName.split(<span class="hljs-string">&#x27;&#x27;</span>).revverse().join(<span class="hljs-string">&#x27;&#x27;</span>);<br>        &#125;,<br>        <span class="hljs-function"><span class="hljs-title">resetName</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-built_in">this</span>.myName = <span class="hljs-string">&#x27;Hazel&#x27;</span>;<br>            <span class="hljs-built_in">this</span>.$emit(<span class="hljs-string">&#x27;nameWasReset&#x27;</span>, <span class="hljs-built_in">this</span>.myName);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>子元件用<code>nameWasReset</code>事件傳遞<br>要接收訊息的父元件也要設定，將子元件設定的事件名稱用<code>@</code>當前綴<br><code>@nameWasReset=&quot;name = $event&quot;</code>，並存在父元件的資料name內。</p><blockquote><h3 id="小教學：關於Vue的-event"><a href="#小教學：關於Vue的-event" class="headerlink" title="小教學：關於Vue的$event"></a>小教學：關於Vue的$event</h3><p>$event 為 Vue內的特殊用法，相同於 JavaScript的 event<br>$event 為子元間傳遞出來的值。</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// User.vue 父元件</span><br>&lt;template&gt;<br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">user-detail</span> <span class="hljs-attr">:myName</span>=<span class="hljs-string">&quot;name&quot;</span> @<span class="hljs-attr">nameWasReset</span>=<span class="hljs-string">&quot;name =$event&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user-detail</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-function"><span class="hljs-title">data</span>(<span class="hljs-params"></span>)</span>&#123;</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="javascript"><span class="xml">            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Hazel&#x27;</span></span></span><br><span class="javascript"><span class="xml">        &#125;</span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h4 id="Vue-單向資料流"><a href="#Vue-單向資料流" class="headerlink" title="Vue 單向資料流"></a>Vue 單向資料流</h4><p>單向資料流定義：只能從一個方向來修改，可以由父元件傳遞資料給子元件，但子元件無法反過來直接改變父元件的資料，會引起報錯。也就是只能父元件影響子，子無法影響父。</p><blockquote><h4 id="總結一句話：單向資料流只能父傳子、子傳父。"><a href="#總結一句話：單向資料流只能父傳子、子傳父。" class="headerlink" title="總結一句話：單向資料流只能父傳子、子傳父。"></a>總結一句話：單向資料流只能父傳子、子傳父。</h4><p>Unidirectional Data Flow from top to bottom.</p></blockquote><p>如果 A 的子元件想傳遞給 B 的子元件，平行傳資料是可行的嗎？<br>在Vue內，由於單向資料流的關係，無法子傳給子，是無法平行傳資料。</p><h3 id="CallBack-Function"><a href="#CallBack-Function" class="headerlink" title="CallBack Function"></a>CallBack Function</h3><p>透過Props傳遞 function 也能做到元件溝通<br>父元件利用 Props 傳遞 resetFn()，值帶入methods的resetName()方法給子元件。<br>而子元件則用Props接收。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 父元件</span><br>&lt;template&gt;<br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">user-detail</span> <span class="hljs-attr">:myName</span>=<span class="hljs-string">&quot;name&quot;</span> @<span class="hljs-attr">nameWasReset</span>=<span class="hljs-string">&quot;name =$event&quot;</span> <span class="hljs-attr">:resetFn</span>=<span class="hljs-string">&quot;resetName&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user-detail</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">import</span> UserDetail <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./UserDetail.vue&#x27;</span>;</span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-function"><span class="hljs-title">data</span>(<span class="hljs-params"></span>)</span>&#123;</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="javascript"><span class="xml">            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Hazel&#x27;</span></span></span><br><span class="javascript"><span class="xml">        &#125;</span></span><br><span class="javascript"><span class="xml">    &#125;,</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-function"><span class="hljs-title">resetName</span>(<span class="hljs-params"></span>)</span>&#123;</span></span><br><span class="javascript"><span class="xml">            <span class="hljs-built_in">this</span>.name = <span class="hljs-string">&#x27;Hazel&#x27;</span>;</span></span><br><span class="javascript"><span class="xml">        &#125;</span></span><br><span class="javascript"><span class="xml">    &#125;,</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-attr">components</span>: &#123;</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-attr">UserDetail</span>: UserDetail,</span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>下列程式碼是子元件接受來自父元件的<code>resetFn()</code>，型態是Function。<br>當點擊按鈕時會呼叫<code>resetFn()</code>，而值則是從父元件傳遞來的。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 子元件</span><br>&lt;template&gt;<br>    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;resetFn()&quot;</span>&gt;</span>Reset Function<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-attr">props</span>: &#123;</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-attr">myName</span>: &#123;</span></span><br><span class="javascript"><span class="xml">            <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span></span></span><br><span class="javascript"><span class="xml">        &#125;,</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-attr">resetFn</span>: <span class="hljs-built_in">Function</span>,</span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure></p><h3 id="兄弟-Sibling-元件間的傳值"><a href="#兄弟-Sibling-元件間的傳值" class="headerlink" title="兄弟(Sibling)元件間的傳值"></a>兄弟(Sibling)元件間的傳值</h3><p>Communication between sibling components</p><p>假設我們今天有 A 與 B 的子元件，要如何實行 A 與 B 間的傳遞？</p><ul><li>父元件：User</li><li>A子元件：UserEdit</li><li>B子元件：UserDetail</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 父元件 User 傳遞值</span><br>&lt;template&gt;<br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">user-edit</span> <span class="hljs-attr">:userAge</span>=<span class="hljs-string">&quot;age&quot;</span> @<span class="hljs-attr">ageWasEdited</span>=<span class="hljs-string">&quot;age = $event&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user-edit</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">user-detail</span> <span class="hljs-attr">:userAge</span>=<span class="hljs-string">&quot;age&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">user-detail</span>&gt;</span></span><br><span class="xml"></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>User Age: &#123;&#123;userAge&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="xml"></span><br><span class="xml"></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-function"><span class="hljs-title">data</span>(<span class="hljs-params"></span>)</span>&#123;</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="javascript"><span class="xml">            <span class="hljs-attr">age</span>: <span class="hljs-string">&#x27;25&#x27;</span></span></span><br><span class="javascript"><span class="xml">        &#125;</span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>A 與 B 子元件皆接收 userAge 資料，並驗證 Number值<br>A元件用$emit：ageWasEdited傳回age值為30給父元件<br>B元件也會一併跟著更改。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// A 子元件：UserEdit</span><br>&lt;template&gt;<br><br>    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>User Age: &#123;&#123;userAge&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br>    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;editAge&quot;</span>&gt;</span>Edit Age<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-attr">props</span>: &#123;</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-attr">userAge</span>: <span class="hljs-built_in">Number</span></span></span><br><span class="javascript"><span class="xml">    &#125;,</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-attr">methods</span>: &#123;</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-function"><span class="hljs-title">editAge</span>(<span class="hljs-params"></span>)</span>&#123;</span></span><br><span class="javascript"><span class="xml">            <span class="hljs-built_in">this</span>.userAge = <span class="hljs-number">30</span>;</span></span><br><span class="javascript"><span class="xml">            <span class="hljs-built_in">this</span>.$emit(<span class="hljs-string">&#x27;ageWasEdited&#x27;</span>, <span class="hljs-built_in">this</span>.userAge);</span></span><br><span class="javascript"><span class="xml">        &#125;</span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>以下是B元件 UserDetail ，B元件作用為 接收父元件的 UserAge 值<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// B 子元件：UserDetail</span><br>&lt;template&gt;<br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>User Age: &#123;&#123;userAge&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br>&lt;/template&gt;<br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="javascript"><span class="xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="javascript"><span class="xml">    <span class="hljs-attr">props</span>: &#123;</span></span><br><span class="javascript"><span class="xml">        <span class="hljs-attr">userAge</span>: <span class="hljs-built_in">Number</span></span></span><br><span class="javascript"><span class="xml">    &#125;</span></span><br><span class="javascript"><span class="xml">&#125;</span></span><br><span class="javascript"><span class="xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><br>從上面範例可以看出，當我們需要平行傳遞兄弟間的元件資料，可以用以下做法。</p><ol><li>父用props傳遞給 A 子元件</li><li>A 子元件 子用 $emit 回傳父，改變父資料</li><li>再由父傳給另一個 B 子元件</li></ol><h2 id="Event-Bus：溝通橋樑"><a href="#Event-Bus：溝通橋樑" class="headerlink" title="Event Bus：溝通橋樑"></a>Event Bus：溝通橋樑</h2><ul><li>Event Bus 的定位是事件通知。</li><li>Event Bus使用時機：有件事要被很多人知道，可以用Event Bus來做傳遞，當傳話筒的角色，也可以形容成溝通橋樑的概念。</li><li>EventBus像元件一樣，擁有data, methods等屬性可以使用。</li><li>Event Bus 透過 $emit 來發送資料、用 $on 來接收訊息。</li></ul><p>下列的範例會示範 A子元件與B子元件的溝通，但不會傳值到父元件。</p><ol><li>在main.js 建立一個 Vue instance 叫 eventBus</li><li>要使用event bus傳遞訊息的元件上，import event bus進來</li><li>在元件的methods上使用 <code>eventBus.$emit</code> 傳遞值</li></ol><p>步驟一：創建 eventBus 的 instance<br>注意：要把eventBus建立在new Vue上，否則會報錯。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// main.js</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> eventBus = <span class="hljs-keyword">new</span> Vue();<br><span class="hljs-keyword">new</span> Vue(&#123;<br>    <span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;#app&#x27;</span>,<br>    <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> h(App)<br>&#125;)<br></code></pre></td></tr></table></figure><br>步驟二：要使用傳遞資料的元件上，import eventBus<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// userEdit 元件</span><br>&lt;script&gt;<br><span class="hljs-keyword">import</span> &#123; eventBus &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../main&#x27;</span>;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure></p><p>步驟三：用eventBus.$emit 傳遞值<br>eventBus 是一個 Vue instance，而 Vue instance 內建有 $emit 的methods可以用。</p><blockquote><p><code>eventBus.$emit(&#39;事件名稱&#39;, 值)</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script&gt;<br><span class="hljs-keyword">import</span> &#123; eventBus &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../main&#x27;</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-attr">props</span>: [<span class="hljs-string">&#x27;userAge],</span><br><span class="hljs-string">    methods: &#123;</span><br><span class="hljs-string">        editAge()&#123;</span><br><span class="hljs-string">            this.userAge = 30;</span><br><span class="hljs-string">            // this.$emit(&#x27;</span>ageWasEdited<span class="hljs-string">&#x27;, this.userAge) 第二種方法：$emit傳值</span><br><span class="hljs-string">            eventBus.$emit(&#x27;</span>ageWasEdited<span class="hljs-string">&#x27;, this.userAge) // 第三種方法：eventBus傳值</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&lt;/script&gt;</span><br></code></pre></td></tr></table></figure><p>B 子元件 要接收值，也需要import eventBus，而接收值要使用到$on</p><blockquote><p><code>eventBus.$on(&#39;事件名稱&#39;, callback function)</code><br>接收ageWasEdited事件，回傳的data用callback function，再針對data做一系列的處理。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// B子元件 UserDetail</span><br>&lt;script&gt;<br><span class="hljs-keyword">import</span> &#123; eventBus &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../main&#x27;</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-attr">props</span>: &#123;<br>        <span class="hljs-attr">userAge</span>: <span class="hljs-built_in">Number</span><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-title">created</span>(<span class="hljs-params"></span>)</span>&#123;<br>        eventBus.$on(<span class="hljs-string">&#x27;ageWasEdited&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">age</span>) =&gt;</span> &#123;<br>            <span class="hljs-built_in">console</span>.log(age);<br>            <span class="hljs-built_in">this</span>.userAge = age; <span class="hljs-comment">// 將傳來的age存進userAge內</span><br>        &#125;);<br>    &#125;<br>&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure></p></blockquote><h3 id="EventBus-方法"><a href="#EventBus-方法" class="headerlink" title="EventBus 方法"></a>EventBus 方法</h3><p>eventBus 除了可以讓子元件平行溝通之外，也能建立methods方法，並讓元件們共用。</p><ol><li>建立 eventBus 的 Vue instance，建立 changeAge 的 methods</li><li>在要使用的子元件上 import eventBus</li></ol><p>main.js上建立eventBus，並設定changeAge方法，接收參數age<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// main.js</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> eventBus = <span class="hljs-keyword">new</span> Vue(&#123;<br>    <span class="hljs-attr">methods</span>: &#123;<br>        <span class="hljs-function"><span class="hljs-title">changeAge</span>(<span class="hljs-params">age</span>)</span>&#123;<br>            <span class="hljs-built_in">this</span>.$emit(<span class="hljs-string">&#x27;ageWasEdited&#x27;</span>, age)<br>        &#125;<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>子元件 UserEdit.vue 利用 eventBus 的 changeAge 方法，傳遞userAge資料<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; eventBus &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../main&#x27;</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-attr">props</span>: [userAge],<br>    <span class="hljs-attr">methods</span>: &#123;<br>        <span class="hljs-function"><span class="hljs-title">editAge</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-built_in">this</span>.userAge = <span class="hljs-number">30</span>;<br>            eventBus.changeAge(<span class="hljs-built_in">this</span>.userAge);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><br>同樣的 eventBus 也像元件一樣也擁有 data的屬性可儲存，這可以讓我們自由運用。</p><h3 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h3><ul><li>props：父傳子</li><li>emit：子傳父</li><li>eventBus：使用上非常方便，但維護性不高，最好把握幾個原則<ol><li>僅限於同層的兄弟元件通訊，父子通訊透過 Props / $emit 來進行溝通</li><li>eventBus缺點是記憶體會殘留，有監聽的地方要記得去清除，像是beforeDestroy等。</li><li>專案規模很大，可以考慮用 vuex來管理共同狀態。</li></ol></li></ul><p>以上重整理 Vue 元件間如何傳遞資料，若有誤歡迎留言告訴我，謝謝。</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://dotblogs.com.tw/wasichris/2017/03/05/181549">[Vue] 跟著 Vue 闖蕩前端世界 - 07 組件溝通 event bus</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FrameWork 7 與 H5 邂逅的雷坑</title>
      <link href="//FrameWork-7-%E8%88%87-H5%E9%82%82%E9%80%85%E7%9A%84%E9%9B%B7%E5%9D%91/"/>
      <url>//FrameWork-7-%E8%88%87-H5%E9%82%82%E9%80%85%E7%9A%84%E9%9B%B7%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<p>環境配置：Vue + FrameWork 7 ，外面包一層Apk，做成App供手機測試<br>以下將紀錄在實作時遇到的雷坑及如何解決的。</p><h2 id="input-送出按鍵"><a href="#input-送出按鍵" class="headerlink" title="input 送出按鍵"></a>input 送出按鍵</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;!-- 驗證碼: authenticationCode Start --&gt;<br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">f7-list-item</span> <span class="hljs-attr">v-else</span>&gt;</span></span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">f7-input</span></span></span><br><span class="hljs-tag"><span class="xml">    <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;tel&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">    <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;input-border&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">    <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;input verification code&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">    <span class="hljs-attr">:value</span>=<span class="hljs-string">&quot;authenticationCode&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">    <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;Phone&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">    @<span class="hljs-attr">keyup.enter</span>=<span class="hljs-string">&quot;confirmActive&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">    @<span class="hljs-attr">input</span>=<span class="hljs-string">&quot;authenticationCode = $event.target.value&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">    <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;[0-9\.]*&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">    <span class="hljs-attr">error-message</span>=<span class="hljs-string">&quot;Verification code only be a number.&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">    <span class="hljs-attr">clear-button</span></span></span><br><span class="hljs-tag"><span class="xml">    <span class="hljs-attr">validate</span></span></span><br><span class="hljs-tag"><span class="xml">    <span class="hljs-attr">required</span></span></span><br><span class="hljs-tag"><span class="xml">    <span class="hljs-attr">maxlength</span>=<span class="hljs-string">&quot;4&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">    <span class="hljs-attr">minlength</span>=<span class="hljs-string">&quot;4&quot;</span></span></span><br><span class="hljs-tag"><span class="xml">  &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">f7-input</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">f7-list-item</span>&gt;</span></span><br>&lt;!-- 驗證碼 End --&gt;<br>&lt;/f7-list&gt;<br></code></pre></td></tr></table></figure><p>遇到一個問題是：手機開啟App後，按下送出鍵會原地Refresh重整頁面，不會真的送出。<br>於是使用<a href="mailto:`@keyup.enter.native">`@keyup.enter.native</a>=”confirmActive”`方法，發現仍行不通。</p><p>經過萬能的Google搜尋、Debugger後，發現了原則：</p><p><a href="mailto:`@keyup.enter">`@keyup.enter</a>=”confirmActive”<code>=&gt; 手機按下送出後，執行confirmActive方法</code>@keyup.enter.native=”confirmActive”` =&gt; 電腦按下送出後，執行confirmActive方法</p>]]></content>
      
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> FrameWrok 7 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>快來架設超潮的NodeBB論壇在Heroku上</title>
      <link href="//%E5%BF%AB%E4%BE%86%E6%9E%B6%E8%A8%AD%E8%B6%85%E6%BD%AE%E7%9A%84NodeBB%E8%AB%96%E5%A3%87%E5%9C%A8Heroku%E4%B8%8A/"/>
      <url>//%E5%BF%AB%E4%BE%86%E6%9E%B6%E8%A8%AD%E8%B6%85%E6%BD%AE%E7%9A%84NodeBB%E8%AB%96%E5%A3%87%E5%9C%A8Heroku%E4%B8%8A/</url>
      
        <content type="html"><![CDATA[<h1 id="架設-NodeBB-論壇-在-Heroku-上"><a href="#架設-NodeBB-論壇-在-Heroku-上" class="headerlink" title="架設 NodeBB 論壇 在 Heroku 上"></a>架設 NodeBB 論壇 在 Heroku 上</h1><p>This tutorial is introduce how to install NodeBB forum with MongoDB on MacOS and how to create in Heroku application.<br>I look up official document, and step by step do it, but has some error. I’m spending much more time to fixing them.<br>So I write this topic. I hope this tutorial can help somebody.</p><p>架設Nodebb論壇照著<a href="(https://docs.nodebb.org/installing/cloud/heroku/">官方文件</a>的步驟一步步做，但仍出現一些狀況無法順利架設在 Heroku上，因此寫下筆記記錄下來。</p><p>下列教學總共會分成幾個步驟</p><ol><li>將NodeBB原始碼下載到電腦上</li><li>架設環境在本機上</li><li>建立專案在Heroku 上</li><li>設定專案連接到 MLab （Mango）資料庫</li></ol><h2 id="架設環境"><a href="#架設環境" class="headerlink" title="架設環境"></a>架設環境</h2><ul><li>架設環境 為Mac 10.14 OS</li></ul><h2 id="安裝前必備品"><a href="#安裝前必備品" class="headerlink" title="安裝前必備品"></a>安裝前必備品</h2><p>下列將列出如何安裝 NodeBB在本機環境下，且架設在heroku上，請先確保您有以下環境、知識。</p><ol><li>安裝 <a href="https://toolbelt.heroku.com/">Heroku Cli</a>，可以在終端機執行像<code>heroku create</code>、<code>heroku login</code>等指令。</li><li>具備基本的 Github 知識</li><li>Mac 已有安裝 HomeBrew</li><li>Heroku 已擁有帳號</li></ol><h2 id="開始安裝"><a href="#開始安裝" class="headerlink" title="開始安裝"></a>開始安裝</h2><h3 id="NodeBB-下載到本機"><a href="#NodeBB-下載到本機" class="headerlink" title="NodeBB 下載到本機"></a>NodeBB 下載到本機</h3><p>Download NodeBB to your localhost.<br>首先先把專案載入到電腦本機上，開啟終端機並移動到桌面，輸入<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/NodeBB/</span>NodeBB.git<br>cd NodeBB<br></code></pre></td></tr></table></figure><br>便會在你的桌面上建立一個NodeBB資料夾，裡面便是原始碼。</p><h3 id="安裝MongoDB"><a href="#安裝MongoDB" class="headerlink" title="安裝MongoDB"></a>安裝MongoDB</h3><p>若你已有安裝，可跳過這步驟。<br>若你系統尚未有<a href="https://brew.sh/index_zh-tw">HomeBrew</a>套件管理工具，請移駕至Homebrew官網下載並安裝。</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">brew </span><span class="hljs-keyword">install </span>mongodb<br></code></pre></td></tr></table></figure><p>安裝完以後，系統並不會直接開啟，需要輸入以下指令<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">brew services <span class="hljs-literal">start</span> mongodb<br></code></pre></td></tr></table></figure><br>輸入後，mongodb才能在系統上使用哦！</p><h3 id="Heroku-建立專案"><a href="#Heroku-建立專案" class="headerlink" title="Heroku 建立專案"></a>Heroku 建立專案</h3><p>首先先確保你有安裝Heroku Cli，若沒有請先Google查詢先安裝，否則下列指令皆無法執行。</p><p>我們先在終端機上輸入以下指令，登入自己的heroku帳號<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">heroku login</span><br></code></pre></td></tr></table></figure><br>接著會提示你輸入帳號及密碼，輸入完沒有打錯的話，便會成功登入。<br>接著在Heroku上直接建立專案，nodebb-forum可以自行取名，或著直接打heroku create也可以，heroku便會隨機幫你建立一個名稱。<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">heroku create twlesmatches-forum</span><br></code></pre></td></tr></table></figure><br>建立好專案後，我們要去設定MLab MongoDB 與自己的heroku帳號 建立連結，可以先選擇SendBox的免費專案<br><a href="https://elements.heroku.com/addons/mongolab">MLab建立連接</a><br>點擊上列連接，並找到按鈕「Install mLab MongoDB」進入頁面<br><img src="https://i.imgur.com/EaecwAu.png" alt="Picture install mLab Mongo DB">。<br>他會要求你登入帳號，並選擇要連接的專案。<br>像我剛剛在heroku上建立專案叫twlesmatches-forum，便在這個視窗輸入tw，便會跳出來囉，選好專案後便點擊按鈕「Provision add-on」即可加入至專案。<br><img src="https://i.imgur.com/H5BY7Rt.png" alt="Find project"><br>或是比較省事一點，直接在終端機輸入以下指令，並選擇sandbox的免費專案。<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">heroku addon<span class="hljs-variable">s:create</span> mongola<span class="hljs-variable">b:sandbox</span><br></code></pre></td></tr></table></figure></p><h3 id="NodeBB-與-Mongo資料庫-連接"><a href="#NodeBB-與-Mongo資料庫-連接" class="headerlink" title="NodeBB 與 Mongo資料庫 連接"></a>NodeBB 與 Mongo資料庫 連接</h3><p>成功連接後，我們便來設定與資料庫連接<br>在終端機上輸入以下指令，請記得必須要在NodeBB的根目錄才行<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">./nodebb setup<br></code></pre></td></tr></table></figure><br>如果輸入setup指令後，出現ERROR訊息：<br><code>error: NodeBB could not connect to your Mongo database. Mongo returned the following error: Authentication failed.</code><br>這段Error訊息，是說專案沒辦法連接本機上的Mongo，是因為權限不夠高的關係。</p><p>請在終端機上輸入以下指令，進入mongo資料庫的介面<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">mongo</span><br></code></pre></td></tr></table></figure><br>如果無法順利進入mongo的介面，請先檢查是否有安裝成功mongoDB或著是<code>brew service restart mongo</code>，將服務重啟。</p><p>順利進入介面後，請再輸入以下指令<br>便可成功切換到nodebb的資料庫<br><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs fsharp">&gt; <span class="hljs-keyword">use</span> nodebb<br>switched <span class="hljs-keyword">to</span> db nodebb<br></code></pre></td></tr></table></figure></p><h3 id="Mongo-簡單指令"><a href="#Mongo-簡單指令" class="headerlink" title="Mongo 簡單指令"></a>Mongo 簡單指令</h3><p>mongo介面下列有幾個指令可以檢查這個nodebb資料庫的使用者<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">db.getUsers() <span class="hljs-comment"># 查詢所有使用者</span><br>show roles; <span class="hljs-comment"># 秀出所有的權限角色，像readWrite, userAdmin</span><br></code></pre></td></tr></table></figure></p><p>輸入上面的指令像是db.getUsers()會發現，nodeBB資料庫內沒有任何一個使用者，所以我們要建立一個使用者，並且有足夠高的權限可以操作，角色為userAdmin。</p><p>我們在終端機上輸入以下指令，在輸入前，請將<code>username</code>, <code>password</code>替換成你想要設定的名稱及密碼，這組設定將會是你本機上連接資料庫時的帳號及密碼，要記得！<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">db.create<span class="hljs-constructor">User(&#123;<span class="hljs-params">user</span>:&#x27;<span class="hljs-params">username</span>&#x27;, <span class="hljs-params">pwd</span>:&#x27;<span class="hljs-params">password</span>&#x27;, <span class="hljs-params">roles</span>:[&#123;<span class="hljs-params">role</span>:&#x27;<span class="hljs-params">userAdmin</span>&#x27;, <span class="hljs-params">db</span>:&#x27;<span class="hljs-params">db</span>-<span class="hljs-params">name</span>&#x27;&#125;]&#125;)</span><br></code></pre></td></tr></table></figure><br>若想要設定其他權限，可以輸入<code>show roles;</code>，查詢資料庫內其他角色的權限，再輸入一次上述指令，將<code>role: &#39;userAdmin&#39;</code>改成其他你想要的role即可。</p><p>設定好之後，並重新再跑一次setup指令<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">./nodebb setup<br></code></pre></td></tr></table></figure><br><img src="https://i.imgur.com/6q8KRLi.png" alt="runing setup"><br>輸入後他會跑一下子，接著會要求你設定一些選項，這邊非常重要<br>關係到你能不能架設在Heroku上連接資料庫成功，所以輸入時要提高注意力一下XD，不能全部都按Enter！！<br>（我第一次架失敗時就是全部都按Enter XD）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">URL used to access this NodeB(http://localhost:4567) https://twlesmatches-forum.herokuapp.com/<br></code></pre></td></tr></table></figure><br>首先要設定的是URL，請在這裡填上你的heroku application的url，不知道的話請開新的終端機視窗輸入<code>heroku open</code>便會跳出你專案的網址，格式會像是這樣：<code>https://twlesmatches-forum.herokuapp.com/</code></p><p>接著要你設定 NodeBB secret，不用理她，Enter跳過！<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Please enter a NodeBB secret (ca7c68c3-edce-4a7d-80f8-7e5e757ca5ca)<br></code></pre></td></tr></table></figure></p><p>接著會詢問你要使用的Database是什麼？由於NodeBB只允許Mongo或Redis這兩款資料庫可使用，我們前面辛苦安裝Mongo了，就直接Enter吧XD。（Enter代表輸入他預設的指令）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Which database to use (mongo)<br></code></pre></td></tr></table></figure><br>接著會出現重頭戲！這個NodeBB要連接的資料庫網址是什麼？也有出現提示格式如何輸入。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">2018-12-10T14:52:49.320Z [14213] - info:<br>Now configuring mongo database:<br>MongoDB connection URI: (leave blank <span class="hljs-keyword">if</span> you wish to specify host, port, username/password and database individually)<br>Format: mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]<br></code></pre></td></tr></table></figure><br>這很簡單，開啟Heroku網站，並登入帳號後選擇你剛剛建立的application專案，進入專案後到Setting找到Config Vars，就有資料庫網址了！把他複製貼上到終端機上即可囉。（也可直接輸入heroku config，便會出現資料庫的網址）<br><img src="https://i.imgur.com/QospqAE.png" alt="示意圖"><br>輸入完後，便會自動跑完安裝啦<br><img src="https://i.imgur.com/JtTVSQF.png" alt="tutorial for nodebb and heroku"><br>跑完安裝後要注意，會有個提示訊息告知你的Admin系統管理員帳號及密碼是多少，不要忽略了哦</p><p>接著剩下最後兩個步驟了，快大功告成啦！<br>請在終端機輸入以下指令，建立Procfile在Heroku上<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">web <span class="hljs-keyword">node</span> <span class="hljs-title">app</span>.js --no-daemon<br></code></pre></td></tr></table></figure><br>教學文件是打loader.js，但照著打反而出錯，爬文後發現打app.js才能成功架設。<br>輸入完後，請git commit做紀錄後推上去。<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">git <span class="hljs-keyword">add </span>-f Procfile <span class="hljs-built_in">config</span>.<span class="hljs-keyword">json </span>package.<span class="hljs-keyword">json </span><span class="hljs-keyword">build </span>&amp;&amp; git commit -am <span class="hljs-string">&quot;adding Procfile and configs for Heroku&quot;</span><br>git push heroku master<br></code></pre></td></tr></table></figure><br>推上去heroku master要稍等一會兒時間。<br>推完後，請再輸入終端機，將dyno設定為1（free）的等級<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">heroku ps:scale <span class="hljs-attribute">web</span>=1<br></code></pre></td></tr></table></figure></p><p>大功告成，快上去看看架設成功了沒！輸入下列指令會自動開啟專案的網站哦<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">heroku open<br></code></pre></td></tr></table></figure></p><p>如果上述教學有任何錯誤或是需要糾正的地方，請務必留言告訴我，謝謝各位^_^</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://docs.nodebb.org/installing/cloud/heroku/">官方文件：install nodebb in heroku</a></li><li><a href="http://zhangwenli.com/blog/2016/04/19/installing-nodebb-on-mac-os/">Install NodeBB in Heroku</a></li><li><a href="https://andyyou.github.io/2016/10/31/process-types-and-profile/">Heroku 運行類別、 Procfile、常用指令筆記</a></li><li><a href="https://www.kancloud.cn/a632079/nodebb-cn/content">NodeBB 基礎使用與開發</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> node.js </tag>
            
            <tag> forum </tag>
            
            <tag> heroku </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 元件化概念</title>
      <link href="//Vue-%E5%85%83%E4%BB%B6%E5%8C%96%E6%A6%82%E5%BF%B5/"/>
      <url>//Vue-%E5%85%83%E4%BB%B6%E5%8C%96%E6%A6%82%E5%BF%B5/</url>
      
        <content type="html"><![CDATA[<h2 id="Vue-元件化概念-筆記"><a href="#Vue-元件化概念-筆記" class="headerlink" title="Vue 元件化概念 筆記"></a>Vue 元件化概念 筆記</h2><ol><li>使用元件化切出複雜頁面</li><li>使用vue-router 做耊面</li><li>使用 vuex（資料中心）統一狀態更動<br><img src="./Screen Shot 2018-09-24 at 6.07.05 PM.png" alt="Alt text"></li></ol><h3 id="元件化"><a href="#元件化" class="headerlink" title="元件化"></a>元件化</h3><ul><li>App.vue是大元件</li><li>什麼是元件化？</li><li>將網頁依照頁面、功能拆分</li><li>小至一個按鈕、大到整個頁面或程式</li><li>Single File Component<h4 id="Vue-元件化概念"><a href="#Vue-元件化概念" class="headerlink" title="Vue 元件化概念"></a>Vue 元件化概念</h4></li><li>新增 / 使用元件</li><li>傳遞屬性 props</li><li>釋放事件 $emit</li><li>元件重用控制 :key</li></ul><h4 id="新增-使用元件"><a href="#新增-使用元件" class="headerlink" title="新增 / 使用元件"></a>新增 / 使用元件</h4><p>每個元件都有自己的 data / computed / methods<br>data需要是回傳資料的函數（非物件）</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-type">Vue</span>.component(&#x27;post&#x27;, &#123;<br>template:: &#123;<br>...<br>&#125;,<br><span class="hljs-class"><span class="hljs-keyword">data</span>()&#123;</span><br><span class="hljs-class">...</span><br><span class="hljs-class">&#125;</span><br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="傳遞屬性-props"><a href="#傳遞屬性-props" class="headerlink" title="傳遞屬性 props"></a>傳遞屬性 props</h4><p><a href="https://vuejs.org/v2/guide/components-props.html">Vue Props Document</a><br>使用 v-bind:屬性 或 :屬性，傳值給元件<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir">&lt;component v-<span class="hljs-symbol">bind:</span>value=<span class="hljs-string">&#x27;10&#x27;</span> <span class="hljs-symbol">:post=post&gt;&lt;component&gt;</span><br></code></pre></td></tr></table></figure><br>元件收到值後，會當成內部資料使用<br><figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs nim">data: &#123;<br>props: [&#x27;propname&#x27;],<br>data: <span class="hljs-meta">&#123;...&#125;</span><br>&#125;<br>或是<br>data: &#123;<br>props: &#123;<br>title: <span class="hljs-type">String</span><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><br>propD: {<br>    dafault: 100<br>}</p><h4 id="釋放事件-emit"><a href="#釋放事件-emit" class="headerlink" title="釋放事件 $emit"></a>釋放事件 $emit</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;component @save=<span class="hljs-string">&#x27;...&#x27;</span>&gt;&lt;component&gt;<br><br><span class="hljs-built_in">this</span>.$emit(<span class="hljs-string">&#x27;save&#x27;</span>, somedata)<br></code></pre></td></tr></table></figure><p>釋出 save事件，並釋出一些 data<br>在元件的外面儲存，收到卡片@save的事件，事件save後，卡片資料放上去。</p><h4 id="重用控制-key"><a href="#重用控制-key" class="headerlink" title="重用控制 :key"></a>重用控制 :key</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">component</span> @<span class="hljs-attr">key</span>=<span class="hljs-string">&#x27;...&#x27;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">component</span>&gt;</span><br></code></pre></td></tr></table></figure><p>根據 key 有沒有改變，控制資料是否要變更。 </p><p>比如說控制卡片列表是否要重新渲染，是否要重新產生方塊<br><img src="./Screen Shot 2018-09-24 at 6.20.37 PM.png" alt="Alt text"></p><p>雜學校的每個文章：卡片每個都有獨立的key，如果規則不同（標題不同），則重新產生卡片。<br>使用時機：文章建立、頁面建立時</p><h2 id="初始化專案"><a href="#初始化專案" class="headerlink" title="初始化專案"></a>初始化專案</h2><ul><li>pug</li><li>pug-loader</li><li>pug-filters</li><li>sass<h3 id="安裝-Pug、Sass-套件"><a href="#安裝-Pug、Sass-套件" class="headerlink" title="安裝 Pug、Sass 套件"></a>安裝 Pug、Sass 套件</h3><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">npm install pug pug-loader pug-filters --save<br>npm install sass sass-loader <span class="hljs-keyword">node</span><span class="hljs-title">-sass</span> --save<br></code></pre></td></tr></table></figure></li><li>指定開發語言<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&#x27;pug&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&#x27;sass&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li>建立專案環境，專案名稱：vuecomp，採用webpack-simple樣板<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">vue init webpack-simple vuecomp<br>cd vuecomp<br>npm install <span class="hljs-regexp">//</span>安裝相依性的套件<br>npm run dev <span class="hljs-regexp">//</span> hot load方式開啟本機環境：localhost:<span class="hljs-number">8080</span><br></code></pre></td></tr></table></figure>data不是 object，是函數喔</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript ES6 物件 Literal Upgrades：動態命名</title>
      <link href="//ES6-Object-Literal-Upgrades%EF%BC%9A%E5%8B%95%E6%85%8B%E5%91%BD%E5%90%8D/"/>
      <url>//ES6-Object-Literal-Upgrades%EF%BC%9A%E5%8B%95%E6%85%8B%E5%91%BD%E5%90%8D/</url>
      
        <content type="html"><![CDATA[<h3 id="ES6-Object-Literal-Upgrades"><a href="#ES6-Object-Literal-Upgrades" class="headerlink" title="ES6 Object Literal Upgrades"></a>ES6 Object Literal Upgrades</h3><p>ES6 擴展：物件實體命名，透過<code>[]</code>的方式，可以帶入變數，讓程式碼更好維護、管理。</p><h3 id="運用方式：像是對物件裡的屬性命名時，能夠用像是組字串的方式，讓命名名稱更有彈性。"><a href="#運用方式：像是對物件裡的屬性命名時，能夠用像是組字串的方式，讓命名名稱更有彈性。" class="headerlink" title="運用方式：像是對物件裡的屬性命名時，能夠用像是組字串的方式，讓命名名稱更有彈性。"></a>運用方式：像是對物件裡的屬性命名時，能夠用像是組字串的方式，讓命名名稱更有彈性。</h3><h3 id="舉例："><a href="#舉例：" class="headerlink" title="舉例："></a>舉例：</h3><p>像是我建立一個tShirt的物件，裡面有屬性是Color：color色碼</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs processing"><span class="hljs-keyword">const</span> <span class="hljs-built_in">key</span> = <span class="hljs-string">&#x27;pocketColor&#x27;</span>;<br><span class="hljs-keyword">const</span> value = <span class="hljs-string">&#x27;#d6b161&#x27;</span>;<br><br><span class="hljs-keyword">const</span> tShirt = &#123;<br>  [<span class="hljs-built_in">key</span>]: value,<br>&#125;<br>console.<span class="hljs-built_in">log</span>(tShirt);<br></code></pre></td></tr></table></figure><p>console.log後的結果，[key]是什麼？<br>沒錯，就是’pocketColor’: ‘#d6b161’</p><p>假設今天的目的是在一個物件裡放A顏色、A相反的顏色，並配對值<br>和A相反的顏色命名為pocketColorOppsite，並用invertColor函數來取出顏色的相反<br>我們可能會這樣寫：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> tShirt = &#123;<br>  [key]: value,<br>  <span class="hljs-attr">pocketColorOpposite</span>: invertColor(value)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invertColor</span>(<span class="hljs-params">color</span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;#&#x27;</span> + (<span class="hljs-string">&quot;000000&quot;</span> + (<span class="hljs-number">0xFFFFFF</span> ^ <span class="hljs-built_in">parseInt</span>(color.substring(<span class="hljs-number">1</span>),<span class="hljs-number">16</span>)).toString(<span class="hljs-number">16</span>)).slice(-<span class="hljs-number">6</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>套用 ES6 擴展物件屬性，我們可以帶入變數的方式<br>ES6 的寫法可以這樣下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> tShirt = &#123;<br>  [key]: value,<br>  [<span class="hljs-string">`<span class="hljs-subst">$&#123;key&#125;</span>Opposite`</span>]: invertColor(value)<br>&#125;<br></code></pre></td></tr></table></figure><br>透過[]方式，屬性名稱也可以使用<code>$&#123;&#125;</code>的方式放入變數<br>也會較好維護。</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://github.com/wesbos/es6-articles/blob/master/33%20-%20Object%20Literal%20Upgrades.md">ES6 Object Literal Upgrades</a></li><li><a href="http://es6.ruanyifeng.com/?search=object+literal&amp;x=0&amp;y=0#docs/string#%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2">ECMAScript 6 入門</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript30/08 | Fun With HTML Canvas 筆記</title>
      <link href="//JavaScript30-08-Fun-With-HTML-Canvas-%E7%AD%86%E8%A8%98/"/>
      <url>//JavaScript30-08-Fun-With-HTML-Canvas-%E7%AD%86%E8%A8%98/</url>
      
        <content type="html"><![CDATA[<p>JavaScript30/08 | Fun With HTML Canvas 筆記</p><h2 id="Demo-效果"><a href="#Demo-效果" class="headerlink" title="Demo 效果"></a>Demo 效果</h2><p><img src="https://github.com/Hazelwu2/JavaScript30/blob/master/day8-fun-with-html5-canvas/demo.gif?raw=true" alt="demo"></p><h2 id="完成-Day8-需要用到的屬性"><a href="#完成-Day8-需要用到的屬性" class="headerlink" title="完成 Day8 需要用到的屬性"></a>完成 Day8 需要用到的屬性</h2><ul><li>Canvas<br>基本屬性<ul><li>getContext()</li><li>lineCap</li><li>lineJoin</li><li>beginPath()<br>調整色彩、寬度</li><li>lineWidth</li><li>fillStyle</li><li>strokeStyle<br>繪製屬性</li><li>beginPath()</li><li>lineTo(x, y)</li><li>stroke()</li></ul></li><li>Event：用各種事件來控制 isDrawing 開關<ul><li>mousedown</li><li>mouseup</li><li>mouseout</li><li>mousemove<br><br></li></ul></li></ul><h4 id="步驟"><a href="#步驟" class="headerlink" title="步驟"></a>步驟</h4><ol><li>將 Canvas 元素存入變數，設定 Canvas 寬與高</li><li>利用 getContext(‘2d’)，來獲取值 ctx</li><li>設定 ctx 的基本屬性<ul><li>線條顏色（hsl）</li><li>線條寬度（lineWidth)</li><li>線條末端的形狀</li></ul></li><li>繪畫效果<ul><li>設定繪圖中的開關（isDrawing）</li><li>監聽滑鼠事件，根據不同事件，將開關設定為 true 或 false</li></ul></li><li>動態設定彩虹漸變（利用 hsl 的 h 值，以 h++更改顏色）</li><li>動態設定：當繪畫時，線條由細到粗、由粗到細</li></ol><h4 id="Canvas-起手式"><a href="#Canvas-起手式" class="headerlink" title="Canvas 起手式"></a>Canvas 起手式</h4><p>以下為 Canvas 的基本用法<br>將 Canvas 元素存入變數 canvas內，並設定 Canvas 寬與高<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;draw&#x27;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&#x27;800&#x27;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&#x27;800&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br></code></pre></td></tr></table></figure></p><p>設定 Canvas 寬高</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> canvas = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;#draw&#x27;</span>);<br><span class="hljs-keyword">const</span> ctx = canvas.getContext(<span class="hljs-string">&#x27;2d&#x27;</span>);<br>canvas.width = <span class="hljs-built_in">window</span>.innerWidth;<br>canvas.height = <span class="hljs-built_in">window</span>.innerHeight;<br></code></pre></td></tr></table></figure><p>接著，設定用來 ctx 吧</p><ul><li>lineCap：筆觸的形狀，可以設為 round、butt、square</li><li>lineJoin：線條比較方式</li><li>lineWidth：線條寬度</li><li>strokeStyle：線條顏色</li><li>fillStyle：填充顏色<br><br><br>用 ctx 繪製 Canvas</li><li>beginPath()：開始畫新的路徑 </li><li>stroke()：繪製線條</li><li>moveTo(x,y)：以x軸、y軸為座標位置，操作起點</li><li>lineTo(x,y)：同樣以x,y軸為坐標，從moveTo到lineTo會畫出一條線</li></ul><h4 id="設定繪圖開關"><a href="#設定繪圖開關" class="headerlink" title="設定繪圖開關"></a>設定繪圖開關</h4><p>理想結果是像小畫家一樣，當點滑鼠左鍵便開始畫線條，直到放開左鍵，所以我們要做一個叫isDrawing的開關，用來控制 繪圖中 / 結束繪圖的狀態。<br><br></p><ul><li>當點擊左鍵，表示正在畫畫，isDrawing =&gt; true，isDrawing開啟。</li><li>當放開左鍵，表示結束畫畫，isDrawing =&gt; flase，isDrawing關閉。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> isDrawing = <span class="hljs-literal">false</span>;<br>canvas.addEventListener(<span class="hljs-string">&#x27;mousedown&#x27;</span>, isDrawing = ture);<br>canvas.addEventListener(<span class="hljs-string">&#x27;mousemove&#x27;</span>, draw);<br>canvas.addEventListener(<span class="hljs-string">&#x27;mouseup&#x27;</span>, isDrawing = <span class="hljs-literal">false</span>);<br>canvas.addEventListener(<span class="hljs-string">&#x27;mouseout&#x27;</span>, isDrawing = <span class="hljs-literal">false</span>);<br></code></pre></td></tr></table></figure><p>當點擊滑鼠左鍵開始畫圖，便是mousedown，一但點擊左鍵，將isDrawing開關變成 ture。<br>當滑鼠開始移動時，便執行draw function，裡面將會做一些 Canvas的繪製屬性動作，像是beginTo, lineTo, moveTo<br>而滑鼠放掉（mouseup）、滑鼠移出canvas的範圍時（mouseout），便將isDrawing變更為 false，代表使用者已不在繪畫中狀態。<br><br></p><h3 id="線條銜接問題"><a href="#線條銜接問題" class="headerlink" title="線條銜接問題"></a>線條銜接問題</h3><p>若第一次畫完後，想再畫第二次，會發現銜接的線條是從上一次開始。但我們希望理想結果是：不要銜接上一次畫的線條<br><br><br>為了解決這樣的狀況，我們需要更新lastX, lastY，意味著最後滑鼠的x, y軸的座標位置。</p><h4 id="要更新座標位置的有兩處"><a href="#要更新座標位置的有兩處" class="headerlink" title="要更新座標位置的有兩處"></a>要更新座標位置的有兩處</h4><ul><li>當正在繪圖中（isDrawing = ture）時，draw function需更新座標。</li><li>監聽點擊滑鼠左鍵時，要開始繪圖時，需更新最後位置狀態<br>如下列程式碼所展現，e.offsetX, e.offsetY 則為滑鼠在網頁上的座標位置，宣告變數lastX, lastY並指定給他們，即可解決線條銜接問題，每一次點擊滑鼠左鍵都是新的開始囉！</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> draw = <span class="hljs-function">() =&gt;</span> &#123;<br>  ctx.beginPath();<br>  ctx.moveTo(lastX, lastY);<br>  ctx.lineTo(e.offsetX, e.offsetY);<br>  ctx.stroke();<br>  [lastX, lastY] = [e.offsetX, e.offsetY];<br>&#125;<br><br>canvas.addEventListener(<span class="hljs-string">&#x27;mousedown&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<br>  isDrawing = ture;<br>  [lastX, lastY] = [e.offsetX, e.offsetY];<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="動態變動線條顏色、粗細"><a href="#動態變動線條顏色、粗細" class="headerlink" title="動態變動線條顏色、粗細"></a>動態變動線條顏色、粗細</h3><p>線條顏色我們以hsl(0, 100%, 50%)來表示，hsl(0, 100%, 50%)，這三組數字個別代表的是色相 Hue、飽和度 Saturation、亮度 Lightness，我們將會把色相替代為動態變數，以變更顏色。<br><br><br>對 hsl 想要最快速了解，可以前往<a href="http://mothereffinghsl.com/">Mother-Effing</a>，直接展示給你看 hsl的數值及呈現顏色。</p><h4 id="動態設定筆觸顏色"><a href="#動態設定筆觸顏色" class="headerlink" title="動態設定筆觸顏色"></a>動態設定筆觸顏色</h4><p>今天想要做到的理想效果是：隨著滑鼠移動畫線條時，顏色也會跟著改變，很簡單，只要將其中一個數值（0, 100%, 50%）改為變數，並將變數每次畫完時都遞增。<br><br><br>粗細也是囉，Canvas 用 lineWidth來控制線條的粗細程度，將固定數值改為動態變數取代，並將動態變數遞增即可。</p><p>要注意的是 hsl值的色相（hue）值最大為 360，所以也需要另外設條件是 當 hue &gt; 360，hue = 0 歸零開始。<br><br></p><h4 id="動態設定筆觸粗細"><a href="#動態設定筆觸粗細" class="headerlink" title="動態設定筆觸粗細"></a>動態設定筆觸粗細</h4><p>至於控制筆觸大小，設定判斷式：當超過某值時便將變數遞減，當小於某值時便把變數遞增即可達成囉。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> hue = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">let</span> controlLineWidth = <span class="hljs-number">50</span>;<br><br>ctx.strokeStyle = <span class="hljs-string">`hsl(<span class="hljs-subst">$&#123;hue&#125;</span>, 44%, 50%)`</span>;<br>ctx.lineWidth = controlLineWidth;<br>ctx.beginPath(); <span class="hljs-comment">// 開新的路徑</span><br>ctx.moveTo(lastX, lastY);<br>ctx.lineTo(e.offsetX, e.offsetY);<br>ctx.stroke(); <span class="hljs-comment">// 畫線</span><br><br>hue++; <span class="hljs-comment">// 畫線結束後，將動態變數hue遞增</span><br>hue &gt; <span class="hljs-number">360</span> ? hue = <span class="hljs-number">0</span> : <span class="hljs-string">&#x27;&#x27;</span>; <br><br><span class="hljs-comment">// 控制筆觸粗細大小，設定判斷式</span><br><span class="hljs-keyword">let</span> direction = ture;<br><span class="hljs-keyword">if</span> (ctx.lineWidth &gt; <span class="hljs-number">100</span> || ctx.lineWidth &lt; <span class="hljs-number">80</span> ) &#123;<br>  direction = !diection;<br>&#125;<br>direction ? controlLineWidth++ : controlLineWidth--;<br><br></code></pre></td></tr></table></figure><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="http://mothereffinghsl.com/">Mother-Effing 查詢 HSL</a></li><li><a href="https://github.com/soyaine/JavaScript30/tree/master/08%20-%20Fun%20with%20HTML5%20Canvas">08 HTML5 Canvas 实现彩虹画笔绘画板指南</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> js30 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Canvas：前端特效動畫的基礎</title>
      <link href="//Canvas%EF%BC%9A%E5%89%8D%E7%AB%AF%E7%89%B9%E6%95%88%E5%8B%95%E7%95%AB%E7%9A%84%E5%9F%BA%E7%A4%8E/"/>
      <url>//Canvas%EF%BC%9A%E5%89%8D%E7%AB%AF%E7%89%B9%E6%95%88%E5%8B%95%E7%95%AB%E7%9A%84%E5%9F%BA%E7%A4%8E/</url>
      
        <content type="html"><![CDATA[<h2 id="Canvas-基礎特性"><a href="#Canvas-基礎特性" class="headerlink" title="Canvas 基礎特性"></a>Canvas 基礎特性</h2><p><img src="http://bpic.588ku.com/element_pic/12/03/20/1656e3909271e51.jpg" alt="像素圖示範"></p><ol><li>可以自由繪製的元件區域</li><li>可以控制每個像素的顏色與繪製</li><li>有很高的操控度，就像遙控器</li><li>可以把他當成一張動態隨時可更動的圖片</li></ol><h2 id="掌握-Canvas"><a href="#掌握-Canvas" class="headerlink" title="掌握 Canvas"></a>掌握 Canvas</h2><ol><li>繪製圖型</li><li>向量概念</li><li>三角函數數學</li><li>物件導向開發（拆成函件或物件變成小零件，來操作。方便除錯與維護）</li></ol><h2 id="點線面構成圖形"><a href="#點線面構成圖形" class="headerlink" title="點線面構成圖形"></a>點線面構成圖形</h2><ol><li>用點和線連成面</li><li>根據路徑填色或畫線</li></ol><h2 id="Canvas-的座標系方向"><a href="#Canvas-的座標系方向" class="headerlink" title="Canvas 的座標系方向"></a>Canvas 的座標系方向</h2><ol><li>原點預設在左上角(0,0)<br>也因為原點在左上角，因此 Y軸 增加是往下跑的<br>2 . 角度方向是逆時鐘的</li></ol><h2 id="如何開始畫-Canvas"><a href="#如何開始畫-Canvas" class="headerlink" title="如何開始畫 Canvas"></a>如何開始畫 Canvas</h2><ol><li>初始化 Init Canvas Element<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> canvas = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&#x27;canvas&#x27;</span>)<br><span class="hljs-keyword">var</span> cvs = canvas.getContext(<span class="hljs-string">&#x27;2d&#x27;</span>)<br></code></pre></td></tr></table></figure></li><li>Setting Canvas 畫布尺寸<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">canvas.width = <span class="hljs-built_in">window</span>.innerWidth<br>canvas.height = <span class="hljs-built_in">window</span>.innerHeight<br></code></pre></td></tr></table></figure></li><li>開始畫圖，構成三角形<ul><li>我要開始新的路徑<br><code>cvs.beginPath()</code></li><li>點移到多少<br><code>cvs.moveTo(50, 50)</code></li><li>線填滿<br><code>cvs.lineTo(100, 100)</code><br><code>cvs.lineTo(250, 20)</code> </li><li>關閉路徑<br><code>cvs.closePath()</code></li><li>填滿顏色<br><code>cvs.fillStyle=&#39;black&#39;</code><br><code>cvs.fill()</code></li></ul></li></ol><h3 id="Canvas-矩形繪圖函數"><a href="#Canvas-矩形繪圖函數" class="headerlink" title="Canvas 矩形繪圖函數"></a>Canvas 矩形繪圖函數</h3><ul><li>填滿矩形<br><code>fillRect(x,y,w,h)</code></li><li>繪製線框矩形（正方形但沒有填滿、只有邊框）<br><code>strokeRect(x,y,w,h)</code></li><li>清除矩形範圍<br>清除指定矩形區域內的內容，使其變為全透明。<br><code>clearRect(x,y,w,h)</code></li></ul><blockquote><p>(x,y,w,h)各代表什麼意思？<br>x,y 表示從原點（左上角）為出發的座標位置<br>width, height表示矩形的寬與高</p></blockquote><h3 id="路徑繪圖"><a href="#路徑繪圖" class="headerlink" title="路徑繪圖"></a>路徑繪圖</h3><p>路徑開始與封閉：beginPath / closePath<br>移動與畫線：moveTo / lineTo / arc<br>指定填色或線條顏色： fillStyle / lineStyle<br>把路徑填色或描出來 stroke / fill</p><h3 id="轉移"><a href="#轉移" class="headerlink" title="轉移"></a>轉移</h3><ul><li>Translate(x,y)</li><li>Rotate(deg)<br>以當下為中心做旋轉</li><li>scale(x,y)</li></ul><h3 id="狀態的保存與還原"><a href="#狀態的保存與還原" class="headerlink" title="狀態的保存與還原"></a>狀態的保存與還原</h3><p>將所有繪製的畫布放在 ctx.save()和ctx.restore()，能預防被污染。</p><ul><li>ctx.save()<br>儲存當下的座標</li><li>ctx.restore()<br>還原上一個儲存的狀態</li></ul><p>還原的原則：先進後出(stack)，像是小畫家回上一步的狀態</p><p>範例：<br>利用儲存狀態，將函數產生的座標變化限制在函數內<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">drawSomething</span>(<span class="hljs-params">x, y, angle</span>) </span>&#123;<br>  ctx.save()<br>  ctx.translate(x, y)<br>  ctx.rotate(deg)<br>  ctx.restore()<br>&#125;<br></code></pre></td></tr></table></figure></p><h3 id="矩陣"><a href="#矩陣" class="headerlink" title="矩陣"></a>矩陣</h3><p>利用 setTransform 來設定矩陣<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">ctx</span><span class="hljs-operator">.</span><span class="hljs-variable">setTransform</span><span class="hljs-punctuation">(</span><span class="hljs-variable">A</span><span class="hljs-operator">,</span> <span class="hljs-variable">B</span><span class="hljs-operator">,</span> <span class="hljs-built_in">C</span><span class="hljs-operator">,</span> <span class="hljs-built_in">D</span><span class="hljs-operator">,</span> <span class="hljs-built_in">E</span><span class="hljs-operator">,</span> <span class="hljs-variable">F</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><br>重設狀態：<br>ctx.setTransform(1, 0, 0, 1, 0, 0)</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://developer.mozilla.org/zh-TW/docs/Web/API/Canvas_API/Tutorial/Drawing_shapes">Web APIs Canvas 介紹 | MDN</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> canvas </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>為什麼前端要學Vue.js？</title>
      <link href="//%E7%82%BA%E4%BB%80%E9%BA%BC%E5%89%8D%E7%AB%AF%E8%A6%81%E5%AD%B8Vue-js%EF%BC%9F/"/>
      <url>//%E7%82%BA%E4%BB%80%E9%BA%BC%E5%89%8D%E7%AB%AF%E8%A6%81%E5%AD%B8Vue-js%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="Vue-js-解決了什麼問題？"><a href="#Vue-js-解決了什麼問題？" class="headerlink" title="Vue.js 解決了什麼問題？"></a>Vue.js 解決了什麼問題？</h2><p>當考慮要不要學習新技術時，要先問自己幾個問題</p><ol><li>這個技術解決了什麼樣的問題？<br>羊毛出在羊身上，這個技術之所以被研發出來，必有其因。</li><li>這個技術有沒有同類型的替代品？比較各自的優缺點</li><li>我花時間成本去學習這個技術，對我有什麼好處？同樣的時間花去學別的技術，是不是更好？</li><li>有什麼實際的問題我可以實用這項技術直接解決？</li></ol><h3 id="定義目標"><a href="#定義目標" class="headerlink" title="定義目標"></a>定義目標</h3><p>以上這些問題是定義目標，除了增強學習動力之外，也是防止浪費時間學一門沒什麼用的技術。<br>人的時間與精力有限，於是「選擇」變得很重要。<br>要將有限的時間、精力投其所好。</p><h3 id="為什麼要使用-Vue-js？"><a href="#為什麼要使用-Vue-js？" class="headerlink" title="為什麼要使用 Vue.js？"></a>為什麼要使用 Vue.js？</h3><ol><li>讓資料與 HTML 能夠完整分離</li><li>將網頁資料存進「狀態」裡，容易管理。不需監聽才能得知網頁當下值。<br>根據資料自動複製 HTML、設定HTML屬性</li><li>將資料與網頁雙向同步<br>同步更新資料與網頁的資料</li><li>加快開發、程式可讀性增加</li></ol><h3 id="Vue-js-初始化"><a href="#Vue-js-初始化" class="headerlink" title="Vue.js 初始化"></a>Vue.js 初始化</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">new</span> Veu(&#123;<br>  <span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;#app&#x27;</span>,<br>  <span class="hljs-attr">data</span>: &#123;<br>    <br>  &#125; <span class="hljs-comment">//資料保存狀態</span><br>&#125;)<br></code></pre></td></tr></table></figure><p>資料替換 &#123; &#125;文字 與 HTML<br>v-html<br>指定資料時可進行額外計算，使用Js表達式<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">data: &#123;<br>  <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;Hello&#x27;</span>,<br>  <span class="hljs-attr">htmlText</span>: <span class="hljs-string">&#x27;&lt;p&gt;Hello HTML&lt;/p&gt;&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure></p><p>v-bind:href 可簡寫成 :ahref<br><a v-bind:href="link"></a><br><a :href="link"></a></p><p>v-if：條件不符合時不產生 HTML<br>v-show：條件不符合時以 CSS 隱藏。（display: none）<br>v-else：其餘狀況，當物件存在時才顯示。</p><h3 id="v-model-雙向綁定資料"><a href="#v-model-雙向綁定資料" class="headerlink" title="v-model 雙向綁定資料"></a>v-model 雙向綁定資料</h3><p>當使用者輸入變動時，會同步反應資料。</p><p>指定 v-model 資料型別<br>確保同步時，使用者變動反應的資料是數字或是布林值</p><p>可應用：打勾時變更為true，撲克牌便會翻開</p><p>例如：type為number或checkbox，來更動資料是否為布林值</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">input(<span class="hljs-attribute">type</span>=<span class="hljs-string">&#x27;number, v-model=&#x27;</span>綁定資料&#x27;)<br>input(<span class="hljs-attribute">type</span>=<span class="hljs-string">&#x27;checkbox&#x27;</span>, <span class="hljs-attribute">v-model</span>=<span class="hljs-string">&#x27;綁定資料&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="計算屬性-coumputed"><a href="#計算屬性-coumputed" class="headerlink" title="計算屬性 coumputed"></a>計算屬性 coumputed</h3><ul><li>computed 會建立「虛擬屬性」</li><li>不實際建立在資料data內，但會建立虛擬的data</li><li>雙向計算屬性：利用到 getter、setter<br>取得值或是設定值可以觸發額外動作<ul><li>getter 取得ssetter的實際值</li><li>setter 設定值</li></ul></li><li>常應用在 總價、過濾後的清單或是動態 CSS</li></ul><p>例如：購物車的組合價格（商品價格+運費）、組合名字<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pug">h3 &#123;&#123; price &#125;&#125;<br></code></pre></td></tr></table></figure><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> vm = <span class="hljs-keyword">new</span> Vue(&#123;<br>  <span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;h3&#x27;</span>,<br>  <span class="hljs-attr">data</span>: &#123;<br>    <span class="hljs-attr">fullPrice</span>: <span class="hljs-number">3000</span>,<br>    <span class="hljs-attr">discount</span>: <span class="hljs-number">0.85</span>,<br>    <span class="hljs-attr">shoppingFee</span>: <span class="hljs-number">60</span><br>  &#125;,<br>  <span class="hljs-attr">computed</span>: &#123;<br>    <span class="hljs-function"><span class="hljs-title">price</span>(<span class="hljs-params"></span>)</span>&#123;<br>      <span class="hljs-keyword">let</span> result = <span class="hljs-built_in">this</span>.fullPrice * <span class="hljs-built_in">this</span>.discount<br>      <span class="hljs-keyword">return</span> result + <span class="hljs-built_in">this</span>.shoppingFee <span class="hljs-comment">// 2610$</span><br>    &#125;<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>利用computed建立出price的虛擬屬性，來組合價格</p><h4 id="getter-與-setter"><a href="#getter-與-setter" class="headerlink" title="getter 與 setter"></a>getter 與 setter</h4><p>雙向綁定，指定getter與setter</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pug">input(v-model=&#x27;fullName&#x27;)<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js">data: &#123;<br>  <span class="hljs-attr">firstName</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>  <span class="hljs-attr">lastName</span>: <span class="hljs-string">&#x27;&#x27;</span><br>&#125;,<br><span class="hljs-attr">computed</span>: &#123;<br>  <span class="hljs-attr">fullname</span>: &#123;<br>    <span class="hljs-function"><span class="hljs-title">get</span>(<span class="hljs-params"></span>)</span>&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.firstName + <span class="hljs-string">&#x27;,&#x27;</span> + <span class="hljs-built_in">this</span>.lastName<br>    &#125;,<br>    <span class="hljs-function"><span class="hljs-title">set</span>(<span class="hljs-params">value</span>)</span>&#123;<br>      <span class="hljs-built_in">this</span>.firstName = value.split(<span class="hljs-string">&#x27;,&#x27;</span>)[<span class="hljs-number">0</span>]<br>      <span class="hljs-built_in">this</span>.lastName = value.split(<span class="hljs-string">&#x27;,&#x27;</span>)[<span class="hljs-number">1</span>]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>get()會取得使用者輸入的firstName與lastName<br>set()則會開始處理 get得到的值</p><h3 id="監看變化-watch"><a href="#監看變化-watch" class="headerlink" title="監看變化 watch"></a>監看變化 watch</h3><ul><li>變數發生變化時偵測觸發</li><li>傳入引數：監測出改變前、改變後的值</li><li>常應用在 表單使用者輸入、改變資料或是登入</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES6語法：let、const</title>
      <link href="//ES6%E8%AA%9E%E6%B3%95%EF%BC%9Alet%E3%80%81const/"/>
      <url>//ES6%E8%AA%9E%E6%B3%95%EF%BC%9Alet%E3%80%81const/</url>
      
        <content type="html"><![CDATA[<h2 id="let-與-const-誕生的目的"><a href="#let-與-const-誕生的目的" class="headerlink" title="let 與 const 誕生的目的"></a>let 與 const 誕生的目的</h2><p>不會汙染全域變數，好方便後續維護、Debug</p><ol><li>let, const 用來宣告區塊 {} 裡的變數</li><li>for迴圈宣告 <code>var</code>改為 <code>let</code></li><li>const 唯讀變數，無法去做修改。</li></ol><p>let存在於大括號裡面，在大括號外面便會死翹翹。</p><h2 id="被全域變數污染的例子"><a href="#被全域變數污染的例子" class="headerlink" title="被全域變數污染的例子"></a>被全域變數污染的例子</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pug">ul.list<br>  li 1<br>  li 2<br>  li 3<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> list = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">&#x27;.list li&#x27;</span>).length;<br><span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; list; i++ ) &#123;<br>  <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">&#x27;.list li&#x27;</span>)[i].addEventListener(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    alert(i + <span class="hljs-number">1</span>)<br>  &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><p>for迴圈宣告 <code>var i = 0</code>，導致全域變數被污染，不管點擊哪個 li ， alert 出來的訊息皆為 4。在 Console輸入 i 便會出現3<br>但當for迴圈宣告是<code>let i = 0</code>，將var改為let後，預期點擊 第一個li時 便會出現alert 1、預期點擊第二個 li 時 便會出現alert 2。</p><h2 id="如何知道有沒有污染全域變數？"><a href="#如何知道有沒有污染全域變數？" class="headerlink" title="如何知道有沒有污染全域變數？"></a>如何知道有沒有污染全域變數？</h2><p>在Browser Console 輸入 window.變數名稱，一試便知有沒有被污染。<br>輸入window.變數名稱，如果有出現回應，代表此變數在全域中是存活的，也就是被污染了。</p><h2 id="const-例外情況"><a href="#const-例外情況" class="headerlink" title="const 例外情況"></a>const 例外情況</h2><p>當 const 為 物件或陣列時，便可以修改。<br>當 const被宣告為物件、常數時，記得要加上<code>freeze</code>方法來凍結。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> obj = &#123;<br>  <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;http://wualnz.com&#x27;</span><br>&#125;<br>obj.url = <span class="hljs-string">&#x27;http://helloWorld.com&#x27;</span><br></code></pre></td></tr></table></figure><p>obj.url重新定義為<code>http://helloWorld.com</code>時，成功被修改了。</p><p>當使用陣列、或物件時，有沒有什麼辦法不被修改？<br>有，使用 freeze（凍結）<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> obj = &#123;<br>  <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;http://wualnz.com&#x27;</span><br>&#125;<br><span class="hljs-built_in">Object</span>.freeze(obj)<br>obj.url = <span class="hljs-string">&#x27;http://helloWorld.com&#x27;</span><br></code></pre></td></tr></table></figure><br>當加上<code>Object.freeze(obj)</code>後，便無法再更改obj.url了，於是後面定義的helloWorld便會報錯。</p><h2 id="使用-let、const-時機"><a href="#使用-let、const-時機" class="headerlink" title="使用 let、const 時機"></a>使用 let、const 時機</h2><p>當宣告變數時，你必須先評估這個變數未來會不會常被更改？<br>不希望這個變數被其他開發者修改、亂搞時，宣告 <code>const</code>。<br>未來還是會修改，使用 <code>let</code> 來宣告。</p><h3 id="let-與-const-特性"><a href="#let-與-const-特性" class="headerlink" title="let 與 const 特性"></a>let 與 const 特性</h3><ol><li><code>let</code>, <code>const</code> 不會向上提升（Hoisting）<br>let 與 const 直到讀取那一行宣告，才會被讀取到。<br>宣告 var 時， Javascript 會將它提升（Hoisting），但當使用 let, const是不會被提升的。<br>let、const 不會提升(Hoisting)，但 var 會被提升。</li></ol><p>以下是用 var變數後會被向上提升的範例<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">console</span>.log(a); <span class="hljs-comment">// undefined </span><br><span class="hljs-keyword">var</span> a = <span class="hljs-number">3</span><br><span class="hljs-built_in">console</span>.log(a); <span class="hljs-comment">// 3</span><br></code></pre></td></tr></table></figure></p><p>用let或const宣告，會直接報出錯：a is not defined</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">console</span>.log(a); <span class="hljs-comment">// Uncaught ReferenceError: a is not defined</span><br><span class="hljs-keyword">let</span> a = <span class="hljs-number">3</span>;<br><span class="hljs-built_in">console</span>.log(a);<br></code></pre></td></tr></table></figure><ol start="2"><li>在同個區塊上（大括號內）不能重複命名</li><li>let, const 不會變成全域變數<br>當在全域宣告 let, const的變數時，當你使用 window查找，會發現用 let, const宣告過的變數回報：undefined。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;<br><span class="hljs-built_in">window</span>.a <span class="hljs-comment">// 1</span><br><br><span class="hljs-keyword">const</span> a = <span class="hljs-number">1</span>;<br><span class="hljs-built_in">window</span>.c <span class="hljs-comment">// undefined</span><br><br><span class="hljs-keyword">let</span> b = <span class="hljs-number">1</span>;<br><span class="hljs-built_in">window</span>.b <span class="hljs-comment">// undefined</span><br></code></pre></td></tr></table></figure><p>即使你在全域環境下宣告let或const，使用window查找皆會出現undefined。</p>]]></content>
      
      
      
        <tags>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BlueHost Wordpress 如何安裝 Git 版本控制</title>
      <link href="//BlueHost-Wordpress-%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%9D-Git-%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/"/>
      <url>//BlueHost-Wordpress-%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%9D-Git-%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="BlueHost-Wordpress-如何使用-Git-版本控制"><a href="#BlueHost-Wordpress-如何使用-Git-版本控制" class="headerlink" title="BlueHost Wordpress 如何使用 Git 版本控制"></a>BlueHost Wordpress 如何使用 Git 版本控制</h1><p>BlueHost 沒有提供Git或相關Git設定的支援，所以我們只好自立自強，以下安裝教學是在 BlueHost shared 環境下設置。 過程中有參考 BlueHost的官方文件，但是安裝失敗，文件並未寫得很完整，在這篇文章將記錄我是如何安裝 Git 的，以下操作環境為 Mac iOS 10.13.1。</p><h2 id="為什麼-Wordpress-要進入版本控制？"><a href="#為什麼-Wordpress-要進入版本控制？" class="headerlink" title="為什麼 Wordpress 要進入版本控制？"></a>為什麼 Wordpress 要進入版本控制？</h2><p>經營一個專業的 WordPress 網站，有一定的讀者數量，相信有很多痛苦你都知道<br>以下悲劇範例，我親身經歷過：</p><ol><li>WordPress 版本升級，A 外掛可能升級後導致和 舊版本的 B 外掛發生衝突，導致網站掛掉。</li><li>在 WordPress 後台面板直接修改主題編輯器，常不小心打錯字，導致網站掛掉。</li><li>上次改了一些東西，但忘記改在哪裡。這次升級不小心弄掛了，也忘記怎麼改回去了Orz。</li><li>在本機上架設一個一模一樣的 WordPress 網站，供測試用。但，在自己電腦修改好了，又要重新到真正網站上重新做一樣的動作，好浪費時間。</li></ol><p>通常在WordPress上因為某些套件無法達到你預期想要的效果，於是你興起了客製化的衝動。<br>客製化會需要更動 php程式碼（包含佈景主題）或 CSS, HTML，一不小心改掛了正式網站也就掛了。</p><p>那你可以好好考慮一下學習 Git 來控管你的WordPress，不過前提是你常會更改到程式碼、CSS、HTML。</p><h4 id="說了那麼久，到底什麼是-Git-啊？"><a href="#說了那麼久，到底什麼是-Git-啊？" class="headerlink" title="說了那麼久，到底什麼是 Git 啊？"></a>說了那麼久，到底什麼是 Git 啊？</h4><p><code>Git</code>，它就是一個遊戲存檔紀錄！<br>像是玩單機遊戲一樣，你可能玩了幾個小時後便會先存檔，怕下次再玩的時候忘記自己破到哪關了XD。<br>重新打開遊戲、讀取紀錄檔，又可以回到當初狀態啦！<br>你每一次更改的東西，Git都會幫你做追蹤。<br>比如說你今天建立了香蕉、蘋果，你可以分成存成一次的紀錄或兩次。</p><ul><li>分成一次存檔紀錄訊息：存檔香蕉、蘋果，紀錄訊息：我建立了香蕉、蘋果</li><li>分成兩次的存檔紀錄：存檔香蕉，紀錄訊息：我建立了香蕉、存檔蘋果，存檔紀錄訊息：我建立了蘋果<br>然後呢，在你不小心網站爆炸或又被改爆的時候，跟 Git說：嘿！我要回去我那天建立存檔香蕉的紀錄，就會完全復原啦！網站復活YA</li></ul><blockquote><p>總結：Git主要功用是幫助你做存檔訊息，網站不小心改爆時還能夠回到當初的存檔紀錄，後面一率掰掰XD<br>雖然 Git 學習曲線還是有相當程度的高，但若只是使用 存檔、讀取存檔紀錄、查當初改了什麼，那這學習曲線其實很低的，比起大把浪費的時間，嗯…我認為很值得投資。</p></blockquote><h2 id="開始之前，您必須具備的條件"><a href="#開始之前，您必須具備的條件" class="headerlink" title="開始之前，您必須具備的條件"></a>開始之前，您必須具備的條件</h2><h4 id="能夠-SSH-進入-BlueHost-Server-端"><a href="#能夠-SSH-進入-BlueHost-Server-端" class="headerlink" title="能夠 SSH 進入 BlueHost Server 端"></a>能夠 SSH 進入 BlueHost Server 端</h4><p>SSH KEY 要先進入 BlueHost 後台，先設定好本機電腦的 ssh 公鑰放在上面，id名稱盡量取名為 <code>id_rsa</code><br>成功設定好後，在終端機上輸入<code>ssh UserName@ServerIP</code>即可成功</p><blockquote><p>註：UserName、ServerIP 皆在 BlueHost 後台面板上可尋找得到。</p></blockquote><p>你必須先設定好 ssh鑰匙，才能開始下面的奇妙旅程。</p><h4 id="需要具備一些-Git-知識"><a href="#需要具備一些-Git-知識" class="headerlink" title="需要具備一些 Git 知識"></a>需要具備一些 Git 知識</h4><p>這裡就不多說了，網路上有相當多的教學可以查詢。<br>根據我們的目的是存檔、讀取存檔紀錄、查當初改了什麼，大部分只會用到下列幾個指令。</p><p>git init用意是，和 Git 說：這個資料夾內所有會動的東西，都交給你負責追蹤了！<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">git <span class="hljs-keyword">init</span><br></code></pre></td></tr></table></figure></p><p>Git啊，你幫我存檔 index.php，訊息寫說：「我建立了index.php，邁向里程碑YA!」<br>（紀錄訊息僅供參考，通常是寫你為什麼做這樣變動，方便回憶，千萬別真的這樣打啊…）<br><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">git <span class="hljs-keyword">add</span> <span class="hljs-keyword">index</span>.php<br>git <span class="hljs-keyword">commit</span> -m <span class="hljs-string">&#x27;我建立了index.php，邁向里程碑YA!&#x27;</span><br></code></pre></td></tr></table></figure></p><p>Git 啊，我這個資料夾所有變動的資料，你全部都幫我存檔吧！<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">git <span class="hljs-builtin-name">add</span> .<br>git comit -m <span class="hljs-string">&#x27;存檔所有檔案！&#x27;</span><br></code></pre></td></tr></table></figure></p><p>Git 啊，請你幫我回到上一次存檔紀錄吧，我網站改爆了啦&gt;”&lt;<br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">git <span class="hljs-built_in">reset</span> HEAD^<br></code></pre></td></tr></table></figure></p><blockquote><p>除此之外，還有個圖形化軟體叫：<code>GitKraken</code><br>它可查看每一次你存檔更動了哪些檔案，對於金魚記憶只有7秒的人類是一大福音，當然對網站管理者來說：再也不用浪費腦容量紀錄這些啦XD<br>下圖是我其中一個請 Git幫我追蹤的專案，每一次的存檔紀錄 Git 都很認真在紀錄<br><img src="https://i.imgur.com/kJOqmjk.png" alt="GitKraken Example"></p></blockquote><p>接下來會教學如何在BlueHost上安裝Git。</p><h2 id="連線-Server端-，-安裝-Git"><a href="#連線-Server端-，-安裝-Git" class="headerlink" title="連線 Server端 ， 安裝 Git"></a>連線 Server端 ， 安裝 Git</h2><p>連線進入 Server 後，我們必須先切換家目錄，才能輸入更改 <code>.bashrc</code>的設定<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-variable">$</span> ssh UserName@ServerIP<br><span class="hljs-variable">$</span> <span class="hljs-built_in">cd</span><br><span class="hljs-variable">$</span> <span class="hljs-built_in">pwd</span><br></code></pre></td></tr></table></figure><br>用 VIM編輯器開啟 .bashrc<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-variable">$ </span>vim ~<span class="hljs-regexp">/.bashrc</span><br></code></pre></td></tr></table></figure><br>接著需要更改.bashrc設定檔，將以下程式碼加入在最後一行。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">$ export PATH=<span class="hljs-variable">$HOME</span><span class="hljs-regexp">/.local/</span>bin:<span class="hljs-variable">$HOME</span><span class="hljs-regexp">/.local/u</span>sr/bin:<span class="hljs-variable">$PATH</span><br></code></pre></td></tr></table></figure><p>此行用意是指定Git要安裝在$HOME底下的<code>.local/usr/bin</code><br>既然我們指定了目錄，當然就要創建這些條件囉！<br>建立資料夾.local，並移動進去。如果你已經有 <code>.local</code>資料夾的話，直接進入路徑即可</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> mkdir .<span class="hljs-built_in">local</span></span><br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">cd</span> .<span class="hljs-built_in">local</span></span><br></code></pre></td></tr></table></figure><p>接著再創立一個目錄叫 <code>src</code>，並把移動目錄移動到<code>src</code>內</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-variable">$</span> mkdir src<br><span class="hljs-variable">$</span> <span class="hljs-built_in">cd</span> src<br></code></pre></td></tr></table></figure><p>如果你在 Commend Line 上輸入 <code>pwd</code>的話，目錄應該會長得像是 /home#/username/.local/src，這代表你目前操作都是正確的！</p><blockquote><p>home為你網站根目錄，username為你ssh連線進入時的使用者名稱，username皆在 Bluehost Panel內可以查詢得到。</p></blockquote><p>接下來，萬事俱備啦！到目前為止，我們先是指定了bashrc（Server端預設是使用bashrc）安裝套件等都安裝在<code>.local/usr/bin</code>下，並也真的建立了這些資料夾。</p><p>重頭戲就是：安裝 Git 囉（廢話）<br>我們用<code>wget</code>來安裝<code>git</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">$ wget --no-check-certificate https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/git/gi</span>t<span class="hljs-regexp">/archive/m</span>aster.zip<br></code></pre></td></tr></table></figure><p>這行指令是在說，向這個網址下載<code>master.zip</code>檔案，下載zip檔案後，看到zip當然是要先解壓縮啊！<br>解壓縮完，並將剛利用完已經失去價值的<code>master.zip</code>移除，過河拆巧的概念，節省空間！斷捨離！</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">$ unzip <span class="hljs-keyword">master</span><br><span class="hljs-title">$</span> rm <span class="hljs-literal">master</span>.zip<br></code></pre></td></tr></table></figure><p>解壓縮後會出現資料夾，我們先移動到資料夾內，然後開始安裝。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-variable">$</span> <span class="hljs-built_in">cd</span> git<span class="hljs-literal">-master</span><br><span class="hljs-variable">$</span> make<br><span class="hljs-variable">$</span> make install<br></code></pre></td></tr></table></figure><p>檔案有點龐大，要稍等一下。<br>最後，測試是否有安裝成功，在終端機上輸入 git<br>如果你有成功安裝，就應該會跑出這樣的畫面才對喲。</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs inform7">usage: git <span class="hljs-comment">[--version]</span> <span class="hljs-comment">[--exec-path<span class="hljs-comment">[=&lt;path&gt;]</span>]</span> <span class="hljs-comment">[--html-path]</span> <span class="hljs-comment">[--man-path]</span> <span class="hljs-comment">[--info-path]</span><br><br>          <span class="hljs-comment">[-p|--paginate|--no-pager]</span> <span class="hljs-comment">[--no-replace-objects]</span> <span class="hljs-comment">[--bare]</span><br><br>          <span class="hljs-comment">[--git-dir=&lt;path&gt;]</span> <span class="hljs-comment">[--work-tree=&lt;path&gt;]</span> <span class="hljs-comment">[--namespace=&lt;name&gt;]</span><br><br>          <span class="hljs-comment">[-c name=value]</span> <span class="hljs-comment">[--help]</span><br><br>          &lt;command&gt; <span class="hljs-comment">[&lt;args&gt;]</span><br></code></pre></td></tr></table></figure><p>最後補充一點，雖然 Server已自動安裝 bash-complete 套件了，但 Git 已經習慣打簡略的指令了，可以看看這篇<a href="https://wualnz.com/Git-%E4%BF%AE%E6%94%B9%E5%8F%88%E8%87%AD%E5%8F%88%E9%95%B7%E7%9A%84%E6%8C%87%E4%BB%A4%EF%BC%8C%E5%8A%A0%E5%BF%AB%E9%96%8B%E7%99%BC%E9%80%9F%E5%BA%A6/">Git 修改又臭又長的指令，加快開發速度</a><br>連線至 Server 後輸入以下指令吧！</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs verilog">git <span class="hljs-keyword">config</span> --<span class="hljs-keyword">global</span> <span class="hljs-keyword">alias</span><span class="hljs-variable">.co</span> checkout<br>git <span class="hljs-keyword">config</span> --<span class="hljs-keyword">global</span> <span class="hljs-keyword">alias</span><span class="hljs-variable">.ci</span> commit<br>git <span class="hljs-keyword">config</span> --<span class="hljs-keyword">global</span> <span class="hljs-keyword">alias</span><span class="hljs-variable">.st</span> status<br>git <span class="hljs-keyword">config</span> --<span class="hljs-keyword">global</span> <span class="hljs-keyword">alias</span><span class="hljs-variable">.br</span> branch<br></code></pre></td></tr></table></figure><p>他便會自動在 <code>~/.gitconfig</code> 紀錄，未來輸入<code>git commit -m</code> 就可以直接化簡為 <code>git ci -m</code> 啦！<br>先別聽安麗說了，時間就是金錢，一定要節省時間，不節省時間要幹嘛啊？工程師就是要懶啊XD</p><h3 id="版本控制"><a href="#版本控制" class="headerlink" title="版本控制"></a>版本控制</h3><p>建議版本控制為進入 /public_html內做版本控制，若直接在Home上進版本控制，會收納很多不必要的東西XD。</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">cd</span><br><span class="hljs-keyword">cd</span> /public_html<br>git init<br>git <span class="hljs-keyword">st</span><br>git <span class="hljs-keyword">ci</span> -<span class="hljs-keyword">m</span> &#x27;Initialize Commit&#x27;<br></code></pre></td></tr></table></figure><h3 id="紀錄失敗歷程：官方文件好失敗"><a href="#紀錄失敗歷程：官方文件好失敗" class="headerlink" title="紀錄失敗歷程：官方文件好失敗"></a>紀錄失敗歷程：官方文件好失敗</h3><p><a href="https://my.bluehost.com/cgi/help/2383">VPS or Dedicated Hosting - Installing Git</a><br>照著官方文件做，失敗，無法順利裝上Git，真是的….</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">sudo yum <span class="hljs-keyword">install </span>git<br>yum <span class="hljs-keyword">install </span>git --<span class="hljs-keyword">disableexcludes=main </span>--skip-<span class="hljs-keyword">broken</span><br></code></pre></td></tr></table></figure><p>這兩行指令都失敗QQ，也找不到<a href="https://my.bluehost.com/cgi/help/2358">官方文件-Enabling Sudo Access</a>上所指的 Access Management。</p><h2 id="Reference-參考資料"><a href="#Reference-參考資料" class="headerlink" title="Reference | 參考資料"></a>Reference | 參考資料</h2><ul><li><a href="http://willjackson.org/blog/installing-git-bluehost-shared-hosting">Installing GIT on Bluehost Shared Hosting</a></li><li><a href="https://wualnz.com/Git-%E4%BF%AE%E6%94%B9%E5%8F%88%E8%87%AD%E5%8F%88%E9%95%B7%E7%9A%84%E6%8C%87%E4%BB%A4%EF%BC%8C%E5%8A%A0%E5%BF%AB%E9%96%8B%E7%99%BC%E9%80%9F%E5%BA%A6/">Git 修改又臭又長的指令，加快開發速度</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> WordPress </tag>
            
            <tag> BlueHost </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>為Heroku 上傳的圖片找新的空間：Amazon S3，就決定是你了。</title>
      <link href="//%E7%82%BAHeroku-%E4%B8%8A%E5%82%B3%E7%9A%84%E5%9C%96%E7%89%87%E6%89%BE%E6%96%B0%E7%9A%84%E7%A9%BA%E9%96%93%EF%BC%9AAmazon-S3%EF%BC%8C%E5%B0%B1%E6%B1%BA%E5%AE%9A%E6%98%AF%E4%BD%A0%E4%BA%86%E3%80%82/"/>
      <url>//%E7%82%BAHeroku-%E4%B8%8A%E5%82%B3%E7%9A%84%E5%9C%96%E7%89%87%E6%89%BE%E6%96%B0%E7%9A%84%E7%A9%BA%E9%96%93%EF%BC%9AAmazon-S3%EF%BC%8C%E5%B0%B1%E6%B1%BA%E5%AE%9A%E6%98%AF%E4%BD%A0%E4%BA%86%E3%80%82/</url>
      
        <content type="html"><![CDATA[<p>我用Ruby on Rails寫了一個CRUD網路相簿的網站，主機採用Heroku提供的服務。但是有一個缺點，Heroku不提供檔案儲存的空間，每過一段時間就會洗白一次。<br>講白話一點就是：我上傳的相片過一段時間就會不見了，我得為我的相片找新的空間存放才行。這裡使用的是Amazon S3 storage服務，可以自動上傳到S3空間</p><ul><li><code>20180723</code> 更新，Amazon 有更改介面，故 S3 Access key指引教學也有更新內容。</li></ul><hr><p>廢話不多說，開始教學吧</p><h3 id="教學開始"><a href="#教學開始" class="headerlink" title="教學開始"></a>教學開始</h3><h4 id="安裝Gemfile"><a href="#安裝Gemfile" class="headerlink" title="安裝Gemfile"></a>安裝Gemfile</h4><p><code>gem &quot;fog-aws”</code><br><code>bundle install</code></p><h4 id="在Amazon-S3新增一個新的backet"><a href="#在Amazon-S3新增一個新的backet" class="headerlink" title="在Amazon S3新增一個新的backet"></a>在Amazon S3新增一個新的backet</h4><p>我命名為photo-album-hazel，並設定在日本東京的位置。</p><h4 id="新增目錄-lib-carrierwave-storage-fog-rb"><a href="#新增目錄-lib-carrierwave-storage-fog-rb" class="headerlink" title="新增目錄 lib/carrierwave/storage/fog.rb"></a>新增目錄 lib/carrierwave/storage/fog.rb</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs lua">//在fog.rb貼上<br>CarrierWave.configure <span class="hljs-keyword">do</span> |<span class="hljs-built_in">config</span>|<br>  <span class="hljs-built_in">config</span>.fog_provider = <span class="hljs-string">&#x27;fog/aws&#x27;</span> <br>  <span class="hljs-keyword">if</span> Rails.env.production?<br>    <span class="hljs-built_in">config</span>.fog_credentials = &#123;<br>      provider:              <span class="hljs-string">&#x27;AWS&#x27;</span>,<br>      aws_access_key_id:     ENV[<span class="hljs-string">&#x27;S3_KEY&#x27;</span>],<br>      aws_secret_access_key: ENV[<span class="hljs-string">&#x27;S3_SECRET&#x27;</span>],<br>      region:                <span class="hljs-string">&#x27;ap-northeast-1&#x27;</span><br>    &#125;<br>    <span class="hljs-built_in">config</span>.fog_directory  = ENV[<span class="hljs-string">&#x27;S3_BUCKET&#x27;</span>]<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">config</span>.storage :file<br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><p>在Uploader設定儲存檔案的方式，若在 production 環境下， 將會透過 fog 上傳檔案到 AWS 的 bucket; 若是開發環境， 則會將檔案放在本地端的 public 目錄下。</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-comment"># photo-image-uploader.rb設定</span><br>  <span class="hljs-keyword">if</span> Rails.env.production?<br>    storage <span class="hljs-symbol">:fog</span><br>  <span class="hljs-keyword">else</span><br>    storage <span class="hljs-symbol">:file</span><br>  <span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><h4 id="AWS-S3-KEY-要去哪裡找？"><a href="#AWS-S3-KEY-要去哪裡找？" class="headerlink" title="AWS S3 KEY 要去哪裡找？"></a>AWS S3 KEY 要去哪裡找？</h4><p><em>20180723 更新，Amazon 有更改介面，更新要怎麼從 Amazon 找到 S3 Access key</em></p><ol><li>AWS 登入後</li><li>點開選單，點擊 <code>Security Credentials</code><br><img src="https://i.imgur.com/efIyId3.png" alt="S3 Security Credentials"></li><li>側邊選單點 Users，並建立一個 User 帳戶</li><li>點擊 <code>你剛建立的User帳號</code>，標籤選 <code>Security Credentials</code></li><li>Create Access Key<br><img src="https://i.imgur.com/B4DTXAi.png" alt="20180723 update. how to find Amazon S3 access key"><br>在 Create Access Key的過程便會 Show出 ID 與 KEY 囉。</li></ol><h4 id="Region設定方式查詢：查詢AWS區域代號"><a href="#Region設定方式查詢：查詢AWS區域代號" class="headerlink" title="Region設定方式查詢：查詢AWS區域代號"></a>Region設定方式查詢：<a href="http://docs.aws.amazon.com/general/latest/gr/rande.html" title="查詢AWS區域代號">查詢AWS區域代號</a></h4><table><thead><tr><th style="text-align:left">Region Name</th><th style="text-align:right">代稱</th><th style="text-align:center">Amazon Route 53 Hosted Zone ID*</th></tr></thead><tbody><tr><td style="text-align:left">Asia Pacific (Tokyo)</td><td style="text-align:right">ap-northeast-1</td><td style="text-align:center">apigateway.ap-northeast-1.amazonaws.com</td></tr></tbody></table><p>我設定的bucket在東京：所以Region是ap-northeast-1</p><h4 id="用環境變數方式儲存，heroku與本機設定KEY"><a href="#用環境變數方式儲存，heroku與本機設定KEY" class="headerlink" title="用環境變數方式儲存，heroku與本機設定KEY"></a>用環境變數方式儲存，heroku與本機設定KEY</h4><p>How to setting localhost &amp; Heroku environment variable ?<br>總共有三項要設定，請分別設定在本機、Heroku上</p><ol><li>Bucket Name，像我在S3建立的bucket name就是photo-album-hazel</li><li>KEY ID</li><li>KEY SECRET</li></ol><p>本機 Rails 環境變數設定 AWS S3 KEY</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-builtin-name">export</span> S3_KEY= <span class="hljs-string">&quot;your access key id&quot;</span><br><span class="hljs-builtin-name">export</span> S3_SECRET= <span class="hljs-string">&quot;your secret access key&quot;</span><br></code></pre></td></tr></table></figure><p>範例程式碼如下，請不要複製，皆為虛假，請真正填上你S3的資訊。<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-builtin-name">export</span> <span class="hljs-attribute">S3_KEY</span>=<span class="hljs-string">&#x27;AKIAI2XXX24DGFCDNCQ&#x27;</span><br><span class="hljs-builtin-name">export</span> <span class="hljs-attribute">S3_SECRET</span>=<span class="hljs-string">&#x27;nZZ5JhyVjfKyMC5GD9gGMERLE3j3!XroZsEjLK!T&#x27;</span><br><span class="hljs-builtin-name">export</span> <span class="hljs-attribute">S3_BUCKET</span>=<span class="hljs-string">&#x27;restaurant-review&#x27;</span><br></code></pre></td></tr></table></figure></p><h3 id="Heroku-遠端設定-AWS-S3-KEY"><a href="#Heroku-遠端設定-AWS-S3-KEY" class="headerlink" title="Heroku 遠端設定 AWS S3 KEY"></a>Heroku 遠端設定 AWS S3 KEY</h3><p>若沒有在heroku上設定S3 KEY，直接<code>git push heroku master</code>推到heroku上，會發現推不上去哦！<br>錯誤訊息會這樣顯示</p><blockquote><p>ArgumentError: Missing required arguments: aws_access_key_id, aws_secret_access_key<br>Precompiling assets failed.<br>所以還是要乖乖的先把這步驟做完，遠端連線到Heroku Server並設定好Key後，即可順利推上去。</p></blockquote><p><code>$ heroku config:set S3_KEY=xxx S3_SECRET=yyy S3_BUCKET=zzz</code><br>以下程式碼僅為參考用，非正確可使用的KEY。<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">heroku config:<span class="hljs-builtin-name">set</span> <span class="hljs-attribute">S3_KEY</span>=AKIAI2XXX24DGFCDNCQ<br>heroku config:<span class="hljs-builtin-name">set</span> <span class="hljs-attribute">S3_SECRET</span>=nZZ5JhyVjfKyMC5GD9gGMERLE3j3!XroZsEjLK!T<br>heroku config:<span class="hljs-builtin-name">set</span> <span class="hljs-attribute">S3_BUCKET</span>=restaurant-review<br></code></pre></td></tr></table></figure><br><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/12/23163331/setting-aws-s3-1024x356.png" alt="Setting-AWS-S3-loaclhost"></p><h4 id="設定好了就可以git上傳囉，在heroku上測試是否有成功上傳到S3-bucket吧"><a href="#設定好了就可以git上傳囉，在heroku上測試是否有成功上傳到S3-bucket吧" class="headerlink" title="設定好了就可以git上傳囉，在heroku上測試是否有成功上傳到S3 bucket吧"></a>設定好了就可以git上傳囉，在heroku上測試是否有成功上傳到S3 bucket吧</h4><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">git</span> <span class="hljs-keyword">add</span> .<br><span class="hljs-symbol">git</span> commit -am <span class="hljs-string">&#x27;Setting carrierwave upload to AWS S3&#x27;</span><br><span class="hljs-symbol">git</span> <span class="hljs-keyword">push</span><br><span class="hljs-symbol">git</span> <span class="hljs-keyword">push</span> heroku master<br></code></pre></td></tr></table></figure><p>Push到Heroku後，出現錯誤了。<br>查看heroku logs才知道：Rails找不到Carrierwave的常數fog</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/app/</span>vendor<span class="hljs-regexp">/bundle/</span>ruby<span class="hljs-regexp">/2.3.0/g</span>ems<span class="hljs-regexp">/carrierwave-1.2.0/</span>lib<span class="hljs-regexp">/carrierwave/u</span>ploader/configuration.rb:<span class="hljs-number">78</span>:<span class="hljs-keyword">in</span> `eval<span class="hljs-string">&#x27;: uninitialized constant CarrierWave::Storage::Fog (NameError)</span><br></code></pre></td></tr></table></figure><p>嘗試解決方法</p><ol><li>Gem 安裝 ‘fog’<br>結果：無效</li><li>在 lib/carrierwave/storage/fog.rb 多加上一行程式碼<br><code>require &#39;carrierwave/storage/fog&#39;</code><br>結果：無效</li><li>把 lib/carrierwave/storage/fog.rb 刪除，並在 config/initializer下新增 carrierwave.rb<br>把fog.rb的內容複製過去<br>（當初直接新增fog.rb是完全照著官方文件做的說…）<br>結果：成功，Heroku可以成功開啟網站了（哭）</li></ol><p>可以順利開啟網站後，開Chrome開發人員工具檢查吧，看是否有上傳到AWS S3上</p><p><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/12/23163310/s3-sample.jpg" alt="Successful to upload to AWS S3 using Rails"><br>成功啦！！</p><h4 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h4><ol><li><a href="https://github.com/carrierwaveuploader/carrierwave#uploading-files-from-a-remote-location">CarriveWave Github 官方文件</a></li><li><a href="http://tsaith.github.io/shi-yong-carrierwave-shang-chuan-dang-an-dao-aws-s3.html">使用Carrierwave上傳到AWS S3</a></li><li><a href="http://rubyist.marsz.tw/blog/2012-01-10/carrierwave-guides-with-amazon-s3-and-imagemagick-integration/">使用 Carrierwave 處理檔案上傳 (整合 imagemagick 與 Amazon S3)</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>神奇的migration 生成器 | Ruby on Rails 5</title>
      <link href="//%E7%A5%9E%E5%A5%87%E7%9A%84migration-%E7%94%9F%E6%88%90%E5%99%A8-Ruby-on-Rails-5/"/>
      <url>//%E7%A5%9E%E5%A5%87%E7%9A%84migration-%E7%94%9F%E6%88%90%E5%99%A8-Ruby-on-Rails-5/</url>
      
        <content type="html"><![CDATA[<h2 id="神奇的migration-生成器-Ruby-on-Rails-5"><a href="#神奇的migration-生成器-Ruby-on-Rails-5" class="headerlink" title="神奇的migration 生成器 | Ruby on Rails 5"></a>神奇的migration 生成器 | Ruby on Rails 5</h2><p>參照著格式便可以自動產生Migration檔（包含格式與欄位及型態）</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">rails g add_xxx_to_資料表 <span class="hljs-selector-attr">[field:type]</span><span class="hljs-selector-attr">[:index]</span><br>rails g remove_xxx_to_資料表 <span class="hljs-selector-attr">[field:type]</span><span class="hljs-selector-attr">[:index]</span><br></code></pre></td></tr></table></figure><p>同時可以設定我們需要的欄位，<br>我想要新增一個fee欄位到users的Table下</p><blockquote><p>你可以想像成一個Excel表，這個Excel Table叫做Users，<br>因為Excel表有很多資料欄位(field)，所以都要用複數來表示，也就是Users<br>按照Rails的慣例，Table總表以複數來表示。<br><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fortran">rails g migration add_fee_to_users fee:<span class="hljs-keyword">integer</span>:<span class="hljs-built_in">index</span><br></code></pre></td></tr></table></figure></p></blockquote><p>在後面加上:index則是代表要幫這個資料欄位<code>fee</code>加上索引<br>加上索引是為了避免產生太多的查詢，像是query+1效能問題</p><h3 id="怎麼判斷這個資料欄位-field-要不要加上索引？"><a href="#怎麼判斷這個資料欄位-field-要不要加上索引？" class="headerlink" title="怎麼判斷這個資料欄位(field)要不要加上索引？"></a>怎麼判斷這個資料欄位(field)要不要加上索引？</h3><p>可以參考幾個點，但主要還是要看這個欄位<code>fee</code>是否會是需要常查詢的欄位？</p><ol><li>會被查詢的欄位（使用where)</li><li>會被group的欄位(使用到group方法)</li><li>會被排序的欄位(使用到order)</li><li>外部鍵foreign key</li></ol><p>他便會自動產生Migration檔：時間戳記_add_fee_to_users<br>註：時間戳記會根據現實的時間自動產生，像是20180523051928這種形式<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AddeeToLoans</span> &lt; ActiveRecord::Migration[5.1]</span><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change</span></span><br>    add_column <span class="hljs-symbol">:users</span>, <span class="hljs-symbol">:fee</span>, <span class="hljs-symbol">:integer</span><br>    add_index <span class="hljs-symbol">:users</span>, <span class="hljs-symbol">:fee</span><br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure></p><h3 id="後悔產生migration檔，如何手動刪除？"><a href="#後悔產生migration檔，如何手動刪除？" class="headerlink" title="後悔產生migration檔，如何手動刪除？"></a>後悔產生migration檔，如何手動刪除？</h3><p>注意：這個刪除的前提是你還沒有跑migration，也就是還沒真的新增此欄位到資料庫裡<br>剛剛生成的指令是輸入</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fortran">rails g migration add_fee_to_users fee:<span class="hljs-keyword">integer</span>:<span class="hljs-built_in">index</span><br></code></pre></td></tr></table></figure><p>那麼刪除就只要將g改為d就可以囉！</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fortran">rails d migration add_fee_to_users fee:<span class="hljs-keyword">integer</span>:<span class="hljs-built_in">index</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> migration </tag>
            
            <tag> rails </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何使用 Hexo + Github Page 自訂網域名稱 + Cloudflare SSL 免費憑證</title>
      <link href="//%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-Hexo-Github-Page-%E7%94%A8-Cloudflare-%E7%B6%81%E5%AE%9A%E5%80%8B%E4%BA%BA%E7%B6%B2%E5%9D%80/"/>
      <url>//%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-Hexo-Github-Page-%E7%94%A8-Cloudflare-%E7%B6%81%E5%AE%9A%E5%80%8B%E4%BA%BA%E7%B6%B2%E5%9D%80/</url>
      
        <content type="html"><![CDATA[<h1 id="如何使用-Hexo-Github-Page-用-Cloudflare-綁定個人網址"><a href="#如何使用-Hexo-Github-Page-用-Cloudflare-綁定個人網址" class="headerlink" title="如何使用 Hexo + Github Page 用 Cloudflare 綁定個人網址"></a>如何使用 Hexo + Github Page 用 Cloudflare 綁定個人網址</h1><p><img src="https://i.imgur.com/NDKQqjz.png" alt="如何使用 Hexo + Github Page 用 Cloudflare 綁定個人網址"><br>本篇適用於用Hexo框架架設在Github Pages上，但想要綁定自己買的網址。<br>由於Github Pages 產生的個人網址太長，對 SEO 不友善，不是這麼好被搜尋引擎收錄，</p><h2 id="步驟"><a href="#步驟" class="headerlink" title="步驟"></a>步驟</h2><ol><li>Github Repo 設定 Custom Domain</li><li>在 Repo專案下新增 CNAME，完成網址綁定</li><li>用 Cloudflare 提供免費的 SSL 憑證，得以正確讀取 CSS、Google視為安全網站認證</li></ol><h2 id="Github-設定專屬網址"><a href="#Github-設定專屬網址" class="headerlink" title="Github 設定專屬網址"></a>Github 設定專屬網址</h2><p>開啟Github的Hexo專案，選Setting-&gt;Options-&gt; Github Pages -&gt; Custom Domain，填入自己的網域（例如：<code>wualnz.com</code>），接著儲存。<br><img src="https://i.imgur.com/7ZyGcn5.png" alt="Setting Github Custom Domain figure"></p><h3 id="新增-CNAME"><a href="#新增-CNAME" class="headerlink" title="新增 CNAME"></a>新增 CNAME</h3><p>在該 Hexo 專案下的 <code>source</code> 資料夾下新增檔案 <code>CNAME</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">## In project</span><br><span class="hljs-built_in">cd</span> /<span class="hljs-built_in">source</span><br>touch CNAME<br></code></pre></td></tr></table></figure><br>修改 CNAME 內容，將域名填入即可，並重新部署到Github。<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">wualnz.<span class="hljs-keyword">com</span><br></code></pre></td></tr></table></figure><br><a href="https://github.com/Hazelwu2/22mm/blob/master/CNAME">點我查看 Github Repo CNAME 設定完成範例</a></p><blockquote><p>到底要放在 <code>/source</code> 還是 <code>最上層資料夾</code>？</p></blockquote><p>若使用Hexo框架的話，要將<code>CNAME</code>放置在 <code>/source</code>資料夾內，原因是：當每次<code>hexo deploy</code>時才不會被覆蓋到。<br>若不是使用Hexo的話，沒有自動部署，直接將<code>CNAME</code>檔放在Proejct內即可。</p><h3 id="CNAME-導向個人網址-原理"><a href="#CNAME-導向個人網址-原理" class="headerlink" title="CNAME 導向個人網址 原理"></a>CNAME 導向個人網址 原理</h3><p>使用者在瀏覽器輸入<code>wualnz.com</code>後，DNS 便會開始解析找到 Github的 IP<br><br></p><p>Github上有成千上百萬個Pages由不同使用者建立，Github不會知道網址<code>wualnz.com</code>是屬於 哪個 User 哪個 Repo，因此需要在Repo下放上 CNAME，這樣 Github才找得到，哦！就是這個hazelwu2/22mm的Repo！並回傳給瀏覽器</p><h4 id="CNAME-是什麼？"><a href="#CNAME-是什麼？" class="headerlink" title="CNAME 是什麼？"></a>CNAME 是什麼？</h4><p>它是一種 DNS 紀錄類型，可以將別名（綽號）對應到實際或正規的網址。<br>當你在瀏覽器上輸入 <code>wualnz.com</code>時，瀏覽器會去找 <code>DNS</code> ，經過DNS的解析 <code>wualnz.com</code> 得到： <code>wualnz.com</code> Github IP 位址，例如找到的是<code>192.168.0.444</code>。</p><blockquote><p>最常見的 <code>CNAME</code> 用法<br>瀏覽器上輸入 <code>www.wualnz.com</code> Enter後會自動跳轉到（對應到）<code>wualnz.com</code><br>不論是輸入<code>wualnz.com</code>還是<code>www.wualnz.com</code> 都能正確導向至網站。</p></blockquote><h4 id="A-Records-是什麼？"><a href="#A-Records-是什麼？" class="headerlink" title="A Records 是什麼？"></a>A Records 是什麼？</h4><p>A Records 就是 該主機的 IP 位址。<br>像 <code>wualnz.com</code> 方便人們記憶的名稱，最後會被解析成很難記住的 IP 位址，例：<code>192.168.0.444</code></p><h2 id="Hexo-設定-url-個人網域"><a href="#Hexo-設定-url-個人網域" class="headerlink" title="Hexo 設定 url 個人網域"></a>Hexo 設定 url 個人網域</h2><p>打開_config.yml<br>其中找到url與root，設定為自己網域名稱。</p><p>若沒有個人網域，可以用預設的Github Pages產生的url（例如：<code>hazelwu2.github.io/22mm</code>)</p><h3 id="無個人網域-設定"><a href="#無個人網域-設定" class="headerlink" title="無個人網域 設定"></a>無個人網域 設定</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-meta">## _config.yml</span><br><span class="hljs-symbol">url:</span> http:<span class="hljs-comment">//github帳號.github.io/repo名稱</span><br><span class="hljs-symbol">root:</span> /repo名稱<br></code></pre></td></tr></table></figure><p>舉例來說，我的Github帳號是<code>hazelwu2</code>，Repo名稱叫<code>22mm</code>，那麼設定就會像下列這樣<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment">## _config.yml</span><br>url: https:<span class="hljs-regexp">//</span>hazelwu2.github.io<span class="hljs-regexp">/22mm/</span><br>root: <span class="hljs-regexp">/22mm/</span><br></code></pre></td></tr></table></figure></p><h3 id="有個人網域-設定"><a href="#有個人網域-設定" class="headerlink" title="有個人網域 設定"></a>有個人網域 設定</h3><p>有個人網域的話，開啟 _config.yml，並將url設定成自己購買的網址，記得<code>/</code>不要省略<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">url:</span> http:<span class="hljs-comment">//wualnz.com/</span><br><span class="hljs-symbol">root:</span> /<br></code></pre></td></tr></table></figure><br>最後，再回到github你的repo內，設定 Custom Domain</p><ol><li>進入github，點 Hexo 的 Repo，並進入設定</li><li>GitHub Pages 下的 Custom domain</li><li>修改成你購買的網域。（要與CNAME檔案設定一致）</li></ol><p>（例：我的網域是wualnz）<br><img src="https://i.imgur.com/kbEuK16.png" alt="Github 設定 Custom Domain Hexo"></p><p>以上步驟完成後，便綁定個人網域成功。<br><br></p><h2 id="Hexo-綁定自訂網址後，CSS-無法正常載入"><a href="#Hexo-綁定自訂網址後，CSS-無法正常載入" class="headerlink" title="Hexo 綁定自訂網址後，CSS 無法正常載入"></a>Hexo 綁定自訂網址後，CSS 無法正常載入</h2><p>綁定網址後開心的進入網站，發現：靠～無法載入 CSS ，打開 Console.log 檢查發現<br><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">404 </span><span class="hljs-keyword">Error</span> <span class="hljs-keyword">Not</span> found<br></code></pre></td></tr></table></figure></p><blockquote><p>原因來自於：<br>Github Page 不支援自定義的 SSL 憑證，也就是說：使用Github Pages 綁定自己的網址，會和 Github 起衝突</p></blockquote><h3 id="解決方法"><a href="#解決方法" class="headerlink" title="解決方法"></a>解決方法</h3><ol><li>自訂網域付費購買 SSL 憑證</li><li>使用免費憑證（例：Let’s Encrypt）</li><li>CDN Cloud Flare服務</li></ol><p>比較建議使用 CDN 的 Cloud Flare，Let’s Encrypt雖是免費憑證，但需要三個月手動更換一次。<br>接下來會介紹如何在 Cloudflare 做設定</p><h3 id="Cloudflare-設定"><a href="#Cloudflare-設定" class="headerlink" title="Cloudflare 設定"></a>Cloudflare 設定</h3><p>設定前，需要將你的網址商設定<code>網域名稱伺服器</code>為Cloudflare提供的網址，讓Cloudflare 代管 DNS Server<br>我買的網址商是Godaddy的，因此在Godaddy面板上設定會像是這樣<br><img src="https://i.imgur.com/ad5nlWf.png" alt="Godaddy 設定 Cloudflare 代管DNS"><br>在網址商Godaddy設定成功後，在Cloudflare樣板會看到 Status:Active，表示設定成功。<br><img src="https://i.imgur.com/p497z5I.png" alt="Cloudflare Setting DNS Server Active Successful"></p><p>前往Cloudflare DNS</p><ol><li>新增兩個 A Records，皆指向Github IP：<code>192.30.252.153</code>、<code>192.30.252.154</code></li><li>新增 CNAME，NAME 填 www，Value填上 Github帳號.github.io<br>設定完成後，應該會像下圖這樣。<br><img src="https://i.imgur.com/M2QuOzg.png" alt="Cloudflare setting github page with custom domain"></li></ol><h3 id="設定-SSL-憑證"><a href="#設定-SSL-憑證" class="headerlink" title="設定 SSL 憑證"></a>設定 SSL 憑證</h3><p>Cloudflare DNS 設定完成後，到Crypto標籤，我們要設定 SSL憑證</p><p>SSL有Flexible、Full選項，這兩個都可以選。<br><img src="https://i.imgur.com/4IRZ3Ic.png" alt="Cloudflare Crypto setting SSL"><br>將 Always user HTTPS 打開，變成 On狀態<br><img src="https://i.imgur.com/lqmzqKD.png" alt="Cloudflare Crypto setting SSL"></p><p>設定完後，恭喜你，重新Refresh網址後，網站已經能成功抓到 CSS 囉</p><blockquote><h4 id="Cloudflare-SSL-Flexible-、-Full-差別"><a href="#Cloudflare-SSL-Flexible-、-Full-差別" class="headerlink" title="Cloudflare SSL Flexible 、 Full 差別"></a>Cloudflare SSL Flexible 、 Full 差別</h4><p>下圖為<a href="https://support.cloudflare.com/hc/en-us/articles/200170416-What-do-the-SSL-options-mean-">官方網站提供的說明圖樣</a><br>Flexible、Full 差別在於 Cloudflare 與 Server 間 <strong>是否為加密連線</strong>，官方推薦大家設定 Full SSL。<br>Flexible 是 對 Server 間的連線是不加密的。<br><img src="https://support.cloudflare.com/hc/en-us/article_attachments/206124658/cfssl_flexible.png" alt="Cloudflare SSL Flexible"><br>Full 是你擁有一方的SSL憑證，你可以自由選擇一方是否加密。白話一點就是：CloudFlare不管是對訪客、還是對Server端都能夠加密！而且免付費會員也可以使用這功能。<br><img src="https://support.cloudflare.com/hc/en-us/article_attachments/206167937/cfssl_full.png" alt="Cloudflare SSL Full"></p></blockquote><p>如果想知道更詳細內容，可以看看我寫的這篇文章：關於<a href="https://medium.com/@hazelwu/rails-%E8%97%89cloudflare-%E5%85%8D%E8%B2%BBssl%E8%AA%8D%E8%AD%89%E5%BE%8C-%E7%84%A1%E6%B3%95%E7%99%BB%E5%85%A5%E5%BE%8C%E5%8F%B0-%E8%A7%A3%E6%B1%BA%E8%BE%A6%E6%B3%95-4b87d59be765">Rails &amp; Cloudflare use Free SSL, 無法登入後台 解決辦法</a></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://liyang.pro/hexo-github-cloudflare-customer-domain-ssl/">Hexo+GitHub+Cloudflare实现自定义域名全站SSL</a></li><li><a href="https://support.cloudflare.com/hc/en-us/articles/200170416-What-do-the-SSL-options-mean-">What do the SSL options mean?</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> CloudFlare </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Macbook Pro 2017版，外接兩個螢幕 | 全攻略</title>
      <link href="//Macbook%20Pro%202017%E7%89%88%EF%BC%8C%E5%A6%82%E4%BD%95%E6%9E%B6%E8%A8%AD%E5%85%A9%E5%80%8B%E8%9E%A2%E5%B9%95/"/>
      <url>//Macbook%20Pro%202017%E7%89%88%EF%BC%8C%E5%A6%82%E4%BD%95%E6%9E%B6%E8%A8%AD%E5%85%A9%E5%80%8B%E8%9E%A2%E5%B9%95/</url>
      
        <content type="html"><![CDATA[<h1 id="Macbook-Pro-2017版，外接兩個螢幕-全攻略"><a href="#Macbook-Pro-2017版，外接兩個螢幕-全攻略" class="headerlink" title="Macbook Pro 2017版，外接兩個螢幕 | 全攻略"></a>Macbook Pro 2017版，外接兩個螢幕 | 全攻略</h1><p><img src="https://i.imgur.com/TmzH6C8.jpg" alt="Macbook Pro 2017 how to connect two display tutorial"></p><h4 id="為什麼要外接兩個螢幕？"><a href="#為什麼要外接兩個螢幕？" class="headerlink" title="為什麼要外接兩個螢幕？"></a>為什麼要外接兩個螢幕？</h4><p>架設三個螢幕的用途是：最左邊 Mbp 顯示程式結果、中間 20吋 主要寫 Code、右邊24吋螢幕能垂直擺放，用來查資料。<br>多螢幕用途是為了不讓注意力被分心，提高工作效率。</p><blockquote><p>如果你也認同這一點，也希望提高工作效率，那麼你可以考慮購買雙螢幕。</p></blockquote><p>下列將介紹我是如何用Macbook Pro 2017 外接兩個螢幕<br>其中在選購螢幕時也發現很多眉眉角角，也會分享我對螢幕挑選的準則。<br><br></p><blockquote><h2 id="還在單一螢幕-Macbook-時期"><a href="#還在單一螢幕-Macbook-時期" class="headerlink" title="還在單一螢幕 Macbook 時期"></a>還在單一螢幕 Macbook 時期</h2><p>我常在切換視窗時忘記現在要幹嘛XD，手忙腳亂的一下開VS Code、一下要切換localhost檢查結果，或又要換成Chrome來查資料<br>自從外接單螢幕後，真誠地發現越少的切換視窗，可以幫助自己更專心！</p></blockquote><h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>以下是我自己本身的需求，可以參考看看</p><ol><li>需要外接兩個螢幕</li><li>深度夠的桌面，可以外接鍵盤、滑鼠，還能寫筆記</li><li>2 USB、1 HDMI、2 Type-C 轉接頭</li></ol><p>最困擾的是 Macbook Pro 2017 出廠後只有兩個 Type-C 孔，變得是購買之前都要深思熟慮、搜集好資訊。兩個 Type-C 意味著要買好多好多轉接頭啊，扣掉充電線就只剩下一個了哪，錢包你為什麼都肥不起來&gt;”&lt;</p><p><br></p><blockquote><h3 id="根據螢幕選購-Type-C-轉接頭"><a href="#根據螢幕選購-Type-C-轉接頭" class="headerlink" title="根據螢幕選購 Type-C 轉接頭"></a>根據螢幕選購 Type-C 轉接頭</h3><p>如果你外接的螢幕是舊螢幕（VGA接孔），非常推薦買小米五合一的轉接頭，不貴且有 2 USB + 1 Type-C(可充電) + 1 VGA + 1 網路孔，千元有找！<br>比較新型的螢幕可能有Display Port、HDMI等等，那就是看你個人需求，去購買對應的轉接頭<br>要根據你需要外接螢幕接的是什麼樣的孔，來選配轉接頭，才不會白買哦</p></blockquote><h2 id="Macbook-Pro-2017-外接螢幕配備"><a href="#Macbook-Pro-2017-外接螢幕配備" class="headerlink" title="Macbook Pro 2017 外接螢幕配備"></a>Macbook Pro 2017 外接螢幕配備</h2><p>以下列的是上圖工作桌的所有配備</p><ol><li>工作桌 長度 140 cm x 深度 65 cm | Ikea HILVER 桌面 + ADILS 桌腳 | $ 3390</li><li>Macbook Pro 2017 | 13吋 </li><li>E202H Display | 20 吋螢幕 | VGA | $ 0 （二手）</li><li>DELL U2415 | 22 吋螢幕 | HDMI | $ 8430</li><li>HDMI 1.4 版 公轉公<br><img src="https://www.jakartanotebook.com/images/products/39/8/5218/2/high-speed-hdmi-to-hdmi-cable-od7.3mm-gold-plated-4k-5m-black-42.gif" alt=""></li><li>小米 USB-C 轉 VGA 五合一 轉接頭<br>（台灣小米之家沒有販賣，購買管道要從淘寶官方/露天賣家尋找）<br><img src="https://i.imgur.com/QBpgf2K.jpg" alt=""></li><li>Type-C 轉 HDMI / Type-C / USB<br><img src="https://i.imgur.com/EAuMX65.jpg" alt="Type-C 轉 HDMI / Type-C / USB"></li></ol><h2 id="挑選電腦桌"><a href="#挑選電腦桌" class="headerlink" title="挑選電腦桌"></a>挑選電腦桌</h2><h4 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h4><p>如果你想要能夠外接鍵盤、滑鼠，建議桌子深度可以挑50cm以上的桌子，40cm絕對不推薦，太淺了。<br>但是如果你想要可以另外寫筆記、又外接鍵盤滑鼠，顯得不狹窄，建議挑桌子深度65cm就夠用了<br><br></p><h4 id="長寬度建議"><a href="#長寬度建議" class="headerlink" title="長寬度建議"></a>長寬度建議</h4><p>外接單個螢幕，桌子至少長度要<code>120cm</code><br>外接雙螢幕的話，桌子長度 120cm 會稍微擁擠，預算夠的話可以直接上140cm!XD<br>我是購買Ikea桌子，桌子頗穩固，拿螺絲自己鎖很快，組裝也超簡單</p><blockquote><p>如果線上桌子沒有你想要款式的話，Ikea有提供客製化桌面：<a href="https://www.ikea.com/tw/zh/catalog/categories/departments/workspaces/tools/planner_build_your_own_desk/">Ikea 客製化書桌</a><br>桌面長寬度、桌腳要什麼都可以自己配，超方便。乾，搞得有點像是業配文QQ</p></blockquote><h2 id="長時間-Coding-看螢幕，如何挑選螢幕"><a href="#長時間-Coding-看螢幕，如何挑選螢幕" class="headerlink" title="長時間 Coding 看螢幕，如何挑選螢幕"></a>長時間 Coding 看螢幕，如何挑選螢幕</h2><p>工程師長期是用眼睛、腦在工作，尤其眼睛最重要，動不動看螢幕就是8小時起跳，如果等眼睛不好時才想到要保養，真的會來不及。<br>過去太操眼睛，導致看螢幕不到兩小時就看不下去了，靠！這要怎麼工作啊..</p><blockquote><p>工程師的職業傷害是近視度數加深、長期眼睛疲勞，想要眼睛不易疲勞，列出幾項建議</p><ol><li>善用 f.lux 軟體降低藍光</li><li>配電腦專用眼鏡，度數要比正常度數低 50~100 度</li><li>寫程式、查資料是靜態畫面，不用特別買特高更新頻率、曲面更是不需要（只是會潮到出水而已XD）</li><li>買不閃屏螢幕，降低螢幕亮度</li><li>環境燈光要明亮</li></ol></blockquote><h3 id="環境光源更重要"><a href="#環境光源更重要" class="headerlink" title="環境光源更重要"></a>環境光源更重要</h3><blockquote><p>眼睛不易疲勞，環境光源亮度 &gt; 上等好螢幕</p></blockquote><p>如果你的需求是看螢幕較不會對眼睛造成太大負擔，你必須要知道的是：環境燈光 &gt; 好螢幕<br>當電腦桌燈光較幽暗，外光線比較亮，導致你的瞳孔放大，長期下來會讓你看沒多久螢幕就會受不了</p><blockquote><p>倘若你的環境燈光暗到像世界末日，找水電工換個燈光吧，對了記得要LED，省電省瓦數（笑），明亮的環境也有助於改善心情。</p></blockquote><p>接著，下面會著重講解怎麼挑選「不閃屏螢幕」</p><h4 id="閃屏是什麼？"><a href="#閃屏是什麼？" class="headerlink" title="閃屏是什麼？"></a>閃屏是什麼？</h4><p>螢幕其實有肉眼看不見的閃爍，你相信嗎？最簡單的實驗是拿著手機對著螢幕錄影，你看看有沒有出現一條一條的線。<a href="https://youtu.be/8lEZQRv3MPk?t=23">不閃屏 VS 閃屏對比影片</a>，點擊影片花個三十秒，你會更了解：平常閃屏螢幕是怎麼摧殘眼睛的。</p><h4 id="為什麼要挑選不閃屏的螢幕？"><a href="#為什麼要挑選不閃屏的螢幕？" class="headerlink" title="為什麼要挑選不閃屏的螢幕？"></a>為什麼要挑選不閃屏的螢幕？</h4><p>如果你一天看螢幕八個小時，一秒高達250次的閃屏螢幕，看八小時的螢幕也等於被閃了5760000次！不閃屏有助於減少眼睛疲勞！<br>螢幕的錢絕對不要省，對自己的眼睛好一點，一台好的螢幕如EIZO 低階款 13,900，最少也能用5年，等於說你是一天花7.6元而已，眼睛不疲勞能讓你休息時間繼續進修，技術升等了就也加薪了，是不是賺很大，這點錢真的就別省了！</p><h4 id="此不閃屏非彼「不閃屏」"><a href="#此不閃屏非彼「不閃屏」" class="headerlink" title="此不閃屏非彼「不閃屏」"></a>此不閃屏非彼「不閃屏」</h4><p>許多廠商知道消費者注重眼睛健康，要購買不閃屏螢幕，紛紛標榜說「不閃屏螢幕」</p><blockquote><p>標榜不閃屏，一調低亮度就破功</p></blockquote><p>100%亮度時確實是不閃屏，現代螢幕出產皆為LED燈管，不再是舊技術CCLF（較不亮），導致螢幕在100%亮度時，認為太亮、眼睛好酸，便會將亮度調低到50%、30%，甚至更低。<br><br><br>那你知道嗎？當亮度調到50%、30%時，這時閃屏就會出現了，還會伴隨著 PWA，導致不舒服。（也是我購買螢幕時做功課，才知道有時看螢幕看到噁心想吐、頭暈，原來都是 PWA 惹的禍），這就是此不閃屏非彼「不閃屏」的由來！</p><h4 id="換句話說"><a href="#換句話說" class="headerlink" title="換句話說"></a>換句話說</h4><p>如果亮度太低，螢幕的閃爍就會加強，瞳孔不斷放大縮小，讓眼睛更疲勞<br>如果亮度太高，螢幕的藍光就會加強，黃斑部應付過量藍光，也會更疲勞</p><blockquote><p>結論：要買好螢幕，可以調低亮度也不會產生 PWM 的螢幕，才能有效降低眼睛負擔</p></blockquote><blockquote><p>小知識：PWM 會傷害人體、傷眼<br>PWM (Pulse Width Modulation)，當亮度調到 20% 以下時會導致 PWM 劇烈，往往伴隨著眼睛難受、頭痛甚至噁心想吐的情況發生。亮度 20% 以下會變得更劇烈的原因：調光方式是藉由閃爍來達到變暗的效果，下列附上TFC CENTRAL對PWM的詳細介紹。<br><a href="http://www.tftcentral.co.uk/articles/pulse_width_modulation.htm">PWM - Introduction | TFTCENTRAL</a><br>目前上等好螢幕對於「調低亮度會產生 PWM 」沒有完美的解決方案，像是知名廠牌EIZO是用混合方式解決，亮度低於20用高頻18000Hz（無論眼睛、手機螢幕錄影都捕捉不到），或是有些廠商是用 DC調光 解決。</p></blockquote><h3 id="挑選螢幕的準則"><a href="#挑選螢幕的準則" class="headerlink" title="挑選螢幕的準則"></a>挑選螢幕的準則</h3><p>挑選對眼睛負擔較小的螢幕，必須要有以下準則</p><ol><li>不會閃屏（亮度低於100%也不會閃屏）</li><li>不會因為調低螢幕亮度，產生 PWA<br>下列連結是 TFT Central 目前對所有已做過測試 PWA 螢幕匯集的總表，如果<strong>不會產生 PWA，會顯示 Confir-med: Yes</strong><br>最快的辦法是從這個列表中挑出 Yes 的螢幕型號，再根據自己的預算慢慢篩掉。<br><a href="http://www.tftcentral.co.uk/articles/flicker_free_database.htm">Flicker Free Database 所有螢幕對 PMA 測試 | TFT Central</a></li></ol><blockquote><p>TFT Central 是什麼？<br>TFT Central是一個來自英國權威且老牌的測試螢幕網站，網站內容皆是對螢幕的詳細測試、專業性評論，包含亮度調到多少時，瓦數會有怎樣的表現、調低亮度時是否會產生過高的閃爍、PWA、色調、校色、與其他螢幕校色性能比較、旋轉角度、亮度與穩定對比度比較、面板平均性等超細項的調查。編輯者皆為專業知識豐富者，找LED螢幕資料時，是一個很值得參考的網站，缺點是：因為測試太齊全了、導致網站更新很慢，不是所有螢幕都有測試報告。</p></blockquote><p>總而言之就是</p><ol><li>先找出你鍾意的螢幕</li><li>Google搜尋喜歡螢幕型號，再多加上幾組關鍵字「PWM Flicker free tests」<br><br><br>例如：考慮想買Dell U2415，Google先搜尋 <code>DELL U2415m pwm flicker free test</code> 查看報告結果，以TFT CENTRAL提供資訊為主，<a href="http://www.tftcentral.co.uk/reviews/dell_u2415.htm">Dell U2415M測評</a>，找到<code>Backlight Dimming and Flicker</code>段落，你會看到下列圖片。<br><img src="https://i.imgur.com/asAnEcT.png" alt="U2415m filcker free"><blockquote><p>圖片在說什麼？<br>最左上角的<code>Pulse Width Modulation Used</code> 就是最討厭的 PWM 了，如果右邊對應的是 No，代表不會產生 PWM<br>Cycling Frequency指的是循環頻率，當1200 Hz時候會產生非常低的震盪次數。（PWM 產生是因為亮度調暗後必須加快閃爍頻率）<br>100 % Brightness時，當螢幕亮度為 100% 不會產生 PWM、50 % Brightness也不會、0% Brightness 也不會有PWM，恭喜你！當你看到這張圖片都顯示ＮＯ時，這台螢幕你真的可以考慮帶回家了！</p></blockquote></li></ol><h4 id="專業性測評螢幕-相關網站"><a href="#專業性測評螢幕-相關網站" class="headerlink" title="專業性測評螢幕 | 相關網站"></a>專業性測評螢幕 | 相關網站</h4><p>除了<code>TFT Central</code>之外，還有幾個外國網站也是專業性測評螢幕可以提供參考。</p><ul><li><a href="http://www.tftcentral.co.uk/">TFT Central</a></li><li><a href="https://www.prad.de/">Prad</a></li><li><a href="https://displaylag.com/">Displaylad</a></li></ul><h3 id="Dell-U2415-如何接線-？"><a href="#Dell-U2415-如何接線-？" class="headerlink" title="Dell U2415 如何接線 ？"></a>Dell U2415 如何接線 ？</h3><p>經過測試後，決定把Dell U2415搬回家，悲劇發現：靠！我不會接到Macbook，好蠢喔（笑）<br>後來調查幾個解決方案，我是直接買HDMI接公對公 + Type-C 轉 HDMI 轉接頭才得以 Online…</p><ol><li>USB 對 miniDP 可以將螢幕當作USB HUB，外接設備可連接在螢幕的USB上。</li><li>DP 對 miniDP，DP插螢幕，mini DP插電腦，顯示卡沒有Display插槽就無法用</li><li>買一條支援 2K/4K HDMI 公對公</li><li>買一條 MiniDP轉DP 即可接上螢幕，但 DP 的線需要買支援到 4K 的</li></ol><h3 id="關於-HDMI-線材-1-4-和-2-0-差別"><a href="#關於-HDMI-線材-1-4-和-2-0-差別" class="headerlink" title="關於 HDMI 線材 1.4 和 2.0 差別"></a>關於 HDMI 線材 1.4 和 2.0 差別</h3><p>他們的差別在於輸出畫質是否高於 1080P<br>HDMI 1.4版，最高輸出只會到 1080P 而已<br>HDMI 2.0版可以輸出 2k/4K，輸入畫質可以 &gt; 1080P</p><blockquote><p>如果你有使用到 4k 解析度的需求或螢幕解析度比例是 21:9，一定要特別選購 HDMI 2.0(60Hz)以上版本的傳輸線，否則會黑頻。</p></blockquote><h3 id="參考文章"><a href="#參考文章" class="headerlink" title="參考文章"></a>參考文章</h3><ul><li><a href="https://isite.tw/2016/08/10/16680/4">電腦達人養成計畫 5-3：HDMI？DVI？VGA？各式螢幕介面完全解析與選購指南</a></li><li><a href="https://www.mobile01.com/topicdetail.php?f=350&amp;t=4852168">EIZO 螢幕 跟 benq光智慧 大家會選哪一款 護眼的話</a></li><li><a href="http://www.tftcentral.co.uk/reviews/dell_u2415.htm">Dell U2415 Review | TFT Central</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Macbook Pro </tag>
            
            <tag> 外接螢幕 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>複製 Production 真實環境資料，模擬超逼真測試 | Rails 5</title>
      <link href="//%E8%A4%87%E8%A3%BD-Production-%E7%9C%9F%E5%AF%A6%E7%92%B0%E5%A2%83%E8%B3%87%E6%96%99%EF%BC%8C%E6%A8%A1%E6%93%AC%E8%B6%85%E9%80%BC%E7%9C%9F%E6%B8%AC%E8%A9%A6-Rails-5/"/>
      <url>//%E8%A4%87%E8%A3%BD-Production-%E7%9C%9F%E5%AF%A6%E7%92%B0%E5%A2%83%E8%B3%87%E6%96%99%EF%BC%8C%E6%A8%A1%E6%93%AC%E8%B6%85%E9%80%BC%E7%9C%9F%E6%B8%AC%E8%A9%A6-Rails-5/</url>
      
        <content type="html"><![CDATA[<p>為了擬真測試，我們往往需要更真實的數據，採取的作法是：將 Production 真實性的資料庫複製一份至 local 端測試，本文採取直接用Postgresql操作，並紀錄當下遇到的問題及解決辦法。</p><h3 id="將要測試的資料庫（例如：production）匯出成sql"><a href="#將要測試的資料庫（例如：production）匯出成sql" class="headerlink" title="將要測試的資料庫（例如：production）匯出成sql"></a>將要測試的資料庫（例如：production）匯出成sql</h3><p>將原始production資料庫:database_name，匯出成「database_name-20180612.sql」檔案</p><blockquote><p>（註：通常會加上日期，會較為清楚知道這是什麼時期匯出的資料）</p></blockquote><p>你需要知道：Server端上的database_url、Server的IP及資料庫的名稱<br>格式大約會像是這樣：</p><p>你可以從Google Cloud Platform上查詢或是在Server租用的主機商查看資訊<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">database_url<br>範例格式：postgresql:<span class="hljs-regexp">//</span>資料庫使用者:資料庫密碼@ServerIP/database_name<br>真實格式：postgresql:<span class="hljs-regexp">//</span>hazelwu:<span class="hljs-number">123456</span>@<span class="hljs-number">11.12</span>.<span class="hljs-number">200.205</span>/production<br></code></pre></td></tr></table></figure><br>如果不清楚database_url是怎麼生成的，可以參考這篇文章：<a href="http://edgeguides.rubyonrails.org/configuring.html#configuring-a-database">Rails Guide Configure database</a></p><p>遠端連上Server後<br>ssh <a href="mailto:hazelwu@11.12.200.205">hazelwu@11.12.200.205</a><br>移動到專案目錄後，在Commend Line上輸入，並自行填上相關參數<br><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">pg_dump -h <span class="hljs-number">11.12</span><span class="hljs-number">.200</span><span class="hljs-number">.205</span> -U 資料庫使用者 資料庫名稱 &gt; production<span class="hljs-number">-20180612.</span><span class="hljs-keyword">sql</span><br>## 範例：使用者 hazelwu, 資料庫名稱 <span class="hljs-number">123456</span><br>pg_dump -h <span class="hljs-number">11.12</span><span class="hljs-number">.200</span><span class="hljs-number">.205</span> -U hazelwu <span class="hljs-number">123456</span> &gt; production<span class="hljs-number">-20180612.</span><span class="hljs-keyword">sql</span><br></code></pre></td></tr></table></figure></p><p><code>pg_dump dbname &gt; dumpfile</code></p><ul><li>原始指令：pg_dump 資料庫名稱 &gt; 匯出檔案名稱</li><li>參數意義：<br>  -h：host<br>  -U：user<br>  -p：port（註：專案未有設定port，所以不需要設定此參數）<blockquote><p>由於是在Server端要連線至資料庫（本文撰寫時採用GCP），所以需要特別輸入IP位址及User名稱，才能有權限讀取資料庫，並匯出sql檔案。</p></blockquote></li></ul><p>輸入完指令後，便會將 Porduction的資料庫檔案，匯出成sql檔。<br>接著要做的就是把這個新生成的檔案（production-20180612.sql），從Server拉到自己Local端</p><p>不過，通常資料庫都會越來越肥大，在拉到Local端之前要記得先用gzip壓縮一下哦。</p><h3 id="在Server上-gz-壓縮-越來越肥的資料庫"><a href="#在Server上-gz-壓縮-越來越肥的資料庫" class="headerlink" title="在Server上 gz 壓縮 | 越來越肥的資料庫"></a>在Server上 gz 壓縮 | 越來越肥的資料庫</h3><p>以下操作指令皆為在<code>Server</code>端輸入。</p><ol><li>將檔案壓縮成gz<br>解壓縮完便會還原成 production-20180612.sql<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">$ gzip production-<span class="hljs-number">20180612</span>.sql<br></code></pre></td></tr></table></figure></li><li>gz解壓縮指令<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">$ gunzip production-<span class="hljs-number">20180612</span>.sql.gz<br></code></pre></td></tr></table></figure></li></ol><h3 id="Remote-Server-下載-sql-到-Local端"><a href="#Remote-Server-下載-sql-到-Local端" class="headerlink" title="Remote Server 下載 sql 到 Local端"></a>Remote Server 下載 sql 到 Local端</h3><p>要如何從Server端直接下載檔案到本機電腦呢？<br>有幾種方式：curl、wget或是scp都可以。</p><ul><li>使用wget的話，需要將檔案放在server上的開放空間，且必須要是瀏覽器可以打開的網址，例如</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-variable">$</span> <span class="hljs-built_in">Wget</span> url<br><span class="hljs-built_in">wget</span> http://<span class="hljs-number">11.12</span>.<span class="hljs-number">200.205</span>:<span class="hljs-number">8000</span>/production<span class="hljs-literal">-20180612</span>.sql<br></code></pre></td></tr></table></figure><p>以下是採取<code>scp</code>方式<br>scp其實很好記，顧名思義：Server Copy，夠白話了吧XD</p><ul><li>指令格式<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gradle">scp user@server:<span class="hljs-regexp">/路徑/</span>你要<span class="hljs-regexp">/下載/</span>的檔案 ~<span class="hljs-regexp">/Desktop/</span>你要下載<span class="hljs-regexp">/到/</span>電腦<span class="hljs-regexp">/的哪個/</span>位置<br>scp hazelwu@<span class="hljs-number">11.12</span>.<span class="hljs-number">200.205</span>:<span class="hljs-regexp">/home/</span>hazelwu<span class="hljs-regexp">/test/</span>current<span class="hljs-regexp">/production-20180612.sql ~/</span>Desktop<span class="hljs-regexp">/github/</span>test_rails<br>## 這樣便會將production-<span class="hljs-number">20180612</span>.sql下載至desktop<span class="hljs-regexp">/github/</span>test_rails資料夾內。<br></code></pre></td></tr></table></figure><h4 id="你知道嗎？其實還能夠再簡化一點"><a href="#你知道嗎？其實還能夠再簡化一點" class="headerlink" title="你知道嗎？其實還能夠再簡化一點"></a>你知道嗎？其實還能夠再簡化一點</h4>指定你要下載的東西，在Commend Line上先移動到想要把檔案放的資料夾（例如/tmp），接著後面那串指令（表示本機位置）以<code>.</code>來取代就可以了，便會將檔案下載到<code>/tmp</code>內。<blockquote><p>建議可以直接放在專案內的tmp內，因為不會被commit進去、tmp主要都為放暫時性檔案使用。（通常gitinore有加入/tmp/*）</p></blockquote></li></ul><p>打以下的指令時，可以先在Command Line移動到你想要複製的目錄，後面就不用打一長串的東西囉</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-comment">### 簡化後的版本</span><br>[local端] cd tmp/<br>scp hazelwu<span class="hljs-variable">@11</span>.<span class="hljs-number">12.200</span>.<span class="hljs-number">205</span><span class="hljs-symbol">:/home/hazelwu/test/current/production-</span><span class="hljs-number">20180612</span>.sql .<br></code></pre></td></tr></table></figure><p>這樣即可將sql匯出來哩</p><h3 id="保個保險吧：攔截會發送給使用者的動作（Email"><a href="#保個保險吧：攔截會發送給使用者的動作（Email" class="headerlink" title="保個保險吧：攔截會發送給使用者的動作（Email)"></a>保個保險吧：攔截會發送給使用者的動作（Email)</h3><p>由於這些資料都非常真實，是來自真實使用者的資料，包含信箱手機等都為真的<br>所以不能真的做出通知使用者的行為，例如 E-Mail 寄送、簡訊認證碼送出等。</p><p>Rails 有提供 <code>register_interceptor</code>攔截 Email</p><ol><li>config/initializers/email.rb</li></ol><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-comment"># 新增 config/initializers/email.rb </span><br><span class="hljs-comment"># 在 Rails 啟動時，如果是非 production 環境就載入EmailInterceptor：</span><br><br><span class="hljs-keyword">unless</span> Rails.env.production?<br>  puts <span class="hljs-string">&quot;阻攔Email，將收件人皆改為test測試用信箱&quot;</span><br>  <span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;email_interceptor&#x27;</span><br>  ActionMailer::Base.register_interceptor(EmailInterceptor)<br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><ol start="2"><li>lib/email_interceptor.rb新增以下程式碼</li></ol><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs delphi">## 新增 lib/email_interceptor.rb 並且自訂條件：將收件人信箱皆改為測試用信箱<br><span class="hljs-keyword">class</span> EmailInterceptor<br>  def self.delivering_email(<span class="hljs-keyword">message</span>)<br>    <span class="hljs-keyword">message</span>.<span class="hljs-keyword">to</span> = [<span class="hljs-string">&#x27;test@example&#x27;</span>]<br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><h3 id="將-sql-匯出到-local端-develop-environment"><a href="#將-sql-匯出到-local端-develop-environment" class="headerlink" title="將 sql 匯出到 local端 / develop environment"></a>將 sql 匯出到 local端 / develop environment</h3><p>順利抓下Server端的資料後，也設上攔截機制了，接著可以匯入資料囉。</p><ul><li>匯出資料庫<br>pg_dump database_name &gt; backup.sql</li><li>匯入資料庫<br>psql db_name &lt; backup.sql</li></ul><p>還記得剛剛匯出的指令嗎？<br><code>pg_dump -h 11.12.200.205 -U hazelwu 123456 &gt; production-20180612.sql</code><br>接著要匯入的話，指令要這樣打<br><code>psql 123456 &lt; production-20180612.sql</code><br>輸入完之後，可以進入到Console.log試試看資料庫有沒有匯入成功</p><blockquote><p>有發現為什麼突然少那麼多參數嗎？</p><ul><li>原因<br>  由於目前環境是Local端，不需要填入帳號密碼等參數來藉由GCP連入資料庫了，我們只要指定檔案，匯入到本機的資料庫即可。預設是沒有輸入參數，他會抓當前的IP位置</li></ul></blockquote><ul><li>重整 Postgresql 匯入/匯出資料庫指令<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">匯出資料庫<br>psql project_development &lt; project_production<span class="hljs-number">-20180612.</span><span class="hljs-keyword">sql</span><br>匯入資料庫<br>psql project_development &lt; project_production.<span class="hljs-keyword">sql</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="實際操作時，遇到的問題："><a href="#實際操作時，遇到的問題：" class="headerlink" title="實際操作時，遇到的問題："></a>實際操作時，遇到的問題：</h3><h4 id="1-從Server端抓下來的User-data，欄位上並沒有實際的密碼，導致會失敗，User-Model做驗證：導致密碼效驗不能為空白，有什麼辦法可以自動化加上自設的密碼？"><a href="#1-從Server端抓下來的User-data，欄位上並沒有實際的密碼，導致會失敗，User-Model做驗證：導致密碼效驗不能為空白，有什麼辦法可以自動化加上自設的密碼？" class="headerlink" title="1. 從Server端抓下來的User data，欄位上並沒有實際的密碼，導致會失敗，User Model做驗證：導致密碼效驗不能為空白，有什麼辦法可以自動化加上自設的密碼？"></a>1. 從Server端抓下來的User data，欄位上並沒有實際的密碼，導致會失敗，User Model做驗證：導致密碼效驗不能為空白，有什麼辦法可以自動化加上自設的密碼？</h4><blockquote><p>在 Server端 用 Gem 產生資料檔 Seed，抓下來到Local端跑種子檔，<br>結果：無法與關聯資料庫對上，關聯id對不上去（如：user_id會對不上，找不到該User）</p></blockquote><p>資料格式類似如下<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs lua">User.<span class="hljs-built_in">create</span>!([<br>&#123;email: <span class="hljs-string">&quot;fduwsbxcbkdym4jzxn6b@gmail.com&quot;</span>, encrypted_password: <span class="hljs-string">&quot;zxkdfgjeute123ds&quot;</span>, reset_password_token: <span class="hljs-literal">nil</span>, reset_password_sent_at: <span class="hljs-literal">nil</span>, remember_created_at: <span class="hljs-literal">nil</span>&#125;<br></code></pre></td></tr></table></figure><br>第一次試著做時，是用<code>Gem &#39;seed_dump&#39;</code>在Server端上做，因屢次失敗的原因，後面便不採用seed_dump的做法了。轉移production資料到local，直接用postgresql指令直接拉，會比較快。</p><h4 id="2-在Rails-5-上重新刪除資料，並再建立一次，有辦法讓id重新從0開始跑嗎？"><a href="#2-在Rails-5-上重新刪除資料，並再建立一次，有辦法讓id重新從0開始跑嗎？" class="headerlink" title="2. 在Rails 5 上重新刪除資料，並再建立一次，有辦法讓id重新從0開始跑嗎？"></a>2. 在Rails 5 上重新刪除資料，並再建立一次，有辦法讓id重新從0開始跑嗎？</h4><p>將local端資料庫全部刪除，打算跑rails db:seed:users，將production轉移至local<br>但發現會對不上關聯資料庫的部分，因為重建立的user_id並不是從0開始，這該怎麼辦？</p><ul><li>刪除資料後，id會從0開始有下列幾個做法</li></ul><ol><li>TRUNCATE table <code>TABLE_NAME</code>; </li><li>DROP table <code>TABLE_NAME</code>;</li><li>rails db:drop</li></ol><ul><li><code>TRUNCATE</code> 與 <code>DROP</code> 兩者的差別在於<ul><li>前者是把資料欄位全部刪除；</li><li>後者 DROP 則是把整個 TABLE 刪除</li></ul></li></ul><h4 id="3-Server上操作postgresql時，準備匯出sql檔，發現Server的資料庫與專案上的資料庫版本不一致，導致無法順利匯出"><a href="#3-Server上操作postgresql時，準備匯出sql檔，發現Server的資料庫與專案上的資料庫版本不一致，導致無法順利匯出" class="headerlink" title="3. Server上操作postgresql時，準備匯出sql檔，發現Server的資料庫與專案上的資料庫版本不一致，導致無法順利匯出"></a>3. Server上操作postgresql時，準備匯出sql檔，發現Server的資料庫與專案上的資料庫版本不一致，導致無法順利匯出</h4><p>由於Server端的資料庫與專案上安裝的資料庫版本不符（一個為9.6版本、一個則是9.5版本），導致無法匯出</p><ul><li>一開始的嘗試：<br>先在Server上安裝相同版本的psql，但未能成功，仍還是舊版本QQ<br>搞版本總是很複雜又很麻煩，不過有一個比較快的方法是：</li></ul><p>在跑<code>pg_dump</code>指令時，prefix前面加上指定的版本，就能夠指定為9.6版本跑pg_dump的指令，而不是舊的版本（9.5)</p><ul><li>如何解決：<br>因此我們需要指定版本：<code>/usr/lib/postgresql/9.6/bin/pg_dump</code> 後面再加上原要接的參數，就可以輕鬆搞定版本問題啦！</li></ul><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"># 原本psql匯出指令<br>pg_dump -h <span class="hljs-number">11.12</span><span class="hljs-number">.200</span><span class="hljs-number">.205</span> -U hazelwu <span class="hljs-number">123456</span> &gt; production<span class="hljs-number">-20180612.</span><span class="hljs-keyword">sql</span> <br># 解決版本不一致 匯出指令<br>/usr/lib/postgresql/<span class="hljs-number">9.6</span>/bin/pg_dump -h <span class="hljs-number">11.12</span><span class="hljs-number">.200</span><span class="hljs-number">.205</span> -U hazelwu <span class="hljs-number">123456</span> &gt; production<span class="hljs-number">-20180612.</span><span class="hljs-keyword">sql</span> <br></code></pre></td></tr></table></figure><h3 id="Reference-參考資料"><a href="#Reference-參考資料" class="headerlink" title="Reference | 參考資料"></a>Reference | 參考資料</h3><ul><li><a href="http://osxdaily.com/2016/11/07/download-file-from-server-scp-ssh/">How to Download a File from a Server with SSH /SCP </a></li><li><a href="http://motion-express.com/blog/20141112-rails-test-db-seed">Rails 複製資料到 development環境</a></li><li><a href="https://www.postgresql.org/docs/10/static/backup-dump.html">Postgresql Dump</a></li><li>小蟹本人XD</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> scp server </tag>
            
            <tag> production data into local </tag>
            
            <tag> copy production data transfer to staging </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rails Server打不開嗎？你應該看看這篇</title>
      <link href="//Rails-Server%E6%89%93%E4%B8%8D%E9%96%8B%E5%97%8E%EF%BC%9F%E4%BD%A0%E6%87%89%E8%A9%B2%E7%9C%8B%E7%9C%8B%E9%80%99%E7%AF%87/"/>
      <url>//Rails-Server%E6%89%93%E4%B8%8D%E9%96%8B%E5%97%8E%EF%BC%9F%E4%BD%A0%E6%87%89%E8%A9%B2%E7%9C%8B%E7%9C%8B%E9%80%99%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<p>明明Ruby Server已經關閉了，但重新輸入rails server 出現錯誤訊息：Server已經打開了<br>過去常遇到此問題，我都是直接重開機。後來仔細查詳解，發現有更快的解決方法。</p><h3 id="出現的錯誤訊息"><a href="#出現的錯誤訊息" class="headerlink" title="出現的錯誤訊息"></a>出現的錯誤訊息</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">A server is already running. Check <span class="hljs-regexp">/Users/</span>hazelwu<span class="hljs-regexp">/Desktop/gi</span>thub<span class="hljs-regexp">/project/</span>tmp<span class="hljs-regexp">/pids/</span>server.pid.<br></code></pre></td></tr></table></figure><h3 id="除了重開機以外，你還有更好的選擇！"><a href="#除了重開機以外，你還有更好的選擇！" class="headerlink" title="除了重開機以外，你還有更好的選擇！"></a>除了重開機以外，你還有更好的選擇！</h3><h4 id="先查出使用的port有什麼應用程式執行"><a href="#先查出使用的port有什麼應用程式執行" class="headerlink" title="先查出使用的port有什麼應用程式執行"></a>先查出使用的port有什麼應用程式執行</h4><p>首先要先知道你的Rails Server上一次關閉前是使用哪個port上<br>預設輸入<code>rails s</code>皆為設定port為3000。<br>例如：<code>localhost:3000</code><br>3001可以更改為預設的3000，或是看你的server開在哪個port上</p><p>在Iterm/commend上輸入下列指令，可以查出3001的port被哪些應用程式開啟。<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">lsof</span> -i tcp:<span class="hljs-number">3001</span><br></code></pre></td></tr></table></figure></p><p><a href="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/05/22001433/Screen-Shot-2018-05-22-at-12.07.15-AM.png"><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/05/22001433/Screen-Shot-2018-05-22-at-12.07.15-AM-1024x158.png" alt=""></a><br>上圖中可以明顯看到佔用電腦3001的port有<code>ruby</code>及<code>ngrok</code><br>而ruby對應的PID是809</p><h4 id="殺掉Ruby對應的PID，強迫關閉"><a href="#殺掉Ruby對應的PID，強迫關閉" class="headerlink" title="殺掉Ruby對應的PID，強迫關閉"></a>殺掉Ruby對應的PID，強迫關閉</h4><p>此刻輸入</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">kill</span> -<span class="hljs-number">9</span> <span class="hljs-number">809</span><br></code></pre></td></tr></table></figure><p>就可以成功將佔用port:3001的Rails Server關閉<br>重新在command上輸入<code>rails s -p 3001</code>即可順利開啟localhost:3001囉</p><h4 id="補充：在Cmd如何關閉-Rails-Server"><a href="#補充：在Cmd如何關閉-Rails-Server" class="headerlink" title="補充：在Cmd如何關閉 Rails Server"></a>補充：在Cmd如何關閉 Rails Server</h4><p>除了<code>Ctrl+C</code>可以關掉rails server外，如果不小心進入無窮迴圈，用Ctrl+C沒有作用，還有另一種方法：<code>Ctrl+Z</code></p><ol><li><code>Ctrl+C / Cmd + C</code></li><li><code>Ctrl+Z / Cmd + Z</code></li></ol><h3 id="Reference-參考資料"><a href="#Reference-參考資料" class="headerlink" title="Reference | 參考資料"></a>Reference | 參考資料</h3><ul><li><a href="https://stackoverflow.com/questions/15088163/cant-stop-rails-server">Can’t stop rails server</a><a href="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/05/22001433/Screen-Shot-2018-05-22-at-12.07.15-AM.png"><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/05/22001433/Screen-Shot-2018-05-22-at-12.07.15-AM-1024x158.png" alt=""></a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Rails 5 </tag>
            
            <tag> close rails server </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>遠端ssh連到Server，無法進入Staging Rails Console的終極解決辦法：移除bin</title>
      <link href="//%E9%81%A0%E7%AB%AFssh%E9%80%A3%E5%88%B0Server%EF%BC%8C%E7%84%A1%E6%B3%95%E9%80%B2%E5%85%A5Staging-Rails-Console%E7%9A%84%E7%B5%82%E6%A5%B5%E8%A7%A3%E6%B1%BA%E8%BE%A6%E6%B3%95%EF%BC%9A%E7%A7%BB%E9%99%A4bin/"/>
      <url>//%E9%81%A0%E7%AB%AFssh%E9%80%A3%E5%88%B0Server%EF%BC%8C%E7%84%A1%E6%B3%95%E9%80%B2%E5%85%A5Staging-Rails-Console%E7%9A%84%E7%B5%82%E6%A5%B5%E8%A7%A3%E6%B1%BA%E8%BE%A6%E6%B3%95%EF%BC%9A%E7%A7%BB%E9%99%A4bin/</url>
      
        <content type="html"><![CDATA[<h2 id="情境："><a href="#情境：" class="headerlink" title="情境："></a>情境：</h2><p>當用ssh遠端連線至server時，要進入專案內的rails console.log，出現rails new [options]，找不到rails project的目錄，紀錄如何解決的筆記。</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">ssh <span class="hljs-keyword">deploy</span>@xxx.xxx.xxx.xxx<br><span class="hljs-keyword">cd</span> ~<span class="hljs-string">/project/current</span><br>bundle exec rails c staging<br></code></pre></td></tr></table></figure><p>遠端連線至server時，想進去看log訊息，卻出現下圖的錯誤訊息<br><a href="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/04/30233930/14810cce-8bee-4d40-b4de-c877c1371eff.png"><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/04/30233930/14810cce-8bee-4d40-b4de-c877c1371eff.png" alt=""></a></p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gradle">rails <span class="hljs-keyword">new</span> APP_PATH [<span class="hljs-keyword">options</span>]<br>....以下略<br></code></pre></td></tr></table></figure><h2 id="解決辦法"><a href="#解決辦法" class="headerlink" title="解決辦法"></a>解決辦法</h2><p>專案是用capistrano 1.3.1 版本部署</p><ol><li>在local端用力打開 config/deploy.rb</li><li>找到linked_dirs，然後把bin吃掉</li><li>重新推上github上</li><li>重新部署一次</li><li>試試看，重新遠端ssh連線，就可以進入staging console囉</li></ol><h3 id="原始config-deploy-rb檔案設定"><a href="#原始config-deploy-rb檔案設定" class="headerlink" title="原始config/deploy.rb檔案設定"></a>原始config/deploy.rb檔案設定</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">set :linked_dirs, %w&#123;bin log tmp<span class="hljs-regexp">/pids tmp/</span>cache tmp<span class="hljs-regexp">/sockets vendor/</span>bundle <span class="hljs-keyword">public</span><span class="hljs-regexp">/uploads public/</span>assets&#125;<br></code></pre></td></tr></table></figure><h3 id="移除bin設定"><a href="#移除bin設定" class="headerlink" title="移除bin設定"></a>移除bin設定</h3><p>要移除bin，所以會變成下列的程式碼<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">set :linked_dirs, %w&#123;log tmp<span class="hljs-regexp">/pids tmp/</span>cache tmp<span class="hljs-regexp">/sockets vendor/</span>bundle <span class="hljs-keyword">public</span><span class="hljs-regexp">/uploads public/</span>assets&#125;<br></code></pre></td></tr></table></figure><br>接著，重新推到github repo上<br>重開staging伺服器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cap</span> staging deploy:restart<br></code></pre></td></tr></table></figure><p>大概有九成可以解決問題XD</p><h2 id="Reference-參考資料"><a href="#Reference-參考資料" class="headerlink" title="Reference | 參考資料"></a>Reference | 參考資料</h2><ul><li><a href="https://stackoverflow.com/questions/31629983/rails-console-command-not-working">rails console command not working</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> rails server </tag>
            
            <tag> Rails 5 </tag>
            
            <tag> ssh </tag>
            
            <tag> console </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rails 與 Webpacker 神奇的結合：用image-wepback-loader 來壓縮圖片</title>
      <link href="//Rails-%E8%88%87-Webpacker-%E7%A5%9E%E5%A5%87%E7%9A%84%E7%B5%90%E5%90%88%EF%BC%9A%E7%94%A8image-wepback-loader-%E4%BE%86%E5%A3%93%E7%B8%AE%E5%9C%96%E7%89%87/"/>
      <url>//Rails-%E8%88%87-Webpacker-%E7%A5%9E%E5%A5%87%E7%9A%84%E7%B5%90%E5%90%88%EF%BC%9A%E7%94%A8image-wepback-loader-%E4%BE%86%E5%A3%93%E7%B8%AE%E5%9C%96%E7%89%87/</url>
      
        <content type="html"><![CDATA[<h2 id="Gem-Webpacker-特色"><a href="#Gem-Webpacker-特色" class="headerlink" title="Gem Webpacker 特色"></a>Gem Webpacker 特色</h2><blockquote><p>Webpacker是一個Gem，即使不用裝webpack，也能在Rails上編譯，然後也拿掉原生使用的Srocket。<br>Webpacker使用的是webpack 3.x.x版本，他已經預設幫你安裝了幾件事，但你需要另外設定檔</p></blockquote><ul><li>用babel 將ES6 編譯成 ES5</li><li>在webpack.yml上即可輕鬆設定好entry（入口）、output（出口）</li><li>PostCSS，加入前綴詞</li><li>CDN 支援</li><li>前端框架（React、Agnular、Elm、Vue）支援</li><li>內建 Rails view的helper</li></ul><blockquote><p>像用babel轉成ES5、PostCSS加前綴詞，只需要在專案上加入<code>.babelrc</code>、<code>postcss.config.js</code>做設定即可，當然package.json也需要安裝相關的套件才能跑</p></blockquote><p>這邊不暫述怎麼在 Rails 5 初始化webapcker的設定，只介紹怎麼載入loader</p><ol><li>先讓webpacker能讀取設定路徑內，所有的圖片</li><li>再讓webpacker載入loader</li></ol><h2 id="安裝及設定"><a href="#安裝及設定" class="headerlink" title="安裝及設定"></a>安裝及設定</h2><h3 id="webpacker-yml設定entry、output"><a href="#webpacker-yml設定entry、output" class="headerlink" title="webpacker.yml設定entry、output"></a>webpacker.yml設定entry、output</h3><p>我個人設定是把所有image、js、css檔都放在app/frontend下<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">default:</span> <span class="hljs-variable">&amp;default</span><br><span class="hljs-symbol">  source_path:</span> app/frontend<br><span class="hljs-symbol">  source_entry_path:</span> packs<br><span class="hljs-symbol">  public_output_path:</span> packs<br><span class="hljs-symbol">  cache_path:</span> tmp<span class="hljs-meta-keyword">/cache/</span>webpacker<br></code></pre></td></tr></table></figure></p><h3 id="frontend-application-js-先載入所有圖片設定"><a href="#frontend-application-js-先載入所有圖片設定" class="headerlink" title="frontend/application.js 先載入所有圖片設定"></a>frontend/application.js 先載入所有圖片設定</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gradle"># app<span class="hljs-regexp">/frontend/</span>application.js<br>require.context(<span class="hljs-string">&#x27;../images/&#x27;</span>, <span class="hljs-keyword">true</span>, <span class="hljs-regexp">/\.(gif|jpg|png|svg)$/i</span>);<br>require.context(<span class="hljs-string">&#x27;../styles/&#x27;</span>, <span class="hljs-keyword">true</span>, <span class="hljs-regexp">/^\.\/[^_].*\.(css|scss|sass)$/i</span>);<br></code></pre></td></tr></table></figure><p>Webpacker這個Gem，他已經預先使用<code>CSS loader</code>、<code>Sass loader</code>了<br>這項設定會使你專案內（app/frontend）的圖片、CSS等，都會被載入</p><p>在安裝webpacker時，他也會預先幫你設好目錄，在config/webpack檔案分別有<code>development.js</code>、<code>environment.js</code>、<code>production.js</code>。</p><h3 id="安裝image-webpack-loader"><a href="#安裝image-webpack-loader" class="headerlink" title="安裝image-webpack-loader"></a>安裝image-webpack-loader</h3><p>圖片壓縮須先安裝image-webpack-loader，我們將透過npm來安裝這個loader。<br>輸入 <code>npm install image-webpack-loader</code></p><h3 id="載入image-webpack-loader"><a href="#載入image-webpack-loader" class="headerlink" title="載入image-webpack-loader"></a>載入image-webpack-loader</h3><p>確認安裝完後，我們便來開始設定：載入image-webpack-loader<br>在<code>config/webpack/environment.js</code>下設定，options可以客製化，可以找image-webpack-loader的官方文件看更詳細的設置教學。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># config/webpack/environment.js</span><br><span class="hljs-string">environment.loaders.append(&#x27;image&#x27;,</span> &#123;<br>  <span class="hljs-attr">test:</span> <span class="hljs-string">/\.(gif|png|jpe?g|svg)$/i</span>,<br>  <span class="hljs-attr">loader:</span> <span class="hljs-string">&#x27;image-webpack-loader&#x27;</span>,<br>  <span class="hljs-attr">options:</span> &#123;<br>    <span class="hljs-attr">mozjpeg:</span> &#123;<br>      <span class="hljs-attr">progressive:</span> <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">quality:</span> <span class="hljs-number">65</span><br>    &#125;,<br>    <span class="hljs-string">//</span> <span class="hljs-attr">optipng.enabled:</span> <span class="hljs-literal">false</span> <span class="hljs-string">will</span> <span class="hljs-string">disable</span> <span class="hljs-string">optipng</span><br>    <span class="hljs-attr">optipng:</span> &#123;<br>      <span class="hljs-attr">enabled:</span> <span class="hljs-literal">false</span><br>    &#125;,<br>    <span class="hljs-attr">pngquant:</span> &#123;<br>      <span class="hljs-attr">quality:</span> <span class="hljs-string">&#x27;65-90&#x27;</span>,<br>      <span class="hljs-attr">speed:</span> <span class="hljs-number">4</span><br>    &#125;,<br>    <span class="hljs-attr">gifsicle:</span> &#123;<br>      <span class="hljs-attr">interlaced:</span> <span class="hljs-literal">false</span><br>    &#125;,<br>    <span class="hljs-string">//</span> <span class="hljs-string">the</span> <span class="hljs-string">webp</span> <span class="hljs-string">option</span> <span class="hljs-string">will</span> <span class="hljs-string">enable</span> <span class="hljs-string">WEBP</span><br>    <span class="hljs-attr">webp:</span> &#123;<br>      <span class="hljs-attr">quality:</span> <span class="hljs-number">75</span><br>    &#125;<br>  &#125;<br>&#125;<span class="hljs-string">);</span><br></code></pre></td></tr></table></figure><h3 id="重新編譯-Webpacker"><a href="#重新編譯-Webpacker" class="headerlink" title="重新編譯 Webpacker"></a>重新編譯 Webpacker</h3><p>以上皆完成後，在cmd輸入以下指令，做重新編譯的動作<br><code>webpack -w</code>或<code>ruby ./bin/webpack-dev-server</code><br>你就會發現，圖片被壓縮了！！（撒花）</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://github.com/rails/webpacker">Webpacker官方文件</a></li><li><a href="https://hk.saowen.com/a/1650bf12d731afabf95a8bfa2cd885ddd944aa5e4e067aa75eb0ee5c2c75fcfe">基於 Webpack 引入公共庫的幾種方式</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Rails 5 </tag>
            
            <tag> Rails with Webpacker </tag>
            
            <tag> image compress </tag>
            
            <tag> image-webpack-loader </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rails Server 無法連結 Postgresql，出現s.PGSQL.5432 ERROR，解決辦法</title>
      <link href="//Mac-%E5%AE%89%E8%A3%9Dpostgresql%E5%BE%8C%E7%84%A1%E6%B3%95%E9%80%A3%E7%B5%90Rails-Server%EF%BC%8C%E5%87%BA%E7%8F%BEs-PGSQL-5432-ERROR%EF%BC%8C%E9%80%99%E5%A4%A9%E6%AE%BA%E7%9A%84%E8%A8%8A%E6%81%AF%EF%BC%81/"/>
      <url>//Mac-%E5%AE%89%E8%A3%9Dpostgresql%E5%BE%8C%E7%84%A1%E6%B3%95%E9%80%A3%E7%B5%90Rails-Server%EF%BC%8C%E5%87%BA%E7%8F%BEs-PGSQL-5432-ERROR%EF%BC%8C%E9%80%99%E5%A4%A9%E6%AE%BA%E7%9A%84%E8%A8%8A%E6%81%AF%EF%BC%81/</url>
      
        <content type="html"><![CDATA[<h3 id="s-PGSQL-5432是蝦咪挖溝？"><a href="#s-PGSQL-5432是蝦咪挖溝？" class="headerlink" title="s.PGSQL.5432是蝦咪挖溝？"></a>s.PGSQL.5432是蝦咪挖溝？</h3><p>紀錄在 Mac 跑Rails Server時使用PG資料庫，出現s.PGSQL.5432 ERROR，我是如何解決的。<br>這次遇到的狀況是要跑<code>rails db:migrate</code>時出現錯誤訊息，追根究底時發現有可能原因是出自於psql資料庫，於是在終端機輸入<code>psql</code>出現ERROR訊息：<br>RUN版本：<code>postgresql 10.3</code></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">psql: could <span class="hljs-keyword">not</span> <span class="hljs-keyword">connect</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">server</span>: <span class="hljs-keyword">No</span> such file <span class="hljs-keyword">or</span> directory<br>    <span class="hljs-keyword">Is</span> the <span class="hljs-keyword">server</span> running locally <span class="hljs-keyword">and</span> accepting<br>    connections <span class="hljs-keyword">on</span> Unix <span class="hljs-keyword">domain</span> socket &quot;/var/pgsql_socket/.s.PGSQL.5432&quot;?<br></code></pre></td></tr></table></figure><p>上述錯誤訊息是在說：現在開啟的Rails Server沒有與本機的psql資料庫連線，你要不要再確認一下？</p><p>造成此原因有很多種，但最白癡的原因莫過於本端沒有打開psql服務</p><blockquote><p>若你也有出現此錯誤訊息，可以先測試看看是不是根本沒有打開psql服務，若仍無法排除，再嘗試重新裝載psql。<br><code>$ pg_ctl -D /usr/local/var/postgres start</code></p></blockquote><h2 id="解決良藥"><a href="#解決良藥" class="headerlink" title="解決良藥"></a>解決良藥</h2><h3 id="1-本機開啟psql的服務"><a href="#1-本機開啟psql的服務" class="headerlink" title="1. 本機開啟psql的服務"></a>1. 本機開啟psql的服務</h3><p>如果psql本身被關閉的話，輸入以下指令便會告知你psql服務被打開囉。<br>Mac若重新開機的話，psql服務會自動被關閉，通常遇到無法連線local psql時輸入此指令皆可解決。<br><code>$ pg_ctl -D /usr/local/var/postgres start</code></p><h3 id="2-重新裝載psql"><a href="#2-重新裝載psql" class="headerlink" title="2. 重新裝載psql"></a>2. 重新裝載psql</h3><p>如果本機確認有打開psql服務的話，仍無法排除狀況，那就重新裝載psql吧QQ。</p><ul><li>先移除前一個版本Postgresql<br><code>$ brew uninstall --force postgresql</code></li><li>確保有刪除乾淨，再次手動刪除<br><code>$ rm -rf /usr/local/var/postgres</code></li><li>用Homebrew 安裝 Postgres<br><code>$ brew install postgres</code><br>開啟PostgreSQL的Server，在終端機輸入：<br><code>$ pg_ctl -D /usr/local/var/postgres start</code></li><li>建立資料庫<br><code>$ initdb /usr/local/var/postgres</code><br>或是直接在Rails專案建立資料庫<br><code>$ rails db:create</code></li></ul><h3 id="備份資料庫"><a href="#備份資料庫" class="headerlink" title="備份資料庫"></a>備份資料庫</h3><p>如果local端有舊的資料庫，也並不打算轉移的話…<br>刪除舊有資料庫<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">rm -r <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/var/</span>postgres<br></code></pre></td></tr></table></figure></p><p>重新建立一個新的<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">initdb <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/var/</span>postgres<br></code></pre></td></tr></table></figure><br>新建新的資料庫<br><code>createdb 資料庫名稱</code></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://medium.com/@Umesh_Kafle/postgresql-and-postgis-installation-in-mac-os-87fa98a6814d">PostgreSQL and PostGIS installation in Mac OS.</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> rails server </tag>
            
            <tag> s.PGSQL.5432 </tag>
            
            <tag> Rails 5 </tag>
            
            <tag> psql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>幫 Rails 建立一個 Docker Container吧</title>
      <link href="//%E5%B9%AB-Rails-%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B-Docker-Container%E5%90%A7/"/>
      <url>//%E5%B9%AB-Rails-%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B-Docker-Container%E5%90%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="幫-Rails-建立一個-Docker-Container吧"><a href="#幫-Rails-建立一個-Docker-Container吧" class="headerlink" title="幫 Rails 建立一個 Docker Container吧"></a>幫 Rails 建立一個 Docker Container吧</h1><blockquote><h2 id="為什麼你要使用Docker？"><a href="#為什麼你要使用Docker？" class="headerlink" title="為什麼你要使用Docker？"></a>為什麼你要使用Docker？</h2><p>Docker最重要的價值是：有效解決環境配置、衝突的問題<br>可以在一台機器上跑，就可以在所有的機器上跑。<br>如果有問題的話，就會是大家的問題，大家一起解決XD</p></blockquote><p>docker是建立一個container新的環境，有助於不會因為不同作業系統(Mac, Linux)導致無法在本端跑環境<br>你不用因為不小心升級了npm的webpack等等……..架不起來環境<br>最後電腦整個砍掉重灌之類的……….相信我你會很想死一千遍QQ。</p><h2 id="Mac-教學"><a href="#Mac-教學" class="headerlink" title="Mac 教學"></a>Mac 教學</h2><p>請先安裝 Docker，在Mac環境下安裝Docker非常簡單，只要安裝UI軟體即可XD。<br>Mac 安裝 Docker = &gt;<a href="https://docs.docker.com/docker-for-mac/install/">請點我下載</a></p><p>安裝完後，我們先以建立一個新專案來跑Docker</p><h3 id="建立新專案"><a href="#建立新專案" class="headerlink" title="建立新專案"></a>建立新專案</h3><p>首先建立一個新的資料夾，並且先手動建立四個檔案<br><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">cd</span> desktop<br><span class="hljs-built_in">mkdir</span> docker<br><span class="hljs-built_in">cd</span> <span class="hljs-built_in">mkdir</span><br>touch Gemfile.lock<br>touch Gemfile<br>touch docker-compose.yml<br>touch Dockerfile<br></code></pre></td></tr></table></figure></p><h3 id="手動填上設定"><a href="#手動填上設定" class="headerlink" title="手動填上設定"></a>手動填上設定</h3><p>docker_1可以手動改成自己的專案名稱，ruby版本可以自由更改，撰寫此篇文章時是<code>Ruby 2.5.0</code>版本<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># Dockerfile</span><br><span class="hljs-keyword">FROM</span> ruby:2.5.0<br><span class="hljs-builtin-name">RUN</span> apt-<span class="hljs-builtin-name">get</span> update -qq &amp;&amp; apt-<span class="hljs-builtin-name">get</span> install -y build-essential libpq-dev nodejs<br><span class="hljs-builtin-name">RUN</span> mkdir /docker_1<br>WORKDIR /docker_1<br><span class="hljs-builtin-name">ADD</span> Gemfile /docker_1/Gemfile<br><span class="hljs-builtin-name">ADD</span> Gemfile.lock /docker_1/Gemfile.lock<br><span class="hljs-builtin-name">RUN</span> bundle install<br><span class="hljs-builtin-name">ADD</span> . /docker_1<br></code></pre></td></tr></table></figure></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># Docker-compose.yml</span><br><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;2&#x27;</span><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">db:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">postgres</span><br>  <span class="hljs-attr">web:</span><br>    <span class="hljs-attr">build:</span> <span class="hljs-string">.</span><br>    <span class="hljs-attr">command:</span> <span class="hljs-string">bundle</span> <span class="hljs-string">exec</span> <span class="hljs-string">rails</span> <span class="hljs-string">s</span> <span class="hljs-string">-p</span> <span class="hljs-number">3000</span> <span class="hljs-string">-b</span> <span class="hljs-string">&#x27;0.0.0.0&#x27;</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">.:/docker_1</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3000:3000&quot;</span><br>    <span class="hljs-attr">depends_on:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">db</span><br></code></pre></td></tr></table></figure><p>Gemfile最簡單，只要輸入兩行即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Gemfile</span><br><span class="hljs-built_in">source</span> <span class="hljs-string">&#x27;https://rubygems.org&#x27;</span><br>gem <span class="hljs-string">&#x27;rails&#x27;</span>, <span class="hljs-string">&#x27;~&gt; 5.1.6&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="docker-compose-yml-用途"><a href="#docker-compose-yml-用途" class="headerlink" title="docker-compose.yml 用途"></a>docker-compose.yml 用途</h3><p>docker-compose.yml的用途</p><ol><li>web container</li><li>database constainer</li></ol><h3 id="設定完成，跑指令！"><a href="#設定完成，跑指令！" class="headerlink" title="設定完成，跑指令！"></a>設定完成，跑指令！</h3><p>設置好檔案後，開始跑指令吧</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">docker-compose <span class="hljs-builtin-name">run</span> web rails new --force <span class="hljs-attribute">--database</span>=postgresql<br></code></pre></td></tr></table></figure><p>這個指令輸入後，會自動建立一個容器，裝著新的rails 專案，<br>Dockerfile會將專案內的Gemfile複製到docker container上，並且自動執行bundle install。<br>還記得我們剛剛在新增Gemfile添加內容時，只安裝了Rails的Gem</p><p>database的username則設定為：postgresql</p><p>完整跑完指令後，會發現專案資料夾已經設置好Rails框架了，像是db, assets等等</p><h3 id="設置database的username"><a href="#設置database的username" class="headerlink" title="設置database的username"></a>設置database的username</h3><p>接著來database.yml檔，因為剛剛輸入的指令設定database username是postgresql<br>因此資料庫的yml檔必須也添加上去，添加<code>username</code>、<code>password</code>、<code>host</code></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">default:</span> <span class="hljs-variable">&amp;default</span><br><span class="hljs-symbol">  adapter:</span> postgresql<br><span class="hljs-symbol">  encoding:</span> unicode<br>  <span class="hljs-meta"># For details on connection pooling, see Rails configuration guide</span><br>  <span class="hljs-meta"># http:<span class="hljs-comment">//guides.rubyonrails.org/configuring.html#database-pooling</span></span><br><span class="hljs-symbol">  pool:</span> <span class="hljs-params">&lt;%= ENV.fetch(&quot;RAILS_MAX_THREADS&quot;) &#123; <span class="hljs-number">5</span> &#125; %&gt;</span><br><span class="hljs-symbol">  username:</span> postgres<br><span class="hljs-symbol">  password:</span><br><span class="hljs-symbol">  host:</span> db<br></code></pre></td></tr></table></figure><h3 id="架設環境吧！"><a href="#架設環境吧！" class="headerlink" title="架設環境吧！"></a>架設環境吧！</h3><p>docker-compose up 的指令等同於 rails s，只是是遠端操作docker，那port設定是在3000<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">docker-compose up</span> <br></code></pre></td></tr></table></figure><br>如果設置檔案過程都順利、正常的話，輸入<code>localhost:3000</code>即會看到Rails 架設成功的畫面惹。<br><a href="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/04/08232903/Screen-Shot-2018-04-08-at-10.51.52-PM.png"><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/04/08232903/Screen-Shot-2018-04-08-at-10.51.52-PM.png" alt=""></a><br>恭喜你，看到這個畫面時，也代表進入Docker的大坑了（誤）</p><h2 id="Docker-指令介紹"><a href="#Docker-指令介紹" class="headerlink" title="Docker 指令介紹"></a>Docker 指令介紹</h2><p>當你在Gemfile 有變動時，都要重跑bundle，那在docker上則是輸入docker-compose build<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">docker-compose build</span><br></code></pre></td></tr></table></figure><br>跑任何Rails指令前都必須加上<code>docker-compose run web</code><br>例如：想要跑rails db:migrate 遷移資料庫指令時前面也要加上此行</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">docker-compose <span class="hljs-builtin-name">run</span> web rails db:migrate<br></code></pre></td></tr></table></figure><ul><li><p>開啟伺服器 localhost:3000<br><code>docker-compose up</code></p></li><li><p>關閉伺服器<br><code>docker-compose down</code></p></li><li>進入Docker rails console<br><code>docker-compose rails c</code><h2 id="Docker-一次滿足你三個願望"><a href="#Docker-一次滿足你三個願望" class="headerlink" title="Docker 一次滿足你三個願望"></a>Docker 一次滿足你三個願望</h2>不管你想要安裝Yarn, Node.js還是 Webpacker, 前端Framework都沒有問題唷</li></ul><h3 id="想在Docker上安裝yarn、Node-js？沒問題"><a href="#想在Docker上安裝yarn、Node-js？沒問題" class="headerlink" title="想在Docker上安裝yarn、Node.js？沒問題"></a>想在Docker上安裝yarn、Node.js？沒問題</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vim">RUN apt-<span class="hljs-built_in">get</span> <span class="hljs-keyword">update</span> &amp;&amp; apt-<span class="hljs-built_in">get</span> install -<span class="hljs-keyword">y</span> curl apt-transport-https wget &amp;&amp; \<br>    curl -sS http<span class="hljs-variable">s:</span>//<span class="hljs-keyword">dl</span>.yarnpkg.<span class="hljs-keyword">com</span>/debian/pubkey.gpg | apt-key <span class="hljs-built_in">add</span> - &amp;&amp; \<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;deb https://dl.yarnpkg.com/debian/ stable main&quot;</span> | tee /etc/apt/sources.<span class="hljs-keyword">list</span>.d/yarn.<span class="hljs-keyword">list</span> &amp;&amp; \<br>    apt-<span class="hljs-built_in">get</span> <span class="hljs-keyword">update</span> &amp;&amp; apt-<span class="hljs-built_in">get</span> install -<span class="hljs-keyword">y</span> yarn<br>RUN curl -sL http<span class="hljs-variable">s:</span>//<span class="hljs-keyword">deb</span>.nodesource.<span class="hljs-keyword">com</span>/setup_7.<span class="hljs-keyword">x</span> | bash - &amp;&amp; \<br>    apt-<span class="hljs-built_in">get</span> install nodejs<br></code></pre></td></tr></table></figure><h3 id="Docker-安裝-Webpacker？沒問題"><a href="#Docker-安裝-Webpacker？沒問題" class="headerlink" title="Docker 安裝 Webpacker？沒問題"></a>Docker 安裝 Webpacker？沒問題</h3><p>Docker container上加入<code>webpacker</code>？沒問題啊！<br>在Gemfile上添加<code>webpacker</code></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">gem</span> <span class="hljs-string">&#x27;webpacker&#x27;</span>, <span class="hljs-string">&#x27;~&gt; 3.4&#x27;</span><br></code></pre></td></tr></table></figure><p>接著重新Run一次以下指令</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">docker-compose run web bundle <span class="hljs-keyword">update</span><br>docker-compose <span class="hljs-keyword">build</span><br></code></pre></td></tr></table></figure><h3 id="Docker上導入React-framework？沒問題！"><a href="#Docker上導入React-framework？沒問題！" class="headerlink" title="Docker上導入React framework？沒問題！"></a>Docker上導入React framework？沒問題！</h3><p>docker-compose run web rails webpack:install:react<br>你有發現到嗎？其實安裝webpacker指令在rails上也是輸入rails webpack:install<br>只是前面多加了<code>docker-compose run web</code>而已<br>不要被長長的指令嚇到了Q_Q</p><h3 id="用-Alias-縮短docker指令"><a href="#用-Alias-縮短docker指令" class="headerlink" title="用 Alias 縮短docker指令"></a>用 Alias 縮短docker指令</h3><p>覺得每次都要輸入這史上超長的指令，很浪費人生、手指力氣吧<br>你想想看，我今天想在docker上新增一個container，我要這樣子輸入<br><code>docker-compose run web rails controller -g home</code><br>超級無敵霹靂有夠長的好不好！</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim ~/.bashrc<br><span class="hljs-built_in">alias</span> dc-web=<span class="hljs-string">&#x27;docker-compose run web&#x27;</span><br><span class="hljs-built_in">alias</span> dc-migrate=<span class="hljs-string">&#x27;docker-compose run web rails db:migrate&#x27;</span><br><span class="hljs-built_in">alias</span> dc-rspec=<span class="hljs-string">&#x27;docker-compose run web rspec&#x27;</span><br><span class="hljs-built_in">alias</span> dc=<span class="hljs-string">&#x27;docker-compose&#x27;</span><br></code></pre></td></tr></table></figure><p>以後在終端機上就可以簡單輸入<code>dc-web</code>這些囉<br>也可以自行設定你常用的指令。</p>]]></content>
      
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> Rails 5 </tag>
            
            <tag> webpacker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端永遠的課題：字體－呈現一致性的跨裝置</title>
      <link href="//%E5%89%8D%E7%AB%AF%E6%B0%B8%E9%81%A0%E7%9A%84%E8%AA%B2%E9%A1%8C%EF%BC%9A%E5%91%88%E7%8F%BE%E4%B8%80%E8%87%B4%E6%80%A7%E7%9A%84%E8%B7%A8%E8%A3%9D%E7%BD%AE%EF%BC%9A%E9%97%9C%E6%96%BCFont/"/>
      <url>//%E5%89%8D%E7%AB%AF%E6%B0%B8%E9%81%A0%E7%9A%84%E8%AA%B2%E9%A1%8C%EF%BC%9A%E5%91%88%E7%8F%BE%E4%B8%80%E8%87%B4%E6%80%A7%E7%9A%84%E8%B7%A8%E8%A3%9D%E7%BD%AE%EF%BC%9A%E9%97%9C%E6%96%BCFont/</url>
      
        <content type="html"><![CDATA[<p>前端最主要就是將所有裝置能一致化顯示，今天來談談「字體」的部分<br>大家都知道Windows, Linux, Mac三大作業系統，想當然也有其系統的內建字體，若只指定常見的微軟正黑體，其他作業系統沒有該字體，就會顯示該作業系統的預設字體，而不是微軟正黑體，這樣就沒有超能力隨心所欲控制字體了，這怎麼行！<br>身為一位專業的前端工程師，是有必要了解網頁字體的，Okay, Let’s go.</p><blockquote><p>要能隨自己心念呈現想要的字體，首先要先理解「字體擺放的順序」，順序超重要的啊</p></blockquote><h2 id="字體通用順序"><a href="#字體通用順序" class="headerlink" title="字體通用順序"></a>字體通用順序</h2><p>英文字型 &gt; Linux系統 &gt; Mac系統 &gt; Windows &gt; 基礎字體</p><h3 id="設定-font-family-到底是中文在前面、還是英文啊？"><a href="#設定-font-family-到底是中文在前面、還是英文啊？" class="headerlink" title="設定 font-family 到底是中文在前面、還是英文啊？"></a>設定 font-family 到底是中文在前面、還是英文啊？</h3><blockquote><p>英文字型在前，中文字型在後</p></blockquote><p>如果中文字型在前，那麼網頁會永遠讀取不到Arial的字體，正確示範應為以下設定<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">font-family</span>: <span class="hljs-string">&quot;Arial&quot;</span>, <span class="hljs-string">&quot;微軟正黑體&quot;</span><br></code></pre></td></tr></table></figure></p><h2 id="使用機率較少的字體放前，使用機率高的字體放後"><a href="#使用機率較少的字體放前，使用機率高的字體放後" class="headerlink" title="使用機率較少的字體放前，使用機率高的字體放後"></a>使用機率較少的字體放前，使用機率高的字體放後</h2><ul><li>使用機率較少的字體放在前面（例如只有Mac系統才有的蘋果儷中黑字體）</li><li>使用機率高的字體放在後面（幾乎每個作業系統都有的新細明體或標楷體）</li></ul><blockquote><p>舉例來說，如果我想要瀏覽這個網站的使用者，使用Mac裝置看得是蘋果儷中黑，用Windows瀏覽則看到的是微軟正黑體，那該怎麼設定？</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">font-family</span>: <span class="hljs-string">&quot;蘋果儷中黑&quot;</span>, <span class="hljs-string">&quot;微軟正黑體&quot;</span>, sans-serif<br></code></pre></td></tr></table></figure><h2 id="確保裝置都能讀取字體：中英字體名稱皆設定"><a href="#確保裝置都能讀取字體：中英字體名稱皆設定" class="headerlink" title="確保裝置都能讀取字體：中英字體名稱皆設定"></a>確保裝置都能讀取字體：中英字體名稱皆設定</h2><p>建議設定font-family時不只是要設定A的中文字體，也要設定A的英文字行名稱都要設定，這樣做是為了防止有些作業系統或裝置抓不到該中文字體名稱，兩者皆設定會比較保險。<br>舉例來說，微軟正黑體的英文名稱為：Microsoft JhengHei，那就可以像下面這樣設定<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">font-family</span>: Microsoft JhengHei, <span class="hljs-string">&quot;微軟正黑體&quot;</span>, sans-serif<br></code></pre></td></tr></table></figure></p><h2 id="在-Rails-5-裡引用特殊英文字體"><a href="#在-Rails-5-裡引用特殊英文字體" class="headerlink" title="在 Rails 5 裡引用特殊英文字體"></a>在 Rails 5 裡引用特殊英文字體</h2><p>如果設計師給你的字型是特殊的英文字體（也就是非內建字體），需包在專案內</p><blockquote><p>舉例來說，今天設計師給我CenturyGothicBold字體，引用此字體步驟</p></blockquote><ol><li>把字體包放到 assets/fonts資料架內</li><li>用 Fontface Generator 產生各種支援的eot, woff, ttf 格式支援各系統<br><a href="https://www.fontsquirrel.com/tools/webfont-generator">Font-face 產生器</a></li></ol><p>上傳你要客製化使用的英文字體，Generator(產生器)便會自動生成各系統使用的字體檔</p><ol start="3"><li>在css上設定@font-face，若在rails引用路徑，可用 assets_path的helper</li><li>針對個別需使用此字體的element（例如h1）或整體body設定 font-family: “CenturyGothicBold” <figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-keyword">@font-face</span> &#123;<br>  <span class="hljs-attribute">font-family</span>: <span class="hljs-string">&#x27;CenturyGothicBold&#x27;</span>;<br>  <span class="hljs-attribute">src</span>: url(<span class="hljs-string">&#x27;&lt;%= asset_path(&quot;fonts/CenturyGothicBold.eot&quot;</span>) %&gt;&#x27;);<br>  <span class="hljs-attribute">src</span>: url(<span class="hljs-string">&#x27;&lt;%= asset_path(&quot;fonts/CenturyGothicBold.eot&quot;</span>) %&gt;<span class="hljs-string">&#x27;) format(&#x27;</span>embedded-opentype&#x27;),<br>  url(<span class="hljs-string">&#x27;&lt;%= asset_path(&quot;fonts/CenturyGothicBold.woff&quot;</span>) %&gt;<span class="hljs-string">&#x27;) format(&#x27;</span>woff2&#x27;),<br>url(<span class="hljs-string">&#x27;&lt;%= asset_path(&quot;fonts/CenturyGothicBold.woff&quot;</span>) %&gt;<span class="hljs-string">&#x27;) format(&#x27;</span>woff&#x27;),<br>url(<span class="hljs-string">&#x27;&lt;%= asset_path(&quot;fonts/CenturyGothicBold.ttf&quot;</span>) %&gt;<span class="hljs-string">&#x27;) format(&#x27;</span>truetype&#x27;)<br>url(<span class="hljs-string">&#x27;&lt;%= asset_path(&quot;fonts/CenturyGothicBold.svg#CenturyGothicBold&quot;</span>) %&gt;<span class="hljs-string">&#x27;) format(&#x27;</span>svg&#x27;);<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><blockquote><p>小知識：為什麼有這麼多種格式的字型？（woff2, woff, eot, ttf）</p></blockquote><p>原因：有些瀏覽器只會讀取某種格式的字體檔，如果你想要把所有裝置瀏覽網頁都呈現統一的字體瀏覽的話，就得必須設這些擴充字體，讓某些不支援的瀏覽器或Android手機可以正常顯示你想要的字體</p><blockquote><p>小知識：你知道字體有四大天王的格式嗎？</p></blockquote><p>網頁上有四種字型格式：WOFF2、WOFF、EOT、TTF<br>有些瀏覽器只會讀取某種格式的字體檔，</p><ul><li>WOFF 2.0 支援的瀏覽器</li><li>WOFF 給大部分瀏覽器</li><li>EOT 給舊版 Android (4.4版以下) 的瀏覽器</li><li>TTF 給舊版 IE ( IE 9 以下) 的瀏覽器</li></ul><p>有興趣者可以參考這篇Stack發問：<a href="https://stackoverflow.com/questions/11002820/why-should-we-include-ttf-eot-woff-svg-in-a-font-face">Why should we include ttf, eot, woff, svg,… in a font-face</a></p><h2 id="三大作業系統-字體中英對照"><a href="#三大作業系統-字體中英對照" class="headerlink" title="三大作業系統 | 字體中英對照"></a>三大作業系統 | 字體中英對照</h2><h3 id="Mac-OS"><a href="#Mac-OS" class="headerlink" title="Mac OS"></a>Mac OS</h3><p>華文楷體：STKaiti<br>華文細明體：STSong<br>華文仿宋：STFangsong<br>儷黑 Pro：LiHei Pro Medium<br>儷宋 Pro：LiSong Pro Light<br>標楷體：BiauKai<br>蘋果儷中黑：Apple LiGothic Medium<br>蘋果儷細宋：Apple LiSung Light</p><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>新細明體：PMingLiU<br>細明體：MingLiU<br>標楷體：DFKai-SB<br>黑體：SimHei<br>細明體：mingliu<br>新細明體：Nmingliu<br>仿宋：FangSong<br>楷體：KaiTi<br>仿宋_GB2312：FangSong_GB2312<br>標楷體：KaiTi_GB2312<br>微軟正黑體：Microsoft JhengHei<br>微軟雅黑體：Microsoft YaHei</p><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><p>文泉驛正黑：WenQuanYi Zen Hei<br>全字庫正楷體：TW-Kai</p><h2 id="Reference-參考資料"><a href="#Reference-參考資料" class="headerlink" title="Reference | 參考資料"></a>Reference | 參考資料</h2><ul><li><a href="https://www.wfublog.com/2014/02/font-family-chinese-cross-platform.html">網頁中英文字型(font-family)跨平台設定最佳化</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Git筆記：移花接木的Rebase，整理commit訊息的好幫手</title>
      <link href="//Git%E7%AD%86%E8%A8%98%EF%BC%9A%E7%A7%BB%E8%8A%B1%E6%8E%A5%E6%9C%A8%E7%9A%84Rebase%EF%BC%8C%E6%95%B4%E7%90%86commit%E8%A8%8A%E6%81%AF%E7%9A%84%E5%A5%BD%E5%B9%AB%E6%89%8B/"/>
      <url>//Git%E7%AD%86%E8%A8%98%EF%BC%9A%E7%A7%BB%E8%8A%B1%E6%8E%A5%E6%9C%A8%E7%9A%84Rebase%EF%BC%8C%E6%95%B4%E7%90%86commit%E8%A8%8A%E6%81%AF%E7%9A%84%E5%A5%BD%E5%B9%AB%E6%89%8B/</url>
      
        <content type="html"><![CDATA[<p><a href="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/03/04182817/rEBASE.png"><img class="size-full wp-image-334 aligncenter" src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/03/04182817/rEBASE.png" alt="" width="560" height="397" /></a><a href="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/03/04193721/rEBASE-1.png"><br></a>Git 有個神奇的功能叫：Rebase，中文翻譯叫「變動基底」，簡單來說就是移花接木，把某一個樹枝（Branch）接到Master的主幹上等等功能，指定的節點可以重新 commit，花了一點時間做功課，把自己的理解的寫下來</p><h1 id="為什麼要用-Rebase-？變動基底的話不就很危險嗎"><a href="#為什麼要用-Rebase-？變動基底的話不就很危險嗎" class="headerlink" title="為什麼要用 Rebase ？變動基底的話不就很危險嗎"></a>為什麼要用 Rebase ？變動基底的話不就很危險嗎</h1><p>Rebase 的好處 &gt; 壞處，接著養成好習慣，在每次做Rebase之前，開一個backup的branch，以防改爛時還可以回溯，這樣就什麼都不怕啦！</p><h2 id="Rebase能做什麼？"><a href="#Rebase能做什麼？" class="headerlink" title="Rebase能做什麼？"></a>Rebase能做什麼？</h2><ul><li>可以修改 commit 訊息 （Reword）</li><li>可以修改 commit 內容（Edit），甚至可以拆成兩個 commit 紀錄、合併commit</li><li>重新 commit ( <code>Pick</code>)</li><li>更換 commit 順序（<strong>做這個要很小心，可能會把你的專案搞爛</strong>）</li><li>修改 commit 順序 (<code>Edit</code>)</li><li>拆解 commit (把多個commit紀錄變成一個commit)</li><li>壓縮 commit，合併 commit 訊息 (<code>Squash</code>)</li><li>刪除 commit (<code>Skip</code>)<br>即使列出來還是不懂Rebase的好處嗎？在此示範，我常常會有種鬼打牆的狀況…..<h3 id="亂糟糟的Commit紀錄"><a href="#亂糟糟的Commit紀錄" class="headerlink" title="亂糟糟的Commit紀錄"></a>亂糟糟的Commit紀錄</h3><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/03/04183630/Screen-Shot-2018-03-04-at-6.34.30-PM.png" alt=""></li></ul><p>你看到的git log有好幾處幾乎是有重複的commit紀錄，這時就有必要性整理commit紀錄了！</p><h3 id="用rebase來整理commit紀錄"><a href="#用rebase來整理commit紀錄" class="headerlink" title="用rebase來整理commit紀錄"></a>用rebase來整理commit紀錄</h3><p>由於我是在develop的branch開發的，所以整理commit message自然也要在develop上做<br>首先先git log 查看你想要塗改的commit紀錄，最好是在前面好幾個紀錄前<br><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/03/04183958/Screen-Shot-2018-03-04-at-6.38.01-PM-1024x478.png" alt=""></p><p>如果說要重新commit的話就是選你的要的那一行commit，預設都是pick<br><code>輸入git rebase -i 968cada</code></p><p><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/03/04184958/Screen-Shot-2018-03-04-at-6.48.27-PM-1024x670.png" alt=""></p><p>那我把第二行的commit 調整首頁區塊 <code>pick</code> 修改成 <code>squash</code><br><code>squahs</code>代表將這個commit紀錄，合併到上一個commit裡面</p><p><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/03/04185313/Screen-Shot-2018-03-04-at-6.49.21-PM-1024x743.png" alt=""></p><p>接著會跳出視窗：請你修改commit message &lt;<br><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/03/04185325/Screen-Shot-2018-03-04-at-6.50.13-PM-1024x668.png" alt=""></p><p>我不想要留下那個commit訊息，我要直接合併，因此我將第二個commit message那一行全部刪除</p><p><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/03/04185343/Screen-Shot-2018-03-04-at-6.50.35-PM-1024x403.png" alt=""></p><h3 id="如何在Vim編輯器下存檔、離開？"><a href="#如何在Vim編輯器下存檔、離開？" class="headerlink" title="如何在Vim編輯器下存檔、離開？"></a>如何在Vim編輯器下存檔、離開？</h3><blockquote><p>下圖為<code>Vim</code>編輯器下，如果你還不太會用Vim編輯器，只要記得下列兩個超實用的指令就可走遍半個江湖<br>如何修改：按鍵盤的<code>i</code>即會出現游標，便可以開始修改。修改完成後按下<code>ESC</code>鍵，並輸出<code>:wq</code>即可存檔<br>不想存檔？想要直接離開，一樣先按下<code>ESC</code>並輸入<code>:q</code>即可不存檔離開</p></blockquote><p><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/03/04185813/Screen-Shot-2018-03-04-at-6.56.36-PM-1024x251.png" alt=""></p><p>接著就成功的合併commit紀錄啦！</p><p>如果覺得還是醜醜的可以繼續rebase整理完再合併到master上</p><p>接著就是切換到<code>master</code> =&gt; <code>git checout master</code> =&gt; 合併 <code>git merge develop</code></p><p>&nbsp;</p><p>如果選擇其他的像reword、edit的選項（修改commit訊息、或是一個commit拆成多個commit）<br>他會自動跳到你當時儲存的節點當成是HEAD<br>接著再<code>git add 你想要分的檔案</code> <code>git commit -m</code> 就可以拆分commit紀錄了</p><p>&nbsp;</p><p>整理完develop的commit紀錄後，再<code>git merge master</code>就可以囉</p><p>別忘了在rebase前，記得開一個backup的branch，以防萬一啊！</p><h3 id="練習試試看，推薦Learn-Git-Branching，"><a href="#練習試試看，推薦Learn-Git-Branching，" class="headerlink" title="練習試試看，推薦Learn Git Branching，"></a>練習試試看，推薦Learn Git Branching，</h3><p>我非常推薦一個非常棒的Github教學網站：<a href="https://learngitbranching.js.org/">Learn Git Branching</a><br>要學Git往往最困難的是要準備此情境的檔案，因為很懶（誤）…<br>但在這個<code>Learn Git Branching</code>直接幫你準備好，甚至很變態的在網站上輸入git指令就可以馬上看到結果。<br><img src="https://i.imgur.com/tK5aKJG.png" alt="Learn Git Branching"><br>這邊還可以學到reset, revert, rebase, cherry-pick<br><img src="https://i.imgur.com/i1PAyAw.png" alt="Learn Git Branching"><br>根據你想要學的單元，他會給你一個目標進而完成關卡。<br><img src="https://i.imgur.com/QFENxyW.png" alt="Learn Git Branching"><br>他的介面是這樣，動手在左邊視窗輸入指令，右邊的圖便會照著你的指令移動</p><blockquote><p>看再多的教學，都只是用眼睛看而已，一定要動手實作看看，才真的可以吸收進去，快點點進去吧XD</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git push repo失敗： Could not resolve host: github.com</title>
      <link href="//Git-push-repo%E5%A4%B1%E6%95%97%EF%BC%9A-Could-not-resolve-host-github-com/"/>
      <url>//Git-push-repo%E5%A4%B1%E6%95%97%EF%BC%9A-Could-not-resolve-host-github-com/</url>
      
        <content type="html"><![CDATA[<p>今天在練習JavaScript時，正要把成果push到Git repo裡，出現<code>Could not resolve host: github.com</code>錯誤訊息，在此紀錄如何解決</p><h2 id="錯誤訊息"><a href="#錯誤訊息" class="headerlink" title="錯誤訊息"></a>錯誤訊息</h2><p><code>Could not resolve host: github.com</code></p><h2 id="解決辦法"><a href="#解決辦法" class="headerlink" title="解決辦法"></a>解決辦法</h2><ol><li>在終端機上先Ping <code>github.com</code></li><li>確認有連線到，Cmd+C結束</li><li>直接竄改本地端的host文件</li><li>開啟finder -&gt; GOTO -&gt; etc/hosts</li><li>將hosts拉到桌面，在127.0.0.1 localhost 下面一行新增「192.30.255.113 github.com」儲存</li><li>儲存後將hosts丟回etc/hosts資料夾，會要求輸入admin密碼，輸入後並取代檔案</li><li>重新git push origin master，成功</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>做個超 AI 的響應式圖片吧，利用 HTML5 srcset 搭配 Rails Helper img_set_tag</title>
      <link href="//%E5%81%9A%E5%80%8B%E8%B6%85%E6%99%BA%E8%83%BD%E7%9A%84%E9%9F%BF%E6%87%89%E5%BC%8F%E5%9C%96%E7%89%87%E5%90%A7%EF%BC%8C%E5%88%A9%E7%94%A8-HTML5-srcset-%E6%90%AD%E9%85%8D-Rails-Helper-img-set-tag/"/>
      <url>//%E5%81%9A%E5%80%8B%E8%B6%85%E6%99%BA%E8%83%BD%E7%9A%84%E9%9F%BF%E6%87%89%E5%BC%8F%E5%9C%96%E7%89%87%E5%90%A7%EF%BC%8C%E5%88%A9%E7%94%A8-HTML5-srcset-%E6%90%AD%E9%85%8D-Rails-Helper-img-set-tag/</url>
      
        <content type="html"><![CDATA[<p>做 Responsive Web Design 時難免少不了對圖片的處理，圖片能彈性隨著螢幕裝置大小調整，有多種做法可以參考。今天來探討使用 HTML5 新增的屬性 srcset 來搭配使用 Rails 的 Helper</p><p>通常做響應式圖片有兩種作法</p><ol><li>使用同一張圖片，依照容器、螢幕尺寸放大縮小</li><li>偵測不同的裝置，根據螢幕大小，使用不同大小的圖片</li></ol><h3 id="作法一"><a href="#作法一" class="headerlink" title="作法一"></a>作法一</h3><p>作法一：重頭到尾都使用同一張圖片，可以跟著螢幕修改圖片的比例大小</p><blockquote><p>響應式圖片 建議設定max-width: 100%<br>確保圖片不會超過畫面的大小，父層的容器設多少大小，子層的圖片就會乖乖在他背後下貼著容器。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">img</span> &#123; <span class="hljs-attribute">max-width</span>: <span class="hljs-number">100%</span>; <span class="hljs-attribute">height</span>: auto&#125;<br></code></pre></td></tr></table></figure><br>缺點：圖片量若很大，載入頁面時間會加長，對於行動裝置上網的客群，可能會因為網站載圖片跑太慢，導致用戶不想等直接離開網站。</p></blockquote><h3 id="做法二"><a href="#做法二" class="headerlink" title="做法二"></a>做法二</h3><p>做法二： 隨著裝置提供不同大小的圖檔</p><blockquote><p>我有一張圖片、但是幾個不同大小的版本想要替換使用<br>小螢幕裝置，就下載比較小的圖片，減少行動裝置上不必要的寬頻浪費<br>大螢幕就下載比較大的圖片、解析度也較高、看得比較清楚</p></blockquote><p>優點：可以根據圖片顯示的實際需要，給用戶端剛剛好的大小版本</p><blockquote><p>需要注意的事項：查詢<a href="https://caniuse.com/#search=srcset">Can I Use</a> 確認主流瀏覽器支援狀況</p></blockquote><h4 id="偵測不同裝置隨意換上圖片"><a href="#偵測不同裝置隨意換上圖片" class="headerlink" title="偵測不同裝置隨意換上圖片"></a>偵測不同裝置隨意換上圖片</h4><p>偵測不同裝置隨意換上圖片，有以下幾種做法</p><ol><li>使用HTML5 <code>&lt;img&gt;</code> 的屬性 <code>srcset</code><br>缺點：需要到Can I Use 看各主流瀏覽器版本是否已支援</li><li>HTML5 <code>&lt;picture&gt;</code></li><li><code>使用 srcset + picture</code></li><li>用 JavaScript 監聽 <code>window.resize</code>事件，修改圖片路徑</li><li>使用 <code>svg</code> 向量圖</li><li>使用第三方外掛，例如：<a href="https://scottjehl.github.io/picturefill/">picturefill</a>來補足不支援picture的瀏覽器</li></ol><h3 id="狀況劇一"><a href="#狀況劇一" class="headerlink" title="狀況劇一"></a>狀況劇一</h3><p>狀況劇一：設計師提供給我手機版、桌機版裝置的兩種圖片，要怎麼切圖搭配srcset使用？</p><h4 id="先切圖"><a href="#先切圖" class="headerlink" title="先切圖"></a>先切圖</h4><ol><li>給 Mobile 小螢幕裝置的圖片<br>切成 1x 給一般手機<br>切成 2x 給 Retine 高畫質螢幕</li><li>給tablet, desktop 大螢幕裝置的圖片<br>切成 1x, 2x, 3x</li></ol><h4 id="使用-srcset"><a href="#使用-srcset" class="headerlink" title="使用 srcset"></a>使用 srcset</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;img <span class="hljs-attribute">srcset</span>=<span class="hljs-string">&quot;360.jpg 360w,</span><br><span class="hljs-string">768.jpg 768w,</span><br><span class="hljs-string">1200.jpg 1200w,</span><br><span class="hljs-string">1920.jpg 1920w&quot;</span><br><span class="hljs-attribute">sizes</span>=<span class="hljs-string">&quot;</span><br><span class="hljs-string">(max-width: 360px) 100vw,</span><br><span class="hljs-string">(max-width: 768px) 90vw,</span><br><span class="hljs-string">(max-width: 1980px) 80vw,</span><br><span class="hljs-string">768px&quot;</span><br><span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;360.jpg&quot;</span> <span class="hljs-attribute">alt</span>=<span class="hljs-string">&quot;範例&quot;</span>&gt;<br></code></pre></td></tr></table></figure><blockquote><p>srcset 非常的簡單，寫下你要放上的幾張圖片和他的寬度，瀏覽器就會自動去選擇<br>srcset 分別跟瀏覽器先生說：「嗨，我這裡有360.jpg、768.jpg、1200.jpg、1920.jpg圖片」<br>sizes 也和瀏覽器說：「不同裝置的寬度(media query)下，圖片的寬度也要幫我個別調整！」</p></blockquote><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">sizes</span>=<span class="hljs-string">&quot;(max-width: 360px) 100vw&quot;</span><br></code></pre></td></tr></table></figure><p>在320px的iphone4下瀏覽，圖片寬度自動也會被調整為 100vw。</p><h3 id="Rails-img-secret-sizes-Helper"><a href="#Rails-img-secret-sizes-Helper" class="headerlink" title="Rails img secret, sizes Helper"></a>Rails img secret, sizes Helper</h3><p>由於Rails內建的Helper沒有<code>image srcset</code>，於是我們要手動新增Helper<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">// 新增在 application_helper.rb</span><br>def image<span class="hljs-constructor">_set_tag(<span class="hljs-params">source</span>, <span class="hljs-params">srcset</span> = &#123;&#125;, <span class="hljs-params">options</span> = &#123;&#125;)</span><br>  srcset = srcset.map &#123; <span class="hljs-pattern-match">|src, size| &quot;#&#123;path<span class="hljs-constructor">_to_image(<span class="hljs-params">src</span>)</span>&#125; #&#123;size&#125;&quot; &#125;.join(&#x27;, &#x27;)</span><br><span class="hljs-pattern-match">  image<span class="hljs-constructor">_tag(<span class="hljs-params">source</span>, <span class="hljs-params">options</span>.<span class="hljs-params">merge</span>(<span class="hljs-params">srcset</span>: <span class="hljs-params">srcset</span>)</span>)</span><br><span class="hljs-pattern-match"><span class="hljs-keyword">end</span>  </span><br></code></pre></td></tr></table></figure></p><p>新增完後便可以照著他的規則使用啦！剛剛切出來的五張圖片可以派上用場囉<br><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sml">&lt;%= image_set_tag <span class="hljs-symbol">&#x27;How</span>-we-work.png&#x27;, &#123; <br>  <span class="hljs-symbol">&#x27;How</span>-we-work-<span class="hljs-type">Mobile</span>.png&#x27; =&gt; <span class="hljs-string">&#x27;320w&#x27;</span>,<br>  <span class="hljs-symbol">&#x27;How</span>-we-work-<span class="hljs-type">Mobile</span>@<span class="hljs-number">2</span>x.png&#x27; =&gt; <span class="hljs-string">&#x27;640w&#x27;</span>,<br>  <span class="hljs-symbol">&#x27;How</span>-we-work-<span class="hljs-type">PC</span>@<span class="hljs-number">2</span>x.png&#x27; =&gt; <span class="hljs-string">&#x27;1024w&#x27;</span>,<br>  <span class="hljs-symbol">&#x27;How</span>-we-work-<span class="hljs-type">PC</span>@<span class="hljs-number">3</span>x.png&#x27; =&gt; <span class="hljs-string">&#x27;1980w&#x27;</span><br>&#125;, alt: <span class="hljs-string">&#x27;如何運作&#x27;</span>, class: <span class="hljs-symbol">&#x27;img</span>-fluid mx-auto d-block&#x27; %&gt;<br></code></pre></td></tr></table></figure><br>瀏覽器吃掉上述程式碼後，它會通過 srcset 屬性自動選擇 Mobile 2x,  PC 2x 等圖，比如說今天用 iPhone 6s，便會自動選擇 Mobile@2x 的圖。</p><blockquote><p><code>default</code>, <code>image_set_tag &#39;How-we-work.png&#39;</code> 這裏即指 default</p></blockquote><p>若瀏覽器太舊看不懂 srcset，會讀取 src 的圖片網址來顯示。套上範例，瀏覽器不支援就會讀取<code>How-we-work.png</code>的圖檔</p><blockquote><p>以下的 <code>w</code> 不是真的指 <code>px</code> ，而是<code>裝置像素比</code>，為了好理解先套上px</p><ul><li><code>320w</code><br>手機模式瀏覽 src自動轉換成 Mobile.png<br>當偵測到瀏覽器為不大於 320px 寬時，顯示 Mobile.png 這張圖</li><li><code>640w</code><br>平板模式瀏覽 src自動轉換成 <a href="mailto:Mobile@2x.png">Mobile@2x.png</a></li><li><code>1024w</code><br>平板裝置瀏覽 寬度有1024，src自動轉換成 <a href="mailto:PC@2x.png">PC@2x.png</a></li><li><code>1980w</code><br>桌機裝置瀏覽 寬度有1980，src自動轉換成 <a href="mailto:PC@3x.png">PC@3x.png</a></li></ul></blockquote><h3 id="w是什麼？"><a href="#w是什麼？" class="headerlink" title="w是什麼？"></a>w是什麼？</h3><p>W 是 設備像素比(DevicePixelRatio)，詳細可點擊<a href="http://screensiz.es/">查詢各裝置的裝置像素密度</a><br>320w, 640w, 1024w, 1980w 這裡的w不是指px，而是「設備像素比」 也就是 <code>window.devicePixelRatio</code></p><h3 id="測試"><a href="#測試" class="headerlink" title="測試"></a>測試</h3><p>如何測試實驗圖片真的有跟著寬度做更換？<br>建議測試時開啟Chrome無痕視窗，以避免瀏覽器快取後，不會自動切換圖片</p><ol><li>打開Chrome 開發人員工具</li><li>指到 src </li><li><p>會發現瀏覽器視窗隨著調整，src指定的圖片路徑會變成設定的圖檔</p><blockquote><p>像是我開到手機寬度時，src指定圖片路徑會變成Mobile.png，開到正常電腦大小寬度時，src的路徑則會變成<a href="mailto:PC@3x.png">PC@3x.png</a></p></blockquote></li><li><p>大功告成！</p></li></ol><h3 id="Reference-參考資料"><a href="#Reference-參考資料" class="headerlink" title="Reference | 參考資料"></a>Reference | 參考資料</h3><ul><li><a href="http://www.dailycold.tw/7216/jpeg-jpg-lossy-compression-artifacts/">為什麼低解析度的JPG會跟馬賽克一樣？</a></li><li><a href="https://stackoverflow.com/questions/45360050/using-image-tag-with-srcset-attribute">Using image_tag with srcset attribute?</a></li><li><a href="https://segmentfault.com/a/1190000008662857">响应式图片实战</a></li><li><a href="https://www.wfublog.com/2017/08/picasa-rwd-image-srcset.html">Picasa 圖床的獨家應用：製作 RWD 自適應圖片，讓手機自動載入小圖，加快網頁讀取速度</a></li><li><a href="http://lauraluo.github.io/2015/04/15/20150415-RwdPojectStudy/">RWD響應式網頁專案開發心得(一)</a></li><li><a href="http://blog.zhusee.in/post/248199/basic-responsive-image-with-srcset-property">用 srcset 屬性做簡單的 Responsive Image</a></li><li><a href="https://www.minwt.com/webdesign-dev/js/12386.html">《Picturefill 自適應圖片》隨著裝置提供不同大小的圖檔(JS版)</a></li><li><a href="http://screensiz.es/">查詢各裝置的裝置像素密度</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Rails 5 </tag>
            
            <tag> RWD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rails 5 快速設置 favicon icon</title>
      <link href="//Rails-5-%E5%BF%AB%E9%80%9F%E8%A8%AD%E7%BD%AE-favicon-icon/"/>
      <url>//Rails-5-%E5%BF%AB%E9%80%9F%E8%A8%AD%E7%BD%AE-favicon-icon/</url>
      
        <content type="html"><![CDATA[<p>現在的裝置上千幾種，Icon也針對各種裝置Andoroid、iOS各設置了不同大小尺寸的icon，如果在Rails內開發，可以參考以下的寫法。底下的Reference可以知道各個icon設置的用途適用於哪些裝置。</p><h2 id="快速設置-Icon-步驟"><a href="#快速設置-Icon-步驟" class="headerlink" title="快速設置 Icon 步驟"></a>快速設置 Icon 步驟</h2><ol><li>在view/layouts下新增<code>_favicon.html.erb</code>的樣板</li><li>並在application.html.erb render <code>_favicon.html.erb</code></li><li>找icon generator 自動產生針對各裝置的icon圖<ul><li><a href="https://realfavicongenerator.net/favicon/ruby_on_rails#.WcpqH9MjH-a">Rails Generator</a></li><li><a href="https://makeappicon.com/">MakeAppleIcon</a></li></ul></li><li>將 icon圖放置 <code>app/assets/image/icon</code> 內</li></ol><p><code>application.html.erb</code><br><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs erb"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="xml">&lt;%=</span><span class="ruby"> render <span class="hljs-string">&#x27;layouts/favicon&#x27;</span> </span><span class="xml">%&gt;</span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;manifest&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot; &lt;%=</span></span></span><span class="ruby"> asset_path <span class="hljs-string">&#x27;ico/manifest.json&#x27;</span> </span><span class="xml"><span class="hljs-tag"><span class="hljs-string">%&gt;&quot;</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;msapplication-config&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;&lt;%=</span></span></span><span class="ruby"> asset_path <span class="hljs-string">&#x27;ico/browserconfig.xml&#x27;</span> </span><span class="xml"><span class="hljs-tag"><span class="hljs-string">%&gt;&quot;</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;apple-mobile-web-app-title&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;xxxx&quot;</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;application-name&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;xxxx&quot;</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;msapplication-TileColor&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;#2b5797&quot;</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;theme-color&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;#ffffff&quot;</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br></code></pre></td></tr></table></figure></p><p><code>_favicon.html.erb</code></p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs mel"><br>&lt;% %w(<span class="hljs-number">57</span> <span class="hljs-number">60</span> <span class="hljs-number">72</span> <span class="hljs-number">76</span> <span class="hljs-number">114</span> <span class="hljs-number">120</span> <span class="hljs-number">144</span> <span class="hljs-number">152</span> <span class="hljs-number">180</span>).each <span class="hljs-keyword">do</span> |s| %&gt;<br>    &lt;%= favicon_link_tag <span class="hljs-string">&quot;ico/apple-icon-#&#123;s&#125;x#&#123;s&#125;.png&quot;</span>, rel: <span class="hljs-string">&#x27;apple-touch-icon&#x27;</span>, type: <span class="hljs-string">&#x27;image/png&#x27;</span>, sizes: <span class="hljs-string">&quot;#&#123;s&#125;x#&#123;s&#125;&quot;</span> %&gt;<br>&lt;% end %&gt;<br><br>&lt;% %w(<span class="hljs-number">36</span> <span class="hljs-number">48</span> <span class="hljs-number">72</span> <span class="hljs-number">96</span> <span class="hljs-number">144</span> <span class="hljs-number">192</span>).each <span class="hljs-keyword">do</span> |s| %&gt;<br>    &lt;%= favicon_link_tag <span class="hljs-string">&quot;ico/android-icon-#&#123;s&#125;x#&#123;s&#125;.png&quot;</span>, rel: <span class="hljs-string">&#x27;android-chrome&#x27;</span>, type: <span class="hljs-string">&#x27;image/png&#x27;</span>, sizes: <span class="hljs-string">&quot;#&#123;s&#125;x#&#123;s&#125;&quot;</span> %&gt;<br>&lt;% end %&gt;<br><br>&lt;% %w(<span class="hljs-number">70</span> <span class="hljs-number">144</span> <span class="hljs-number">150</span> <span class="hljs-number">310</span>).each <span class="hljs-keyword">do</span> |s| %&gt;<br>    &lt;%= favicon_link_tag <span class="hljs-string">&quot;ico/ms-icon-#&#123;s&#125;x#&#123;s&#125;.png&quot;</span>, rel: <span class="hljs-string">&#x27;mstile&#x27;</span>, type: <span class="hljs-string">&#x27;image/png&#x27;</span>, sizes: <span class="hljs-string">&quot;#&#123;s&#125;x#&#123;s&#125;&quot;</span> %&gt;<br>&lt;% end %&gt;<br><br>&lt;% %w(<span class="hljs-number">16</span> <span class="hljs-number">32</span> <span class="hljs-number">96</span>).each <span class="hljs-keyword">do</span> |s| %&gt;<br>    &lt;%= favicon_link_tag <span class="hljs-string">&quot;ico/favicon-#&#123;s&#125;x#&#123;s&#125;.png&quot;</span>, rel: <span class="hljs-string">&#x27;x-icon&#x27;</span>, type: <span class="hljs-string">&#x27;image/png&#x27;</span>, sizes: <span class="hljs-string">&quot;#&#123;s&#125;x#&#123;s&#125;&quot;</span> %&gt;<br>&lt;% end %&gt;<br><br>&lt;%= favicon_link_tag <span class="hljs-string">&#x27;ico/favicon.ico&#x27;</span>, rel: <span class="hljs-string">&#x27;shortcut icon&#x27;</span> %&gt;<br>&lt;%= favicon_link_tag <span class="hljs-string">&#x27;ico/favicon.ico&#x27;</span> , rel: <span class="hljs-string">&#x27;bookmark&#x27;</span> %&gt;<br>&lt;%= tag(:link, rel: <span class="hljs-string">&#x27;manifest&#x27;</span>, href: (<span class="hljs-string">&#x27;ico/manifest.json&#x27;</span>)) %&gt;<br></code></pre></td></tr></table></figure><h4 id="Apple-Touch-Icons"><a href="#Apple-Touch-Icons" class="headerlink" title="Apple Touch Icons"></a>Apple Touch Icons</h4><ul><li>120x120: iPhone Retina (iOS 7)</li><li>180x180: iPhone 6 Plus (iOS 8+)</li><li>152x152: iPad Retina (iOS 7)</li><li>167x167: iPad Pro (iOS 8+)</li></ul><figure class="highlight flix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs flix">&lt;link <span class="hljs-keyword">rel</span>=<span class="hljs-string">&quot;apple-touch-icon&quot;</span> href=<span class="hljs-string">&quot;older-iPhone.png&quot;</span>&gt; <span class="hljs-comment">// 120px  </span><br>&lt;link <span class="hljs-keyword">rel</span>=<span class="hljs-string">&quot;apple-touch-icon&quot;</span> sizes=<span class="hljs-string">&quot;180x180&quot;</span> href=<span class="hljs-string">&quot;iPhone-6-Plus.png&quot;</span>&gt;  <br>&lt;link <span class="hljs-keyword">rel</span>=<span class="hljs-string">&quot;apple-touch-icon&quot;</span> sizes=<span class="hljs-string">&quot;152x152&quot;</span> href=<span class="hljs-string">&quot;iPad-Retina.png&quot;</span>&gt;  <br>&lt;link <span class="hljs-keyword">rel</span>=<span class="hljs-string">&quot;apple-touch-icon&quot;</span> sizes=<span class="hljs-string">&quot;167x167&quot;</span> href=<span class="hljs-string">&quot;iPad-Pro.png&quot;</span>&gt;<br></code></pre></td></tr></table></figure><h4 id="IE11-微軟動態磚"><a href="#IE11-微軟動態磚" class="headerlink" title="IE11 微軟動態磚"></a>IE11 微軟動態磚</h4><p>取得 browserconfig.xml 檔案</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;meta <span class="hljs-attribute">name</span>=<span class="hljs-string">&quot;msapplication-config&quot;</span> <span class="hljs-attribute">content</span>=<span class="hljs-string">&quot;ieconfig.xml&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><h3 id="Reference-參考資料"><a href="#Reference-參考資料" class="headerlink" title="Reference | 參考資料"></a>Reference | 參考資料</h3><ul><li><a href="https://msdn.microsoft.com/zh-tw/library/dn455106(v=vs.85">建立自訂動態磚 - Microsoft</a>.aspx)</li><li><a href="http://pressing.space/frontend/favicon-trivia/">Favicon – 關於我的最愛圖示的二三事</a></li><li><a href="https://sympli.io/blog/2017/02/15/heres-everything-you-need-to-know-about-favicons-in-2017/">Here’s Everything You Need to Know About Favicons in 2017</a></li><li><a href="https://realfavicongenerator.net/favicon/ruby_on_rails#.Wn0XVJP1Usn">Favicon Generator for Ruby on Rails 自動生成</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Rails 5 </tag>
            
            <tag> Favicon Icon </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git 修改又臭又長的指令，加快開發速度</title>
      <link href="//Git-%E4%BF%AE%E6%94%B9%E5%8F%88%E8%87%AD%E5%8F%88%E9%95%B7%E7%9A%84%E6%8C%87%E4%BB%A4%EF%BC%8C%E5%8A%A0%E5%BF%AB%E9%96%8B%E7%99%BC%E9%80%9F%E5%BA%A6/"/>
      <url>//Git-%E4%BF%AE%E6%94%B9%E5%8F%88%E8%87%AD%E5%8F%88%E9%95%B7%E7%9A%84%E6%8C%87%E4%BB%A4%EF%BC%8C%E5%8A%A0%E5%BF%AB%E9%96%8B%E7%99%BC%E9%80%9F%E5%BA%A6/</url>
      
        <content type="html"><![CDATA[<p><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/02/09000352/Screen-Shot-2018-02-08-at-11.47.49-PM.png" alt=""></p><h3 id="有辦法縮短Github指令嗎？"><a href="#有辦法縮短Github指令嗎？" class="headerlink" title="有辦法縮短Github指令嗎？"></a>有辦法縮短Github指令嗎？</h3><p><code>git status</code>, <code>git commit -m&#39;</code>,<code>git checkout develop/layout</code>,<code>git pull origin master</code>..是不是常常覺得輸入這些指令很繁瑣又長，有甚麼辦法可以縮短這些指令呢？</p><h4 id="答案是有的！"><a href="#答案是有的！" class="headerlink" title="答案是有的！"></a>答案是有的！</h4><h3 id="將Git常用的指令，縮短成好記又好用的縮寫吧！"><a href="#將Git常用的指令，縮短成好記又好用的縮寫吧！" class="headerlink" title="將Git常用的指令，縮短成好記又好用的縮寫吧！"></a>將Git常用的指令，縮短成好記又好用的縮寫吧！</h3><p>這四個指令比較好記，也較常用到，實用度很高！！</p><ol><li>MAC 環境下打開 iTerm</li><li>輸入以下指令<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs verilog">git <span class="hljs-keyword">config</span> --<span class="hljs-keyword">global</span> <span class="hljs-keyword">alias</span><span class="hljs-variable">.co</span> checkout<br>git <span class="hljs-keyword">config</span> --<span class="hljs-keyword">global</span> <span class="hljs-keyword">alias</span><span class="hljs-variable">.ci</span> commit<br>git <span class="hljs-keyword">config</span> --<span class="hljs-keyword">global</span> <span class="hljs-keyword">alias</span><span class="hljs-variable">.st</span> status<br>git <span class="hljs-keyword">config</span> --<span class="hljs-keyword">global</span> <span class="hljs-keyword">alias</span><span class="hljs-variable">.br</span> branch<br></code></pre></td></tr></table></figure></li></ol><ul><li>co = checkout</li><li>ci = commit</li><li>st = status</li><li>br = branch</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">git co develop <span class="hljs-regexp">//</span> 等同於 git checkout develop<br>git ci -m <span class="hljs-string">&#x27;Initalize commit&#x27;</span> <span class="hljs-regexp">//</span> 等同於 git commit -m <span class="hljs-string">&#x27;Initalize commit&#x27;</span><br>git st <span class="hljs-regexp">//</span> 等同於 git status<br>git br -b develop <span class="hljs-regexp">//</span> 等同於 建立develop分支並切換過去<br></code></pre></td></tr></table></figure><h4 id="其他參考指令"><a href="#其他參考指令" class="headerlink" title="其他參考指令"></a>其他參考指令</h4><p><code>vim ~/.gitconfig</code> 找到 <code>alias</code> 列表後可以根據自己需求輸入，如果想要客製化更改也可以的哦</p><ol><li><code>alias gthis=&#39;git rev-parse --abbrev-ref HEAD&#39;</code></li><li><code>alias gpushthis=&#39;git push origin gthis&#39;</code></li><li><code>alias gpullthis=&#39;git pull origin gthis&#39;</code></li><li><code>alias gup=&#39;git remote update&#39;</code></li><li><code>alias gpl=&#39;git pull origin&#39;</code></li></ol><h3 id="客製化-Git-輸出顏色"><a href="#客製化-Git-輸出顏色" class="headerlink" title="客製化 Git 輸出顏色"></a>客製化 Git 輸出顏色</h3><p>為了好好愛護眼睛，來客製化 Git 輸出的顏色吧!</p><p>先開啟git color ui顏色顯示指令。<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">git config --global color.ui <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure></p><p>開啟<code>git color.ui</code>指令後，Git 會按照你的需要，自動為大部分的輸出加上顏色。<br>當然也能客製化的更改，可以明確地規定哪些需要指令需要塗上顏色、要設定什麼顏色<br><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2018/02/09000352/Screen-Shot-2018-02-08-at-11.47.49-PM.png" alt=""></p><ul><li>用 Vim 編輯器直接進入 gitconfig 來編輯<br><code>vim ~/.gitconfig</code></li><li>找到 [alias]列表就可以開始進行客製化啦！</li><li>我使用別人提供的 Pretty git branch 加上 [alias]上</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">lg = <span class="hljs-built_in">log</span> --graph --abbrev-commit --decorate --format=format:<span class="hljs-string">&#x27;%C(yellow)%h%C(reset)%C(auto)%d%C(reset) %C(normal)%s%C(reset) %C(dim white)%an%C(reset) %C(dim blue)(%ar)%C (reset)&#x27;</span> --all<br></code></pre></td></tr></table></figure><p>以後只要輸入 git lg就會有一個小型的分支圖+一行的commit訊息啦，非常方便！</p><h4 id="Gitgraph-js"><a href="#Gitgraph-js" class="headerlink" title="Gitgraph.js"></a><a href="http://gitgraphjs.com/">Gitgraph.js</a></h4><p>也是一個js寫的library在瀏覽器顯示分支圖的樣式，有興趣者可以研究看看</p><h4 id="bash-completion-自動補齊-Plugin"><a href="#bash-completion-自動補齊-Plugin" class="headerlink" title="bash-completion 自動補齊 Plugin"></a><a href="https://github.com/scop/bash-completion">bash-completion 自動補齊 Plugin</a></h4><ul><li>MAC 環境 Bash安裝 bash-completion </li><li>工程師實在要記得太多數不清的指令了，當忘記指令的時候，多按幾下TAB便會幫你自動提示，超強大神器！</li></ul><p>Mac 使用 Brew 安裝 bash-completion，在 commend上輸入以下指令即可安裝。<br><code>brew install git bash-completion</code></p><blockquote><p>若還沒有安裝 <code>Brew</code> 請往前走左轉到 <a href="https://docs.brew.sh/Installation">Brew官方網站安裝</a>，啊！對了只限定於 Mac 哦。</p></blockquote><h3 id="Reference-參考資料"><a href="#Reference-參考資料" class="headerlink" title="Reference 參考資料"></a>Reference 參考資料</h3><ol><li><a href="http://note.drx.tw/2015/11/bash-completion-on-mac-osx.html">Bash 自動補齊 on Mac OSX 10.11.1</a></li><li><a href="https://segmentfault.com/a/1190000005945614">前端資源系列- Git-常用命令&amp;快捷命令&amp;小工作流</a></li><li><a href="https://git-scm.com/book/zh-tw/v1/Git-%E5%AE%A2%E8%A3%BD%E5%8C%96-Git-%E8%A8%AD%E5%AE%9A">Git-客製化-Git-設定</a></li><li><a href="https://stackoverflow.com/questions/1057564/pretty-git-branch-graphs">Pretty git branch graphs</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git 筆記：我想回到過去，到底要怎麼坐時光機？</title>
      <link href="//Git-%E7%AD%86%E8%A8%98%EF%BC%9A%E6%88%91%E6%83%B3%E5%9B%9E%E5%88%B0%E9%81%8E%E5%8E%BB%EF%BC%8C%E5%88%B0%E5%BA%95%E8%A6%81%E6%80%8E%E9%BA%BC%E5%9D%90%E6%99%82%E5%85%89%E6%A9%9F%EF%BC%9F/"/>
      <url>//Git-%E7%AD%86%E8%A8%98%EF%BC%9A%E6%88%91%E6%83%B3%E5%9B%9E%E5%88%B0%E9%81%8E%E5%8E%BB%EF%BC%8C%E5%88%B0%E5%BA%95%E8%A6%81%E6%80%8E%E9%BA%BC%E5%9D%90%E6%99%82%E5%85%89%E6%A9%9F%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="Git-筆記：我想回到過去，到底要怎麼坐時光機？"><a href="#Git-筆記：我想回到過去，到底要怎麼坐時光機？" class="headerlink" title="Git 筆記：我想回到過去，到底要怎麼坐時光機？"></a>Git 筆記：我想回到過去，到底要怎麼坐時光機？</h1><h3 id="基本觀念"><a href="#基本觀念" class="headerlink" title="基本觀念"></a>基本觀念</h3><ol><li>目前的位置叫做HEAD</li><li>沒被 <code>git add</code>進入<code>commit</code>的檔案<code>untracked files</code>，Git會選擇忽略，也不用怕被坐時光機回溯影響，<code>reset、checkout</code>對他們的影響力是0。</li><li><code>origin/master</code>是遠端的resp，<code>master</code>是本端的repo</li></ol><h3 id="我不想玩了不想存檔，我要回到上一次的存檔commit紀錄"><a href="#我不想玩了不想存檔，我要回到上一次的存檔commit紀錄" class="headerlink" title="我不想玩了不想存檔，我要回到上一次的存檔commit紀錄"></a>我不想玩了不想存檔，我要回到上一次的存檔commit紀錄</h3><p>懶得看<code>git log</code>查代碼，想快速回到上一次的commit紀錄</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">git checkout HEAD^<br>HEAD^ 等同 HEAD^ 等同 HEAD~<br><span class="hljs-regexp">//</span> 都代表一次的意思<br></code></pre></td></tr></table></figure><h3 id="改壞掉了QQ，我想捨棄所有還沒commit的修改"><a href="#改壞掉了QQ，我想捨棄所有還沒commit的修改" class="headerlink" title="改壞掉了QQ，我想捨棄所有還沒commit的修改"></a>改壞掉了QQ，我想捨棄所有還沒commit的修改</h3><p>招喚reset!<br><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">git <span class="hljs-keyword">reset</span> <span class="hljs-comment">--hard</span><br></code></pre></td></tr></table></figure></p><h4 id="改壞很久才後知後覺，commit存檔之後後悔了，有後悔藥嗎？"><a href="#改壞很久才後知後覺，commit存檔之後後悔了，有後悔藥嗎？" class="headerlink" title="改壞很久才後知後覺，commit存檔之後後悔了，有後悔藥嗎？"></a>改壞很久才後知後覺，commit存檔之後後悔了，有後悔藥嗎？</h4><ol><li>退回任意的commit位置</li><li>和checkout一樣，可以隨意亂跳</li></ol><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">git <span class="hljs-keyword">reset</span> <span class="hljs-comment">--hard HEAD^^</span><br>git <span class="hljs-keyword">reset</span> <span class="hljs-comment">--hard 5efdc4f</span><br>git <span class="hljs-keyword">reset</span> <span class="hljs-comment">--hard master~2</span><br>執行結果都一樣，從 HEAD 跳回兩個前 <span class="hljs-keyword">commit</span><br></code></pre></td></tr></table></figure><p>開分支寫一寫，然後和master合併</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">git checkout -b feature/fixbug<br><span class="hljs-regexp">//</span> 開始寫寫寫寫寫<br><span class="hljs-regexp">//</span> 準備合併！<br>git checkout master<br>git merge feature/fixbug<br></code></pre></td></tr></table></figure><ul><li>預設的遠端名字習慣都叫 <strong>origin</strong></li></ul><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">git</span> remote <span class="hljs-keyword">add</span> origin http:<span class="hljs-comment">//github/.....</span><br></code></pre></td></tr></table></figure><ul><li>推上遠端的 master / 分支</li></ul><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs maxima">git <span class="hljs-built_in">push</span> <span class="hljs-built_in">origin</span> master<br>git <span class="hljs-built_in">push</span> <span class="hljs-built_in">origin</span> <span class="hljs-built_in">feature</span>/fixbug<br></code></pre></td></tr></table></figure><ul><li>拉回來 遠端的 master / 分支</li></ul><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">git pull origin <span class="hljs-keyword">master</span><br><span class="hljs-title">git</span> pull origin feature/fixbug<br></code></pre></td></tr></table></figure><h3 id="多人協作開發，Git不打架？解決衝突"><a href="#多人協作開發，Git不打架？解決衝突" class="headerlink" title="多人協作開發，Git不打架？解決衝突"></a>多人協作開發，Git不打架？解決衝突</h3><h4 id="先-Clone-克隆再說"><a href="#先-Clone-克隆再說" class="headerlink" title="先 Clone 克隆再說"></a>先 Clone 克隆再說</h4><ol><li><code>git clone http://github...</code> </li><li>某A 開發寫寫寫寫寫，某B也在寫寫寫</li><li>某A <code>push</code> 上去了</li><li>某B 也準備<code>push</code>上去<code>被拒絕!!!</code>發生衝突<br><code>pull = fetch &amp; merge</code><br>某B 要先 <code>git pull</code>，同步某A版本才行</li></ol><h4 id="狀況一"><a href="#狀況一" class="headerlink" title="狀況一"></a>狀況一</h4><p>狀況一：git pull 順利成功</p><ol><li>git pull</li><li>git push origin master</li></ol><h4 id="狀況二"><a href="#狀況二" class="headerlink" title="狀況二"></a>狀況二</h4><p>狀況二：git pull 自動 merge失敗：<code>Merge conflict in xxx.html</code></p><ol><li>打開<code>xxx.html</code>，編輯你要留的部分</li><li><code>git add xxx.html</code>，加入索引</li><li><code>git commit -m &#39;merge ...&#39;</code></li></ol><h3 id="臨時狀況"><a href="#臨時狀況" class="headerlink" title="臨時狀況"></a>臨時狀況</h3><p>常遇到臨時狀況，需要放下手上的東西，支援其他人</p><ul><li>狀況一：寫到一半，臨時被叫去修BUG，要切換<code>branch</code>怎麼辦？</li><li>狀況二： 想切換 <code>branch</code>、<code>坐時光機回到commit歷史紀錄</code>，但手上才寫到一半，我也不想commit</li></ul><ol><li><code>git add .</code></li><li><code>git commit -m &#39;Not finish yet ORZ &quot;&#39;</code></li></ol><p>可是，難道只能先<code>commit</code>嗎？可是還沒完整寫完啊，我不想<code>commit</code>，<code>git log</code> 會變很亂！</p><h4 id="雜事放一旁，先救火再說！"><a href="#雜事放一旁，先救火再說！" class="headerlink" title="雜事放一旁，先救火再說！"></a>雜事放一旁，先救火再說！</h4><p><code>git stash</code>就像是把手邊還沒整理好的東西，先全部放在一個箱子裡，等有空時再去箱子拿回來繼續處理。</p><ol><li><code>git stash save &quot;RWDmobile&quot;</code><br>把手邊的資料全部放進RWDmobile的箱子裡</li><li><code>git stash pop &quot;名字&quot;</code><br>終於忙完了，回來繼續整理，取回RWDmobile的箱子，並把箱子丟掉。</li><li><code>git stash drop</code><br>把箱子和裡面的資料，都一起丟掉。</li><li><code>git stash apply 名字</code><br>和pop一樣，取回箱子的資料，但不把箱子丟掉。</li><li><code>git stash list</code><br>查詢我有幾個暫存的箱子</li></ol><h4 id="我commit了，但我想修改commit的訊息"><a href="#我commit了，但我想修改commit的訊息" class="headerlink" title="我commit了，但我想修改commit的訊息"></a>我commit了，但我想修改commit的訊息</h4><ul><li>只能修改 HEAD 上的 commit(目前git 最後一個commit的位置)</li><li>ammend是修改的意思。<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">git <span class="hljs-keyword">commit</span> <span class="hljs-comment">--amend</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="Git-竄改-Commit-紀錄"><a href="#Git-竄改-Commit-紀錄" class="headerlink" title="Git 竄改 Commit 紀錄"></a>Git 竄改 Commit 紀錄</h3><p>想竄改紀錄？請找專家認證的「<code>Git rebase -i</code>」</p><h4 id="使用情境"><a href="#使用情境" class="headerlink" title="使用情境"></a>使用情境</h4><ol><li>我想修改 commit 的順序</li><li>我想整理 branch 上的commit</li><li>我想先把某個 branch 上的 commit 先 merge 回 master</li><li>我想合併 commit，避免太過瑣碎的 commit<h3 id="Git-rebase-能做的事"><a href="#Git-rebase-能做的事" class="headerlink" title="Git rebase 能做的事"></a>Git rebase 能做的事</h3></li></ol><ul><li>重新 commit ( <code>Pick</code>)</li><li>更換 commit 順序</li><li>修改 commit 順序 (<code>Edit</code>)</li><li>拆解 commit (把多個commit紀錄變成一個commit)</li><li>壓縮 commit，合併 commit 訊息 (<code>Squash</code>)</li><li>刪除 commit (<code>Skip</code>)</li></ul><p><code>squash</code><br>把現在的 commit 和 上一個 commit 合併<br><code>fixup</code><br>也是合併 上一個 commit ，但不會保存 commit 的訊息</p><h3 id="把多個-commit-紀錄合併成一個"><a href="#把多個-commit-紀錄合併成一個" class="headerlink" title="把多個 commit 紀錄合併成一個"></a>把多個 commit 紀錄合併成一個</h3><ul><li>方法一</li></ul><ol><li><code>git stash</code><br>暫存把目前修改的資料通通先封裝進 stash 箱子</li><li><code>git reset 2q542f</code><br>坐時光機回到過去，回到 2q542f 版本</li><li><code>git stash pop</code><br>把箱子裡的資料重新拿出來，所以現在是 2q542f 版本 +上剛剛從 stash箱子拿出來的資料</li><li>重新 commit !<br><code>git add</code><br><code>git commit -m &#39;Message&#39;</code></li></ol><ul><li>方法二</li></ul><ol><li><code>git rebase -i de534f</code></li><li>用 <code>squash</code> merge 3 commits into 1 comit</li></ol><h3 id="Rebase完後悔"><a href="#Rebase完後悔" class="headerlink" title="Rebase完後悔"></a>Rebase完後悔</h3><p>已經 rebase 竄改完紀錄，但一時眼花看錯，需要還原，對我就是後悔了，該怎麼辦？</p><h4 id="git-reflog"><a href="#git-reflog" class="headerlink" title="git reflog"></a>git reflog</h4><p>輸入<code>git reflog</code>後會出現像<code>git log --oneline</code> 頁面<br><code>git reset --hard HEAD@&#123;3&#125;</code><br>根據上面的流水編號或bceefbc值，選你想要回復的位置</p><h4 id="將追蹤的某個檔案回復成上一次-commit-狀態"><a href="#將追蹤的某個檔案回復成上一次-commit-狀態" class="headerlink" title="將追蹤的某個檔案回復成上一次 commit 狀態"></a>將追蹤的某個檔案回復成上一次 commit 狀態</h4><p><code>git checkout -- user.html.erb</code></p><h4 id="所有已加入git-addtrack中，修改過的檔案，復原成最近一次commit-狀態"><a href="#所有已加入git-addtrack中，修改過的檔案，復原成最近一次commit-狀態" class="headerlink" title="所有已加入git addtrack中，修改過的檔案，復原成最近一次commit 狀態"></a>所有已加入<code>git add</code>track中，修改過的檔案，復原成最近一次commit 狀態</h4><p><code>git checkout .</code></p><h4 id="從某個-commit-切回原本-branch"><a href="#從某個-commit-切回原本-branch" class="headerlink" title="從某個 commit 切回原本 branch"></a>從某個 commit 切回原本 branch</h4><p><code>git checkout -</code></p><h4 id="將-某branch-裡的-某個-commit-的變動-merge-到另一條-branch"><a href="#將-某branch-裡的-某個-commit-的變動-merge-到另一條-branch" class="headerlink" title="將 某branch 裡的 某個 commit 的變動 merge 到另一條 branch"></a>將 某branch 裡的 某個 commit 的變動 merge 到另一條 branch</h4><p>EX: develop 想 merge feature的 #bceefbc commit進來<br><code>git cherry-pick</code></p><h3 id="Git-協作流程"><a href="#Git-協作流程" class="headerlink" title="Git 協作流程"></a>Git 協作流程</h3><p>開發新功能或跟別人協作git時</p><ol><li>新建一個獨立的分支</li><li>提交分支的 commit</li><li>要時常跟上遠端的腳步，與遠端Responsitory 同步<br><code>commit前，pull！push前，也pull！</code><h4 id="pull！pull！pull！pull！-壞掉了嗎？"><a href="#pull！pull！pull！pull！-壞掉了嗎？" class="headerlink" title="pull！pull！pull！pull！(壞掉了嗎？)"></a>pull！pull！pull！pull！(壞掉了嗎？)</h4><code>git pull --rebase</code><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">1.</span> git pull<br><span class="hljs-bullet">2.</span> git commit<br><span class="hljs-bullet">3.</span> git pull<br><span class="hljs-bullet">4.</span> git push<br></code></pre></td></tr></table></figure></li><li>合併 commit<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">git fetch origin<br>git rebase origin/<span class="hljs-keyword">master</span><br><span class="hljs-title">或是</span><br><span class="hljs-title">git</span> pull origin <span class="hljs-keyword">master</span> <span class="hljs-title">--rebase</span><br></code></pre></td></tr></table></figure></li></ol><h3 id="Merge-後的訊息好多餘，有辦法簡略嗎？"><a href="#Merge-後的訊息好多餘，有辦法簡略嗎？" class="headerlink" title="Merge 後的訊息好多餘，有辦法簡略嗎？"></a>Merge 後的訊息好多餘，有辦法簡略嗎？</h3><p>branch 要 merge origin/master，都會有個 merge commit ‘Merge branch ‘master’’ ，太多餘了！ 這種多餘節點很阿雜，能不能不看到？</p><p>輸入<code>git pull --rebase</code> 就會使 merge 每次的 commit 不見</p><blockquote><p>輸入的前提：使用–rebase是在沒有 conflict 的情況下才使用</p></blockquote><p>真不湊巧，使用 –rebase 結果 conflict 了<br><code>git rebase --abort</code> 回復 pull 前的狀態<br><code>git merge origin master</code> 不過就會有多餘的merge message出現</p><p><code>git pull --rebase</code><br>它等於以下兩步<br>git fetch<br>git merge origin </p><h4 id="git-pull-rebase-是什麼意思？"><a href="#git-pull-rebase-是什麼意思？" class="headerlink" title="git pull --rebase 是什麼意思？"></a><code>git pull --rebase</code> 是什麼意思？</h4><ol><li>把 commit 但還沒 push 上去的東西暫存丟到旁邊去</li><li>現在的 commit 非常乾淨，Git表示：沒有東西要push上去</li><li>從遠端 repo 把新的東西 pull 下來，跟上進度。此時你本地端是沒有任何要 push 的 commit，所以也不會有因為有東西還沒 push 所以無法 pull 的情況</li><li>再把那些待 push 的 commit 更動過的檔案 回復回來</li></ol><p>有 commit 還沒 push -&gt; 想要 pull 同步 遠端repo<br>變成 輸入 <code>git pull --rebase</code> 指令後<br>把 還沒 push 的 commit 存起來，本地端沒東西 push  -&gt; 先 pull同步 -&gt; 接著變成同步遠端了，目前還有 commit 還沒 push</p><h3 id="Reference-參考資料"><a href="#Reference-參考資料" class="headerlink" title="Reference | 參考資料"></a>Reference | 參考資料</h3><ul><li><a href="https://qiita.com/vc7/items/6e06b0306c8a64a23263">Git Merge &amp; Fast-forward</a></li><li><a href="http://blog.jex.tw/blog/2013/07/21/git/">Git 常用指令</a></li><li><a href="https://ihower.tw/blog/archives/3843">使用 git rebase 避免無謂的 merge</a></li><li><a href="https://www.slideshare.net/pokaichang72/git-42427674">史上最簡單易懂的Git教學：Git 實務圖解</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端工程師一定要會的：Sass Mixin神器</title>
      <link href="//%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%B8%AB%E4%B8%80%E5%AE%9A%E8%A6%81%E6%9C%83%E7%9A%84%EF%BC%9ASass-Mixin%E7%A5%9E%E5%99%A8/"/>
      <url>//%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%B8%AB%E4%B8%80%E5%AE%9A%E8%A6%81%E6%9C%83%E7%9A%84%EF%BC%9ASass-Mixin%E7%A5%9E%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>Sass Mixin 神器，學會 Mixin 可以讓你在開發上的速度加快許多，快來看看如何使用吧</p><h4 id="Sass-Mixin-主要功能"><a href="#Sass-Mixin-主要功能" class="headerlink" title="Sass Mixin 主要功能"></a>Sass Mixin 主要功能</h4><p>Sass Mixin 主要功能：省去重複撰寫相同 CSS 的時間</p><ul><li>降低Pseudo(偽)元素撰寫時的重複性</li><li>重用群組的 CSS，像是prefix，用<code>@include</code>加入群組</li><li>透過<code>@include</code>使用參數</li></ul><h3 id="示範SASS運用"><a href="#示範SASS運用" class="headerlink" title="示範SASS運用"></a>示範SASS運用</h3><h4 id="情境一"><a href="#情境一" class="headerlink" title="情境一"></a>情境一</h4><blockquote><p>當你在開發時設計.introduce Class時，結果設計師跟你說：這個背景顏色好醜，我們需要改顏色、整體網站都要更改一下，天啊真是晴天霹靂！這樣改要整個大修耶，別怕別怕！還有Mixin來幫你大幅節省時間！</p></blockquote><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">$font-size: <span class="hljs-number">14</span>px<br>@<span class="hljs-keyword">mixin</span> bg<br>background: #<span class="hljs-number">000</span><br>font-size: $font-size<br>.header<br>+bg<br></code></pre></td></tr></table></figure><p>SASS轉譯成CSS後，原始碼會變這樣</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.header</span> &#123;<br><span class="hljs-attribute">background</span>: <span class="hljs-number">#000</span>;<br><span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>是不是快多了呢！！！<br>寫法：@mixin 命名名稱，需要載入的話就是用「+」來載入mixin名稱</p><h4 id="情境二"><a href="#情境二" class="headerlink" title="情境二"></a>情境二</h4><blockquote><p> 設計師說：背景顏色要隨著網站活動變更，整體網站顏色可能會每隔三四個月都要改一次，你會傻傻的一個一個找header改嗎？當然不！拿起我們的秘密武器Mixin吧<br>在Mixin裡建立變數</p></blockquote><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-variable">$font</span>-size: <span class="hljs-number">13px</span><br><span class="hljs-variable">$linkcolor</span>: <span class="hljs-number">#d6b161</span><br><span class="hljs-variable">$textcolor</span>: <span class="hljs-number">#eee</span><br><span class="hljs-comment">// 在Mixin裡建立變數，並帶入</span><br><span class="hljs-keyword">@mixin</span> bg(<span class="hljs-variable">$bgcolor</span>)<br><span class="hljs-attribute">background</span>: <span class="hljs-variable">$bgcolor</span><br><span class="hljs-attribute">font-size</span>: <span class="hljs-variable">$font</span>-size<br><span class="hljs-selector-class">.header</span><br>+bg(<span class="hljs-variable">$linkcolor</span>)<br><span class="hljs-selector-class">.content</span><br>+bg(<span class="hljs-variable">$textcolor</span>)<br></code></pre></td></tr></table></figure><p>SASS轉譯成CSS後，原始碼會變這樣</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.header</span> &#123;<br><span class="hljs-attribute">background</span>: <span class="hljs-number">#d6b161</span>;<br><span class="hljs-attribute">font-size</span>: <span class="hljs-number">13px</span>;<br>&#125;<br><span class="hljs-selector-class">.content</span> &#123;<br><span class="hljs-attribute">background</span>: white;<br><span class="hljs-attribute">font-size</span>: <span class="hljs-number">13px</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>這樣我們可以直接在帶入變數，隨時更改顏色！超方便！</p><blockquote><ul><li>情境三<br>設計師：「我們再來大改吧！包含RWD也要一起動哦」<br>前端工程師：「天啊！我今晚又無法準時下班啦」</li></ul></blockquote><h3 id="關於Responsive-Web-Design"><a href="#關於Responsive-Web-Design" class="headerlink" title="關於Responsive Web Design"></a>關於Responsive Web Design</h3><p>RWD的@media 動則就是寫上千行，想辦法從min 768px裡找出要改的樣式，是件非常超級麻煩的事，一樣來用Mixin來大量減輕負擔吧</p><ul><li>傳統寫法</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-keyword">@media</span> all <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">980px</span>) &#123;<br><span class="hljs-selector-class">.box1</span> &#123;<br><span class="hljs-attribute">margin</span>: <span class="hljs-number">50px</span>;<br>    &#125;<br>    <span class="hljs-selector-class">.box2</span> &#123;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">30px</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">@media</span> all <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">768px</span>) &#123;<br><span class="hljs-selector-class">.box1</span> &#123;<br><span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span>;<br>    &#125;<br>    <span class="hljs-selector-class">.box2</span> &#123;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">15px</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">@media</span> all <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">996px</span>) <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">1200px</span>) &#123;<br><span class="hljs-selector-class">.box1</span> &#123;<br><span class="hljs-attribute">margin</span>: <span class="hljs-number">100px</span>;<br>    &#125;<br>    <span class="hljs-selector-class">.box2</span> &#123;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">75px</span>;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>是的，我以前就是這樣寫，當我要找桌機版的.box1去修改時</p><ol><li>要先找到<code>@media min-width:996px and max-width: 1200px</code></li><li>再從裡面找到class box1</li></ol><p>你會找老半天，有可能還會看錯改到平板模式的樣式<br>整體非常沒有效率也很耗時，你還會很傷眼力。<br>有個辦法：把三個@media查詢樣式時整合寫在一起，既好寫又好找！</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-class">.box1</span> &#123;<br><span class="hljs-keyword">@media</span> all <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">980px</span>) &#123;<br><span class="hljs-attribute">margin</span>: <span class="hljs-number">50px</span><br>&#125;<br><span class="hljs-keyword">@media</span> all <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">768px</span>) &#123;<br>        <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span>;<br>    &#125;<br>   <span class="hljs-keyword">@media</span> all <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">996px</span>) <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">1200px</span>) &#123;<br>        <span class="hljs-attribute">margin</span>: <span class="hljs-number">100px</span>;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="運用Mixin和變數幫助你減輕眼力負擔"><a href="#運用Mixin和變數幫助你減輕眼力負擔" class="headerlink" title="運用Mixin和變數幫助你減輕眼力負擔"></a>運用Mixin和變數幫助你減輕眼力負擔</h4><ul><li>先針對media設變數，設定各裝置的寬度width<br>  <code>$pc-width: 996px;</code><br>  <code>$pad-width: 768pz;</code></li><li>新增一位叫「pc-width」的mixin，把@media公式代進去，會變更的值填入變數$pc-width</li><li>在.box1裡用@include來呼叫Mixin：pc-width<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-variable">$pc-width</span>: <span class="hljs-number">996px</span>;<br><span class="hljs-variable">$pad-width</span>: <span class="hljs-number">768px</span>;<br><span class="hljs-variable">$pcs-width</span>: <span class="hljs-number">995px</span>;<br><br><span class="hljs-keyword">@mixin</span> pc-width()&#123;<br><span class="hljs-keyword">@media</span> all <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-variable">$pc-width</span>) &#123;<br><span class="hljs-keyword">@content</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">@mixin</span> pad-width()&#123;<br><span class="hljs-keyword">@media</span> all <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-variable">$pad-width</span>) <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-variable">$pcs-width</span>) &#123;<br><span class="hljs-keyword">@content</span>;<br>&#125;<br>&#125;<br><span class="hljs-comment">// 代入後長這樣</span><br><span class="hljs-selector-class">.box1</span> &#123;<br><span class="hljs-keyword">@include</span> pc-width &#123;<br><span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span>;<br>&#125;<br><span class="hljs-keyword">@include</span> pad-width &#123;<br><span class="hljs-attribute">margin</span>: <span class="hljs-number">15px</span>;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure>程式碼呢就會長這樣</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-selector-class">.box1</span> &#123;<br><span class="hljs-keyword">@media</span> all <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">996px</span>) &#123;<br><span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span>;<br>&#125;<br><span class="hljs-keyword">@media</span> all <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">768px</span>) <span class="hljs-keyword">and</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">995px</span>) &#123;<br><span class="hljs-attribute">margin</span>: <span class="hljs-number">15px</span>;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>是不是少掉很多的程式碼！！！</p><h4 id="顏色想要深一點？懶得挑色碼？這也沒問題"><a href="#顏色想要深一點？懶得挑色碼？這也沒問題" class="headerlink" title="顏色想要深一點？懶得挑色碼？這也沒問題"></a>顏色想要深一點？懶得挑色碼？這也沒問題</h4><blockquote><p>用darken(顏色, 深度)</p></blockquote><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-variable">$link</span>: <span class="hljs-number">#d6b161</span>;<br><span class="hljs-selector-class">.box1</span> &#123;<br><span class="hljs-attribute">background</span>: darken(<span class="hljs-variable">$link</span>, <span class="hljs-number">15%</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://blog.hellosanta.com.tw/%E7%B6%B2%E7%AB%99%E8%A8%AD%E8%A8%88/%E5%89%8D%E7%AB%AF/%E4%BD%BF%E7%94%A8sass-mixin%E4%BE%86%E9%96%8B%E7%99%BCresponsive%E7%B6%B2%E7%AB%99">使用sass mixin來開發responsive網站</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Front-end </tag>
            
            <tag> Sass </tag>
            
            <tag> Mixin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VS Code 使用erb類型檔案時，Emmet快捷打html標籤跳不出來</title>
      <link href="//VS-Code-%E4%BD%BF%E7%94%A8erb%E9%A1%9E%E5%9E%8B%E6%AA%94%E6%A1%88%E6%99%82%EF%BC%8CEmmet%E5%BF%AB%E6%8D%B7%E6%89%93html%E6%A8%99%E7%B1%A4%E8%B7%B3%E4%B8%8D%E5%87%BA%E4%BE%86/"/>
      <url>//VS-Code-%E4%BD%BF%E7%94%A8erb%E9%A1%9E%E5%9E%8B%E6%AA%94%E6%A1%88%E6%99%82%EF%BC%8CEmmet%E5%BF%AB%E6%8D%B7%E6%89%93html%E6%A8%99%E7%B1%A4%E8%B7%B3%E4%B8%8D%E5%87%BA%E4%BE%86/</url>
      
        <content type="html"><![CDATA[<p><img src="http://codelikeapoem.com/wp-content/uploads/2017/11/Visual-Studio-Code-For-Windows.jpg" alt=""></p><h3 id="問題：使用VS-code-erb-無法自動跳出Emmet"><a href="#問題：使用VS-code-erb-無法自動跳出Emmet" class="headerlink" title="問題：使用VS code erb 無法自動跳出Emmet"></a>問題：使用VS code erb 無法自動跳出Emmet</h3><p>從Sublime跳到使用VS Code，已很習慣用Emmet來跳html標籤，但在用RoR(Ruby on Rail)時，像是index.html.erb這類的檔案，打<code>.container</code> TAB鍵應該會自動跳出<code>&lt;div class=&quot;container&quot;&gt;&lt;/div&gt;</code>，卻毫無反應。</p><h4 id="加入一行設定輕鬆解決"><a href="#加入一行設定輕鬆解決" class="headerlink" title="加入一行設定輕鬆解決"></a>加入一行設定輕鬆解決</h4><p>在VS Code Setting裡加上這一行就可以搞定<br><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-string">&quot;emmet.includeLanguages&quot;</span>: &#123;<span class="hljs-string">&quot;erb&quot;</span>: <span class="hljs-string">&quot;html&quot;</span>&#125;<br></code></pre></td></tr></table></figure></p><h3 id="Reference-參考資料"><a href="#Reference-參考資料" class="headerlink" title="Reference | 參考資料"></a>Reference | 參考資料</h3><ul><li><a href="https://github.com/rubyide/vscode-ruby/issues/197">Emmet isn’t recognised in erb</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Rails 5 </tag>
            
            <tag> VS Code </tag>
            
            <tag> Emmet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rails 用 CarrierWave 大量產生假圖片 ( Remote image )</title>
      <link href="//Rails-%E7%94%A8-CarrierWave-%E5%A4%A7%E9%87%8F%E7%94%A2%E7%94%9F%E5%81%87%E5%9C%96%E7%89%87-Remote-image/"/>
      <url>//Rails-%E7%94%A8-CarrierWave-%E5%A4%A7%E9%87%8F%E7%94%A2%E7%94%9F%E5%81%87%E5%9C%96%E7%89%87-Remote-image/</url>
      
        <content type="html"><![CDATA[<p>我們常需要一些假資料來撐開版型、驗證，但一筆一筆新增很麻煩，所以會用到rake自訂任務請Rails一次幫忙產生500筆資料，但上傳圖片的image欄位是藉由Gem CarrierWave產生，所以需要用它提供的helper: remote-image_url</p><p>Strong Parameter 新增 CarrierWave 原生的help: remote_image_url<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-comment">#restaurant_controller</span><br>  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">restaurant_params</span></span><br>    params.<span class="hljs-keyword">require</span>(<span class="hljs-symbol">:restaurant</span>).permit(<span class="hljs-symbol">:name</span>, <span class="hljs-symbol">:tel</span>, <span class="hljs-symbol">:opening_hours</span>, <span class="hljs-symbol">:address</span>, <span class="hljs-symbol">:description</span>, <span class="hljs-symbol">:image</span>, <span class="hljs-symbol">:remote_image_url</span>)<br>  <span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure></p><h3 id="自動建立-500-筆資料"><a href="#自動建立-500-筆資料" class="headerlink" title="自動建立 500 筆資料"></a>自動建立 500 筆資料</h3><p>新增 Rake 任務 dev.rake，自動建立 500 筆餐廳資料<br>在Restaurant下使用remote_image_url，在後面加上遠端網址即可。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">Restaurant</span><span class="hljs-selector-class">.destroy_all</span><br><span class="hljs-selector-tag">Restaurant</span><span class="hljs-selector-class">.create</span>!(<span class="hljs-attribute">name</span>: <span class="hljs-string">&#x27;Andromeda&#x27;</span>, <span class="hljs-attribute">remote_photo_url</span>: <span class="hljs-string">&#x27;https://visualhunt.com/photos/l/7/architecture-store-building.jpg&#x27;</span>)<br></code></pre></td></tr></table></figure><p>整體檔案會像是這樣，另外用FFaker Gem來產生像電話地址的假資料<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs elixir">namespace <span class="hljs-symbol">:dev</span> <span class="hljs-keyword">do</span><br>  task <span class="hljs-symbol">fake:</span> <span class="hljs-symbol">:environment</span> <span class="hljs-keyword">do</span><br>    Restaurant.destroy_all<br><br>    <span class="hljs-number">500</span>.times <span class="hljs-keyword">do</span> |i|<br>      Restaurant.create!(<span class="hljs-symbol">name:</span> FFaker::Name.first_name,<br>        <span class="hljs-symbol">opening_hours:</span> FFaker::Time.datetime,<br>        <span class="hljs-symbol">tel:</span> FFaker::PhoneNumber.short_phone_number,<br>        <span class="hljs-symbol">address:</span> FFaker::Address.street_address,<br>        <span class="hljs-symbol">description:</span> FFaker::Lorem.paragraph,<br>        <span class="hljs-symbol">category:</span> Category.all.sample,<br>        <span class="hljs-symbol">remote_image_url:</span> <span class="hljs-string">&#x27;https://visualhunt.com/photos/l/7/architecture-store-building.jpg&#x27;</span><br>      )<br>    <span class="hljs-keyword">end</span><br>    puts <span class="hljs-string">&quot;餐廳資料成功建立&quot;</span><br>    puts <span class="hljs-string">&quot;You have <span class="hljs-subst">#&#123;Restaurant.count&#125;</span> restaurants data&quot;</span><br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure></p><h3 id="用亂數隨機讀取圖片"><a href="#用亂數隨機讀取圖片" class="headerlink" title="用亂數隨機讀取圖片"></a>用亂數隨機讀取圖片</h3><p>但是只有一張照片好像很單調，那就改成本端檔案吧<br>將圖片放到public底下的目錄，檔案命名為0.jpg~20.jpg<br>以亂數來隨機存取圖片<br><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"># dev.rake<br>image: <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">File</span>.</span></span><span class="hljs-keyword">open</span>(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Rails</span>.</span></span>root.join(<span class="hljs-string">&quot;public/seed-img/0#&#123;rand(1..9)&#125;.jpg&quot;</span>))<br></code></pre></td></tr></table></figure><br><a href="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/12/30231913/Screen-Shot-2017-12-30-at-11.12.01-PM.png"><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/12/30231913/Screen-Shot-2017-12-30-at-11.12.01-PM-1024x558.png" alt=""></a></p><p>Reference</p><ul><li><a href="https://github.com/carrierwaveuploader/carrierwave/wiki/How-to:-Upload-remote-image-urls-to-your-seedfile">How to: Upload remote image urls to your seedfile</a></li><li><a href="https://www.rails365.net/articles/carrierwave-tu-pian-shang-chuan-he-tu-pian-te-shu-chu-li">CarrierWave 图片上传和图片特殊处理</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Rails 5 </tag>
            
            <tag> CarrierWave </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript 30 Day -  Day1 DrumKits 練習</title>
      <link href="//JavaScript-30-Day-Day1-DrumKits-%E7%B7%B4%E7%BF%92/"/>
      <url>//JavaScript-30-Day-Day1-DrumKits-%E7%B7%B4%E7%BF%92/</url>
      
        <content type="html"><![CDATA[<p>JavaScript 30 Day -  Day1 DrumKits</p><p>主題：用鍵盤按鍵，模擬打出爵士鼓的音效<br><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/12/29025908/Screen-Shot-2017-12-27-at-4.48.58-PM.png" alt=""></p><ul><li><a href="https://hazelwu2.github.io/JavaScript30/day1-DrumKit/index.html">DEMO</a></li><li><a href="https://github.com/Hazelwu2/JavaScript30">Github</a></li></ul><h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><h4 id="1-利用鍵盤監聽USER鍵盤，知道使用者按了哪個按鍵"><a href="#1-利用鍵盤監聽USER鍵盤，知道使用者按了哪個按鍵" class="headerlink" title="1. 利用鍵盤監聽USER鍵盤，知道使用者按了哪個按鍵"></a>1. 利用鍵盤監聽USER鍵盤，知道使用者按了哪個按鍵</h4><p><code>window.addEventListerer(&#39;keydown&#39;, playSound);</code></p><h4 id="2-設定-function-playSound-e"><a href="#2-設定-function-playSound-e" class="headerlink" title="2. 設定 function playSound(e)"></a>2. 設定 function playSound(e)</h4><ul><li>將函數e傳入進去，利用e.keyCode取得對應的audio音檔、div data-key標籤。</li><li>如果傳入的e.keyCode沒有對應的audio，便中斷function。</li><li>設定audio音檔無延遲，播放時間為0。<br><code>currentTime = 0;</code></li><li>播放對應的音檔。</li><li>利用<code>classList.add(&#39;playing&#39;)</code>將div.key加入playing的class。<br><code>classList.add(&#39;class&#39;) 等同於 jQuery 的 addClass(&#39;class&#39;)</code>。</li></ul><h4 id="3-將所有div-key組合成陣列，監聽：當播放完音效後，會停止transform的特效。"><a href="#3-將所有div-key組合成陣列，監聽：當播放完音效後，會停止transform的特效。" class="headerlink" title="3. 將所有div.key組合成陣列，監聽：當播放完音效後，會停止transform的特效。"></a>3. 將所有div.key組合成陣列，監聽：當播放完音效後，會停止transform的特效。</h4><ul><li>利用<code>querySelectorAll(&#39;.key&#39;)</code>組合起來存在變數keys裡面，querySelectorAll組合的div.key是一個陣列組合。    </li><li>利用<code>forEach</code>的JavaScript語法，將keys陣列取出每個div.key，並設定監聽：若transitionend發生了，執行removeTransition的function。</li></ul><h4 id="4-設定removeTransition-的-function，當發生transform效果時則中斷。"><a href="#4-設定removeTransition-的-function，當發生transform效果時則中斷。" class="headerlink" title="4. 設定removeTransition 的 function，當發生transform效果時則中斷。"></a>4. 設定removeTransition 的 function，當發生transform效果時則中斷。</h4><ul><li>將函數e傳入，倘若e.propertyName != transform時則中斷。</li><li>同時也移除playing的class，利用<code>classList.remove(&#39;class&#39;)</code>，等同於 jQuery 的 <code>removeClass(&#39;class&#39;)</code>。</li></ul><h3 id="HTML架構"><a href="#HTML架構" class="headerlink" title="HTML架構"></a>HTML架構</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;keys&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;65&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>Clap<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;audio <span class="hljs-attribute">data-key</span>=<span class="hljs-string">&quot;65&quot;</span> <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;sounds/hihat.wav&quot;</span>&gt;&lt;/audio&gt;<br></code></pre></td></tr></table></figure><h3 id="JavaScript部分"><a href="#JavaScript部分" class="headerlink" title="JavaScript部分"></a>JavaScript部分</h3><h4 id="設定對應的audio音檔"><a href="#設定對應的audio音檔" class="headerlink" title="設定對應的audio音檔"></a>設定對應的audio音檔</h4><p>利用<code>document.querySelector</code>來選擇audio[data-key]，因為keyCode有九種按鈕的設置，將keyCode設為變數，由e傳入找出屬性為.keyCode</p><h4 id="Audio-音檔無延遲、播放"><a href="#Audio-音檔無延遲、播放" class="headerlink" title="Audio 音檔無延遲、播放"></a>Audio 音檔無延遲、播放</h4><p>HTML5的 <code>audio</code>新標籤，IE 8 及以下版本都不支援<br><code>&lt;audio src=&quot;路徑/clap.mp3&quot;&gt;&lt;audio&gt;</code></p><p>透過JavaScript控制播放音樂<br><code>audio.play()</code>可以播放音檔<br><code>audio.currentTime()</code>指定播放的秒數<br>利用設定currentTime = 0，達到無延遲效果。</p><h4 id="用forEach-代替-for-迴圈"><a href="#用forEach-代替-for-迴圈" class="headerlink" title="用forEach 代替 for 迴圈"></a>用forEach 代替 for 迴圈</h4><p>第一次使用到JS的forEach，以往都是用for迴圈去跑每個元素，也意外發現forEach比起for迴圈還要整潔、快速！前提是：不打算更改陣列裡的每個元素，就可以使用forEach。<br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-built_in">var</span> arr = [ data1, data2, data3];<br><span class="hljs-keyword">for</span> ( <span class="hljs-built_in">var</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-built_in">length</span>; i++)&#123;<br>console.<span class="hljs-built_in">log</span>(arr[i]);<br>&#125;<br></code></pre></td></tr></table></figure><br>使用forEach是相同的效果，寫法也讓程式碼更加簡短了<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">var arr = [ data1, data2, data3];<br>arr.forEach(<span class="hljs-function"><span class="hljs-params">(val)</span> =&gt;</span> &#123;<br><span class="hljs-built_in">console</span>.log(arr[i]);<br>&#125;)<br></code></pre></td></tr></table></figure></p><h4 id="Arrow-Function-箭頭函式"><a href="#Arrow-Function-箭頭函式" class="headerlink" title="Arrow Function 箭頭函式"></a>Arrow Function 箭頭函式</h4><p>他是ES6版本的函式簡寫<br><code>() =&gt; &#123;&#125;</code>等同於 <code>function() &#123;&#125;</code>，但還是有一些區別。</p><h4 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h4><ul><li><a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Functions/Arrow_functions">MDN web docs - Arrow Function</a></li><li><a href="https://yami.io/reduce-foreach-filter-map/">在 JavaScript 棄用 For 迴圈，擁抱 Reduce、ForEach、Filter、Map</a></li><li><a href="https://eyesofkids.gitbooks.io/javascript-start-from-es6/content/part4/arrow_function.html">箭頭函式</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Rails 用 Bootstrap 快速客製化 alert &amp; notice flash message快閃訊息</title>
      <link href="//Rails-%E7%94%A8-Bootstrap-%E5%BF%AB%E9%80%9F%E5%AE%A2%E8%A3%BD%E5%8C%96-alert-notice-flash-message%E5%BF%AB%E9%96%83%E8%A8%8A%E6%81%AF/"/>
      <url>//Rails-%E7%94%A8-Bootstrap-%E5%BF%AB%E9%80%9F%E5%AE%A2%E8%A3%BD%E5%8C%96-alert-notice-flash-message%E5%BF%AB%E9%96%83%E8%A8%8A%E6%81%AF/</url>
      
        <content type="html"><![CDATA[<p><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/12/29113303/Screen-Shot-2017-12-29-at-11.29.32-AM.png" alt="卡了一條很醜的紅色alert訊息"><br>一般來說，需要使用會員系統會用Gem來安裝Device的套件，但可苦惱了，內建的flash message都會卡在上面，即使套上bootstrap的客製化，加上alert-info等的class，它仍會卡在頁面最上端，有一條長長橫橫的而且很醜，不會自動消失，這時候該怎麼辦呢？</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># 上述範例圖片的程式碼</span><br><span class="hljs-section">&lt;% alert %&gt;</span><br><span class="hljs-section">&lt;% notice %&gt;</span><br></code></pre></td></tr></table></figure><p>很簡單，我們多設一個條件式：如果alert或notice的flash訊息提醒出現，則幫我套上bootstrap的樣式。<br>bootstrap有幫我們客製化一個樣式，可以點擊Ｘ來關閉flash message，必須在<code>button</code>的屬性標籤裡確保有<code>data-dismiss=“alert&quot;</code>才可以正常運作。</p><figure class="highlight bnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bnf"><span class="hljs-attribute">&lt;% if alert %&gt;</span> <br>    程式碼<br><span class="hljs-attribute">&lt;% end %&gt;</span><br></code></pre></td></tr></table></figure><p>程式碼範例：</p><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs erb"><span class="xml">&lt;%</span><span class="ruby"> <span class="hljs-keyword">if</span> alert </span><span class="xml">%&gt;</span><br><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;alert alert-warning alert-dismissible&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;alert&quot;</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;close&quot;</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">&quot;alert&quot;</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">&quot;Close&quot;</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span>×<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Warning!<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>&lt;%=</span><span class="ruby"> alert </span><span class="xml">%&gt;</span><br><span class="xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml"> &lt;%</span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml">%&gt;</span><br><span class="xml"> &lt;%</span><span class="ruby"> <span class="hljs-keyword">if</span> notice </span><span class="xml">%&gt;</span><br><span class="xml">   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;alert alert-info&quot;</span> <span class="hljs-attr">role</span>=<span class="hljs-string">&quot;alert&quot;</span>&gt;</span></span><br><span class="xml">     <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;close&quot;</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">&quot;alert&quot;</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">&quot;Close&quot;</span>&gt;</span></span><br><span class="xml">     <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span>×<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="xml">     &lt;%=</span><span class="ruby"> notice </span><span class="xml">%&gt;</span><br><span class="xml">   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml"> &lt;%</span><span class="ruby"> <span class="hljs-keyword">end</span> </span><span class="xml">%&gt;</span><br></code></pre></td></tr></table></figure><h4 id="Rails-安裝-Bootstrap"><a href="#Rails-安裝-Bootstrap" class="headerlink" title="Rails 安裝 Bootstrap"></a>Rails 安裝 Bootstrap</h4><p>等等？可是我不知道Rails怎麼安裝 Bootstrap<br>請看此篇文章：「教你在Rails 快速安裝 Bootstrap，快速打造有質感的頁面」（仍還在寫中XD）</p><h4 id="完成圖"><a href="#完成圖" class="headerlink" title="完成圖"></a>完成圖</h4><p>套上Bootstrap button, CSS樣式效果後，變得更方便，也不會卡住一條在頁面最上端，同時覺得礙眼的話還可以直接點擊X關掉flash message！<br><img src="https://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/12/29113320/Screen-Shot-2017-12-29-at-11.23.25-AM.png" alt="迅速又方便"></p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://getbootstrap.com/docs/3.3/components/#alerts-dismissible" title="Bootstrap Alerts官方文件">Bootstrap Alert Message 官方文件</a></li><li><a href="https://medium.com/coding-and-web-development/bootstrap-components-added-for-alerts-and-notices-26b0048974ac">Bootstrap components added for alerts and notices</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Iframe modal關閉後，內嵌影片音效沒有停止</title>
      <link href="//Iframe-modal%E9%97%9C%E9%96%89%E5%BE%8C%EF%BC%8C%E5%85%A7%E5%B5%8C%E5%BD%B1%E7%89%87%E9%9F%B3%E6%95%88%E6%B2%92%E6%9C%89%E5%81%9C%E6%AD%A2/"/>
      <url>//Iframe-modal%E9%97%9C%E9%96%89%E5%BE%8C%EF%BC%8C%E5%85%A7%E5%B5%8C%E5%BD%B1%E7%89%87%E9%9F%B3%E6%95%88%E6%B2%92%E6%9C%89%E5%81%9C%E6%AD%A2/</url>
      
        <content type="html"><![CDATA[<h3 id="情境介紹"><a href="#情境介紹" class="headerlink" title="情境介紹"></a>情境介紹</h3><blockquote><p>Iframe modal關閉後，內嵌影片音效沒有停止<br>內套 Bootstrap 的 modal JS特效，燈箱內容放 iframe 內崁 Youtube，但發現關閉按鈕後，影片聲音仍繼續，畫面關閉了還是有聲音。</p></blockquote><p><img src="http://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/11/11230518/e693b7e58f962.png" alt="iframe-not-working" title="iframe-not-working"></p><h4 id="移除包含iframe節點"><a href="#移除包含iframe節點" class="headerlink" title="移除包含iframe節點"></a>移除包含iframe節點</h4><p>我試著用 Jquery 解決，移除整個包含iframe的節點</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-constructor">$(‘.<span class="hljs-params">close</span>-<span class="hljs-params">modal</span>’)</span>.on(‘click’,<span class="hljs-keyword">function</span><span class="hljs-literal">()</span>&#123;<br>    <span class="hljs-constructor">$(‘.<span class="hljs-params">modal</span>-<span class="hljs-params">body</span>’)</span>.remove<span class="hljs-literal">()</span>;<br>&#125;);<br></code></pre></td></tr></table></figure><ul><li>哈哈，是停止了沒錯，但好笑的是，如果user想重新開啟這個modal box就會穿幫，阿幹？阿影片勒怎麼不見了？這影片是用一次就消失喔？？？</li></ul><p>示意圖如下</p><p><img src="http://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/11/11230858/iframe-example.gif" alt="iframe-example" title="iframe-example"></p><p>detach()：可以移除元素，但完整保留事件</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-constructor">$(‘.<span class="hljs-params">close</span>-<span class="hljs-params">modal</span>’)</span>.on(‘click’,<span class="hljs-keyword">function</span><span class="hljs-literal">()</span>&#123;<br>    <span class="hljs-constructor">$(‘<span class="hljs-params">iframe</span>)</span>.detach<span class="hljs-literal">()</span>;<br>&#125;)<br></code></pre></td></tr></table></figure><ul><li>但一樣重新開啟頁面須要另寫jQ重新加回去。</li><li>有個更更更更更簡短的寫法，原理是抓到DOM元素後，將src重新再放入網址！就自動停了</li><li>這樣即使關掉頁面重開，也可以很完整呈現，也不用移除後還要再重新加入iframe</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-constructor">$(‘.<span class="hljs-params">close</span>-<span class="hljs-params">modal</span>’)</span>.on(‘click’,<span class="hljs-keyword">function</span><span class="hljs-literal">()</span>&#123;<br>  <span class="hljs-constructor">$(‘<span class="hljs-params">iframe</span>’)</span>.attr(‘src’,<br>         <span class="hljs-constructor">$(‘<span class="hljs-params">iframe</span>’)</span>.attr(‘src’));<br>&#125;);<br></code></pre></td></tr></table></figure><p>夠簡短吧，囧！學到一課了</p><h3 id="用attr設定src的屬性，取得src網址後再重新加載一次！"><a href="#用attr設定src的屬性，取得src網址後再重新加載一次！" class="headerlink" title="用attr設定src的屬性，取得src網址後再重新加載一次！"></a>用attr設定src的屬性，取得src網址後再重新加載一次！</h3><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-constructor">$(‘.<span class="hljs-params">close</span>-<span class="hljs-params">modal</span>,<span class="hljs-params">button</span>’)</span>.on(‘click’,<span class="hljs-keyword">function</span><span class="hljs-literal">()</span>&#123;<br>   <span class="hljs-constructor">$(‘<span class="hljs-params">iframe</span>’,)</span>.attr(‘src’,     <br>     <span class="hljs-constructor">$(‘<span class="hljs-params">iframe</span>’)</span>.attr(‘src’));<br>&#125;);<br></code></pre></td></tr></table></figure><p>同時選取兩組元素做click動作，只需要一個引號，中間用逗號隔開即可</p><p><img src="http://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/11/11230829/iframe-cannot-worked2-300x176.png" alt="ifream-mode-remoe-successful-pic"></p><h4 id="20171225更新"><a href="#20171225更新" class="headerlink" title="20171225更新"></a>20171225更新</h4><p>需要指定iframe取得的src連結，否則都會是拿到第一個modal的網址。<br>所以需要補宣告一個變數指定為當前開啟的iframe。</p><ol><li>狀態改成為當bootstrap的modal是隱藏狀態時（意味著：被使用者關閉了），將目前的iframe的網址拿掉，變空白。接著再將原有的影片網址重新塞回iframe的src屬性裡。</li><li>如何取得iframe的src網址？使用attr(‘src’)</li></ol><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs arcade">$(<span class="hljs-string">&#x27;.modal&#x27;</span>).on(<span class="hljs-string">&#x27;hidden.bs.modal&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-symbol">$iframe</span> = $(this).find(<span class="hljs-string">&#x27;iframe&#x27;</span>);<br>    <span class="hljs-keyword">var</span> videoSrc = <span class="hljs-symbol">$iframe</span>.attr(<span class="hljs-string">&#x27;src&#x27;</span>);<br>    console.log(videoSrc);<br>    <span class="hljs-symbol">$iframe</span>.attr(<span class="hljs-string">&#x27;src&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br>    <span class="hljs-symbol">$iframe</span>.attr(<span class="hljs-string">&#x27;src&#x27;</span>, videoSrc);<br>  &#125;);<br></code></pre></td></tr></table></figure><p>嘿嘿完成圖！打開縮圖可以得到一個modal燈箱，點擊兩個按鈕都可以做到關閉的效果，真開心！超有成就感。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>架Wordpress在本機，更改固定網址後掛了</title>
      <link href="//%E6%9E%B6Wordpress%E5%9C%A8%E6%9C%AC%E6%A9%9F%EF%BC%8C%E6%9B%B4%E6%94%B9%E5%9B%BA%E5%AE%9A%E7%B6%B2%E5%9D%80%E5%BE%8C%E6%8E%9B%E4%BA%86/"/>
      <url>//%E6%9E%B6Wordpress%E5%9C%A8%E6%9C%AC%E6%A9%9F%EF%BC%8C%E6%9B%B4%E6%94%B9%E5%9B%BA%E5%AE%9A%E7%B6%B2%E5%9D%80%E5%BE%8C%E6%8E%9B%E4%BA%86/</url>
      
        <content type="html"><![CDATA[<h1 id="架Wordpress在本機，更改固定網址後掛了"><a href="#架Wordpress在本機，更改固定網址後掛了" class="headerlink" title="架Wordpress在本機，更改固定網址後掛了"></a>架Wordpress在本機，更改固定網址後掛了</h1><h2 id="問題"><a href="#問題" class="headerlink" title="問題"></a>問題</h2><p>改完固定網址後就RIP了，天啊Godddd</p><p>嗯，在本機上剛成功架完wordpress後很開心的亂試一些功能，忘記應該要開啟git時光機才對。事情是這樣的：我改了固定網址變成： 文章名稱，結果就是點任何後台的連結都變成下載php的檔案…..download資料夾快爆了<br><span id="more"></span></p><h3 id="解決辦法："><a href="#解決辦法：" class="headerlink" title="解決辦法："></a>解決辦法：</h3><p>開啟.htaccess檔，找到這兩行刪掉！<br><code>AddHandler php56-cgi .php</code><br><code>AddHandler application/x-httpd-php70s .php</code><br>刪掉它，然後重新整理，會發現你的後台復活了。</p><p>記得，一定一定要記得<code>git init</code>才有保障啊，不然又要除錯到天亮了（？）</p><h2 id="Reference-參考資料"><a href="#Reference-參考資料" class="headerlink" title="Reference | 參考資料"></a>Reference | 參考資料</h2><p> <a href="https://stackoverflow.com/questions/2316610/php-files-are-downloaded-by-browser-instead-of-processed-by-local-dev-server-ma">PHP files are downloaded by browser instead of processed by local dev server (MAMP)</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Wordpress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>warning: LF will be replaced by CRLF in files？這什麼東西啦！</title>
      <link href="//warning-LF-will-be-replaced-by-CRLF-in-files%EF%BC%9F%E9%80%99%E4%BB%80%E9%BA%BC%E6%9D%B1%E8%A5%BF%E5%95%A6%EF%BC%81/"/>
      <url>//warning-LF-will-be-replaced-by-CRLF-in-files%EF%BC%9F%E9%80%99%E4%BB%80%E9%BA%BC%E6%9D%B1%E8%A5%BF%E5%95%A6%EF%BC%81/</url>
      
        <content type="html"><![CDATA[<p>有沒有遇過git add加入索引時，突然跳出這樣的訊息？</p><blockquote><p>warning: LF will be replaced by CRLF in files.</p></blockquote><p>我遇到的情境是這樣的，咳：<br>在Wordpress進入<code>git init</code>版本控制後，<br>出現一大堆奇怪的字樣，如果說是線上遊戲的公頻，它整個就是把我的iTerm2徹底大洗版啊啊啊！！！！一直廣播是怎樣</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">warning: LF will be replaced <span class="hljs-keyword">by</span> <span class="hljs-literal">CRLF</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">files</span>.<br>The <span class="hljs-built_in">file</span> will have its original <span class="hljs-built_in">line</span> endings <span class="hljs-keyword">in</span> your working <span class="hljs-built_in">directory</span>.<br>warning: LF will be replaced <span class="hljs-keyword">by</span> <span class="hljs-literal">CRLF</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">files</span>.<br>The <span class="hljs-built_in">file</span> will have its original <span class="hljs-built_in">line</span> endings <span class="hljs-keyword">in</span> your working <span class="hljs-built_in">directory</span>.<br>warning: LF will be replaced <span class="hljs-keyword">by</span> <span class="hljs-literal">CRLF</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">files</span>.<br>The <span class="hljs-built_in">file</span> will have its original <span class="hljs-built_in">line</span> endings <span class="hljs-keyword">in</span> your working <span class="hljs-built_in">directory</span>.<br>warning: LF will be replaced <span class="hljs-keyword">by</span> <span class="hljs-literal">CRLF</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">files</span>.<br>The <span class="hljs-built_in">file</span> will have its original <span class="hljs-built_in">line</span> endings <span class="hljs-keyword">in</span> your working <span class="hljs-built_in">directory</span>.<br>warning: LF will be replaced <span class="hljs-keyword">by</span> <span class="hljs-literal">CRLF</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">files</span>.<br>The <span class="hljs-built_in">file</span> will have its original <span class="hljs-built_in">line</span> endings <span class="hljs-keyword">in</span> your working <span class="hljs-built_in">directory</span>.<br></code></pre></td></tr></table></figure><p>做了一些功課才知道</p><h3 id="什麼是LF？"><a href="#什麼是LF？" class="headerlink" title="什麼是LF？"></a>什麼是LF？</h3><p>它是ASCII 10電腦編碼系統，換行符號：<code>\n</code><br>簡單無腦的來說<code>LF = \n</code></p><h3 id="什麼是CRLF？"><a href="#什麼是CRLF？" class="headerlink" title="什麼是CRLF？"></a>什麼是CRLF？</h3><p>ASCII 13的電腦編碼系統，他和LF比較不一樣的是多了<code>\r</code><br>沒錯，它就是用<code>\r\n</code>進行換行的，</p><h4 id="既然-n就能換行，何必多浪費兩個字元-n-r來換行？"><a href="#既然-n就能換行，何必多浪費兩個字元-n-r來換行？" class="headerlink" title="既然\n就能換行，何必多浪費兩個字元\n\r來換行？"></a>既然<code>\n</code>就能換行，何必多浪費兩個字元<code>\n\r</code>來換行？</h4><p>節省空間嘛！Git很聰明的想要節省空間，紀錄檔案時對於換行都是採\n的方式<br>所以釋出這訊息是為了要讓工程屍知道一下（？）善意的提醒。</p><h4 id="原本檔案是CRLF，Git轉換成LF，那會有什麼影響嗎？"><a href="#原本檔案是CRLF，Git轉換成LF，那會有什麼影響嗎？" class="headerlink" title="原本檔案是CRLF，Git轉換成LF，那會有什麼影響嗎？"></a>原本檔案是CRLF，Git轉換成LF，那會有什麼影響嗎？</h4><p>在unix系統上，若從git上拿到檔案，程式碼就永遠是LF格式了，再也回不去CRLF了。</p><h3 id="關閉警告指令"><a href="#關閉警告指令" class="headerlink" title="關閉警告指令"></a>關閉警告指令</h3><p>若是覺得沒有關係，想關閉這個警告訊息輸入下列指令就好了。<br><code>git config core.autocrlf true</code></p><h3 id="Reference-參考資料"><a href="#Reference-參考資料" class="headerlink" title="Reference | 參考資料"></a>Reference | 參考資料</h3><ul><li><a href="https://stackoverflow.com/questions/5834014/lf-will-be-replaced-by-crlf-in-git-what-is-that-and-is-it-important">LF will be replaced by CRLF in git - What is that and is it important? </a></li><li><a href="https://shazi.info/git-%E5%9C%A8-windows-%E9%80%B2%E8%A1%8C-add-%E5%87%BA%E7%8F%BE%E8%AD%A6%E5%91%8A%E3%80%8Cwarning-lf-will-be-replaced-by-crlf%E3%80%8D/">Git 在 Windows 進行 add 出現警告「warning: LF will be replaced by CRLF</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git revert到commit某一版本，Gemfile不會跟著還原，–without development的緣故。</title>
      <link href="//git-revert%E5%88%B0commit%E6%9F%90%E4%B8%80%E7%89%88%E6%9C%AC%EF%BC%8CGemfile%E4%B8%8D%E6%9C%83%E8%B7%9F%E8%91%97%E9%82%84%E5%8E%9F%EF%BC%8C%E2%80%93without-development%E7%9A%84%E7%B7%A3%E6%95%85%E3%80%82/"/>
      <url>//git-revert%E5%88%B0commit%E6%9F%90%E4%B8%80%E7%89%88%E6%9C%AC%EF%BC%8CGemfile%E4%B8%8D%E6%9C%83%E8%B7%9F%E8%91%97%E9%82%84%E5%8E%9F%EF%BC%8C%E2%80%93without-development%E7%9A%84%E7%B7%A3%E6%95%85%E3%80%82/</url>
      
        <content type="html"><![CDATA[<h2 id="bundle-install-with-development-使用注意事項"><a href="#bundle-install-with-development-使用注意事項" class="headerlink" title="bundle install -with development 使用注意事項"></a>bundle install -with development 使用注意事項</h2><blockquote><p>某次經驗談：準備將Rails的專案部署Deploy到遠端VPS Server，改檔案改到爛掉於是只好gir revert 還原到上上上上上次的版本，結果囧了發現Gemfile,database.yml不會跟著還原，原本資料庫設定是pg，因要更改production環境時的資料庫變成Mysql2<br><span id="more"></span></p></blockquote><h3 id="git-revert-還原到上上上次版本-使用情境"><a href="#git-revert-還原到上上上次版本-使用情境" class="headerlink" title="git revert 還原到上上上次版本 使用情境"></a>git revert 還原到上上上次版本 使用情境</h3><ul><li>deploy到 Linode，發現掉進無底洞，全部都壞光光</li><li>production的資料庫預設pg，要更改成Mysql2</li><li>修bug修到不知道更改了哪些內容</li><li>還原後發現重run bundle install後無法安裝該有的東西</li><li>發現是因為曾經下過的指令 bundle install –without    development</li></ul><p>突然想起曾經有下過指令是<code>bundle install --without development</code><br>它非常聰明把你紀錄下來，以後執行bundle install的時候都會附加上–without development</p><h3 id="下過指令後，要如何取消？"><a href="#下過指令後，要如何取消？" class="headerlink" title="下過指令後，要如何取消？"></a>下過指令後，要如何取消？</h3><p>下過bundle install –without development指令後，要如何取消？</p><ul><li><p>可以開啟<code>.bundle/config</code>就知道了，電腦很聰明的把設定寫在裡面，所以要刪除這個設定就是把它刪掉，刪掉後重新執行bundle install就不會限制任何環境了。</p></li><li><p>或是執行<code>bundle install  –without development</code></p></li></ul><h3 id="奇怪？為什麼我-git-revert-某版本回去了"><a href="#奇怪？為什麼我-git-revert-某版本回去了" class="headerlink" title="奇怪？為什麼我 git revert 某版本回去了"></a>奇怪？為什麼我 git revert 某版本回去了</h3><p>輸入rails s 在本機上跑都失敗？<br>跑出ERROR說我sqlite3的gem沒有安裝成功，請重新安裝<br>載入無數次的bundle install都一樣，現在終於知道了</p><ul><li>先前輸入過指令 bundle install –without development</li><li>導致無法完整安裝gem，因為gem的sqlite3寫在development</li></ul><h4 id="又因為git-revert到很前面的版本，導致git-push的時候會出現錯誤訊息"><a href="#又因為git-revert到很前面的版本，導致git-push的時候會出現錯誤訊息" class="headerlink" title="又因為git revert到很前面的版本，導致git push的時候會出現錯誤訊息"></a>又因為git revert到很前面的版本，導致git push的時候會出現錯誤訊息</h4><p><code>Updates were rejected because the tip of your current branch is behind</code></p><h4 id="良心建議"><a href="#良心建議" class="headerlink" title="良心建議"></a>良心建議</h4><p>git pull然後一個一個慢慢解決衝突版本<br>不過這專案只有我一人在做，在那邊pull真的是會拉到死又浪費時間，只好使出大絕招</p><p><code>git push -u origin master -f</code></p><p>強制push上去蓋掉前面的紀錄，不過會導致遠端的git res會有些變動遺失就是，要用請謹慎小心。</p>]]></content>
      
      
      
        <tags>
            
            <tag> Git </tag>
            
            <tag> Rails 5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rails 5使用 Facebook 分享按鈕API，第一次無法正常載入頁面，解決辦法</title>
      <link href="//Rails5%E4%BD%BF%E7%94%A8-Facebook-%E5%88%86%E4%BA%AB%E6%8C%89%E9%88%95API%EF%BC%8C%E7%AC%AC%E4%B8%80%E6%AC%A1%E7%84%A1%E6%B3%95%E6%AD%A3%E5%B8%B8%E8%BC%89%E5%85%A5%E9%A0%81%E9%9D%A2%EF%BC%8C%E8%A7%A3%E6%B1%BA%E8%BE%A6%E6%B3%95/"/>
      <url>//Rails5%E4%BD%BF%E7%94%A8-Facebook-%E5%88%86%E4%BA%AB%E6%8C%89%E9%88%95API%EF%BC%8C%E7%AC%AC%E4%B8%80%E6%AC%A1%E7%84%A1%E6%B3%95%E6%AD%A3%E5%B8%B8%E8%BC%89%E5%85%A5%E9%A0%81%E9%9D%A2%EF%BC%8C%E8%A7%A3%E6%B1%BA%E8%BE%A6%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="Rails-5-使用-Facebook-分享按鈕-API-，第一次無法正常載入頁面，解決辦法"><a href="#Rails-5-使用-Facebook-分享按鈕-API-，第一次無法正常載入頁面，解決辦法" class="headerlink" title="Rails 5 使用 Facebook 分享按鈕 API ，第一次無法正常載入頁面，解決辦法"></a>Rails 5 使用 Facebook 分享按鈕 API ，第一次無法正常載入頁面，解決辦法</h1><p>在進行一個案子時遇到的困難：引用臉書的分享按鈕 API，第一次載入頁面時不會出現，第二次載入頁面後才會出現，甚至要等候很久才能出現。   </p><h3 id="問題分析"><a href="#問題分析" class="headerlink" title="問題分析"></a>問題分析</h3><ul><li>推測出有可能是turbolinks造成的問題，但jquery已有寫當<code>.on(turbolink:load)</code>了，後來從Stackflow找到解答    </li><li>請將下方程式碼複製貼上，就即可解決問題了！ </li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">&lt;script&gt;<br>  <span class="hljs-constructor">$(<span class="hljs-params">document</span>)</span>.on(<span class="hljs-string">&quot;turbolinks:load&quot;</span>, <span class="hljs-keyword">function</span><span class="hljs-literal">()</span>&#123;<br>      (<span class="hljs-keyword">function</span>(d, s, id) &#123;<br>      var js, fjs = d.get<span class="hljs-constructor">ElementsByTagName(<span class="hljs-params">s</span>)</span><span class="hljs-literal">[<span class="hljs-number">0</span>]</span>;<br>      <span class="hljs-keyword">if</span> (d.get<span class="hljs-constructor">ElementById(<span class="hljs-params">id</span>)</span>) return;<br>      js = d.create<span class="hljs-constructor">Element(<span class="hljs-params">s</span>)</span>; js.id = id;<br>      js.src = &#x27;https:<span class="hljs-comment">//connect.facebook.net/zh_TW/sdk.js#xfbml=1&amp;version=v2.10&amp;appId=2046979441994437&#x27;;</span><br>      fjs.parentNode.insert<span class="hljs-constructor">Before(<span class="hljs-params">js</span>, <span class="hljs-params">fjs</span>)</span>;<br>    &#125;(document, &#x27;script&#x27;, &#x27;facebook-jssdk&#x27;));<br>  &#125;)<br><br>(<span class="hljs-keyword">function</span>($) &#123;<br>  var fbRoot;<br><br>  <span class="hljs-keyword">function</span> save<span class="hljs-constructor">FacebookRoot()</span> &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-constructor">$(&#x27;#<span class="hljs-params">fb</span>-<span class="hljs-params">root</span>&#x27;)</span>.length) &#123;<br>      fbRoot = <span class="hljs-constructor">$(&#x27;#<span class="hljs-params">fb</span>-<span class="hljs-params">root</span>&#x27;)</span>.detach<span class="hljs-literal">()</span>;<br>    &#125;<br>  &#125;;<br><br>  <span class="hljs-keyword">function</span> restore<span class="hljs-constructor">FacebookRoot()</span> &#123;<br>    <span class="hljs-keyword">if</span> (fbRoot != null) &#123;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-constructor">$(&#x27;#<span class="hljs-params">fb</span>-<span class="hljs-params">root</span>&#x27;)</span>.length) &#123;<br>        <span class="hljs-constructor">$(&#x27;#<span class="hljs-params">fb</span>-<span class="hljs-params">root</span>&#x27;)</span>.replace<span class="hljs-constructor">With(<span class="hljs-params">fbRoot</span>)</span>;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-constructor">$(&#x27;<span class="hljs-params">body</span>&#x27;)</span>.append(fbRoot);<br>      &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (typeof FB !== <span class="hljs-string">&quot;undefined&quot;</span><span class="hljs-operator"> &amp;&amp; </span>FB !== null) &#123; <span class="hljs-comment">// Instance of FacebookSDK</span><br>      <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">FB</span>.</span><span class="hljs-module"><span class="hljs-identifier">XFBML</span>.</span></span>parse<span class="hljs-literal">()</span>;<br>    &#125;<br>  &#125;;<br><br>  document.add<span class="hljs-constructor">EventListener(&#x27;<span class="hljs-params">turbolinks</span>:<span class="hljs-params">request</span>-<span class="hljs-params">start</span>&#x27;, <span class="hljs-params">saveFacebookRoot</span>)</span><br>  document.add<span class="hljs-constructor">EventListener(&#x27;<span class="hljs-params">turbolinks</span>:<span class="hljs-params">load</span>&#x27;, <span class="hljs-params">restoreFacebookRoot</span>)</span><br>&#125;(jQuery));<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Rails 5 </tag>
            
            <tag> API </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>你一定有聽過的Bower 前端套件管理工具</title>
      <link href="//%E4%BD%A0%E4%B8%80%E5%AE%9A%E6%9C%89%E8%81%BD%E9%81%8E%E7%9A%84Bower-%E5%89%8D%E7%AB%AF%E5%A5%97%E4%BB%B6%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/"/>
      <url>//%E4%BD%A0%E4%B8%80%E5%AE%9A%E6%9C%89%E8%81%BD%E9%81%8E%E7%9A%84Bower-%E5%89%8D%E7%AB%AF%E5%A5%97%E4%BB%B6%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h1 id="你一定有聽過的-Bower-前端套件管理工具"><a href="#你一定有聽過的-Bower-前端套件管理工具" class="headerlink" title="你一定有聽過的 Bower 前端套件管理工具"></a>你一定有聽過的 Bower 前端套件管理工具</h1><p>用Bower自動下載jQuery, Bootstrap等Libery，再與Gulp做串接</p><blockquote><p>bower init後安裝的套件，會自動寫出到bower.json檔案。<br>全自動化，讓簡單且重複的事交給Gulp &amp; Bower，把寶貴的時間拿來寫CODE吧！</p></blockquote><p>此文章會用到下列幾個套件</p><ul><li><code>gulp-load-plugins</code> 以$字號來簡略載入各套件，只對gulp開頭的套件有用</li><li><code>gulp-order</code> 排載入的順序</li><li><code>main-bower-files</code> 和Bower結合</li><li><code>gulp-concat</code> 合併檔案</li></ul><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">npm <span class="hljs-keyword">install </span>-g <span class="hljs-keyword">bower</span><br><span class="hljs-keyword"></span>cd project <span class="hljs-comment">#進入專案資料夾</span><br><span class="hljs-keyword">bower </span>init <span class="hljs-comment">#bower初始化</span><br><span class="hljs-keyword">bower </span><span class="hljs-keyword">install </span>&lt;package&gt;<br><span class="hljs-keyword">bower </span><span class="hljs-keyword">install </span><span class="hljs-keyword">jquery</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">bower </span><span class="hljs-keyword">install </span><span class="hljs-keyword">bootstrap</span><br></code></pre></td></tr></table></figure><p><code>bower init</code> 後會產生 bower.json檔</p><p><code>bower install &lt;package&gt;</code> 會自動產生bower_components資料夾，裡面放的       是下載下來的外掛。 </p><h2 id="串接前端的Gulp自動化工具，整合"><a href="#串接前端的Gulp自動化工具，整合" class="headerlink" title="串接前端的Gulp自動化工具，整合"></a>串接前端的Gulp自動化工具，整合</h2><h4 id="需要用到main-bower-files的Gulp套件"><a href="#需要用到main-bower-files的Gulp套件" class="headerlink" title="需要用到main-bower-files的Gulp套件"></a>需要用到main-bower-files的Gulp套件</h4><p>第一步，在Gulpfile.js require後，輸入npm install寫入package.json內<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">var mainBowerFiles</span> = require(<span class="hljs-string">&#x27;main-bower-files&#x27;</span>);<br><span class="hljs-attribute">npm install --save-dev main-bower-files</span><br></code></pre></td></tr></table></figure><br>Bower幫前端工程師下載套件 =&gt; 不用再花時間一個個手動抓<br>整合到Gulp，將套件輸出到我們想要的資料夾 =&gt; 打gulp後自動跑全自動化！<br><strong>這就是為什麼需要整合，把簡單且重複的事交給電腦做吧！</strong></p><p>在package.json下多新增bower任務</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">gulp.task(<span class="hljs-string">&#x27;bower&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> gulp.src(mainBowerFiles())<br>        .pipe(gulp.dest(<span class="hljs-string">&#x27;./.tmp/vendors&#x27;</span>))<br>&#125;);<br></code></pre></td></tr></table></figure><p>再多新增一個任務叫<strong>vendorJs</strong>，最主要目的是輸出到public/vendors資料下之外，還需要賦予兩個任務：按照順序載入js、合併成一隻js檔。</p><ul><li><strong>照順序載入js：</strong>像jquery, bootstrap是需要按照順序載入js的，所以需要另外安裝套件order。</li><li><p><strong>合併成一隻js檔</strong>：減少伺服器的request，讓伺服器負荷減輕，網站也能跑較快。</p><p>  gulp.task(‘vendorJs’, [bower], function(){</p><pre><code>return gulp.src([./.tmp/vendors/**/*.js])          .pipe($.order([            &apos;jquery.js&apos;,            &apos;bootstrap.js&apos;           ]))          .pipe($.concat(vendors.js))          .pipe(gulp.dest(&apos;./public/js&apos;))</code></pre><p>  })</p></li></ul><p><code>gulp.task(&#39;vendorJs&#39;, [&#39;bower&#39;], function(&#123;..&#125;))</code></p><p> 多加入了<code>[bower]</code>的參數，代表在<code>vendorJs</code>任務跑完前，必須要等bower跑完。因為bower任務就是為了把下載回來的套件輸出的.tmp/vendors資料夾，若還沒下載回來，vendorJs就讀取不到啦！所以一定要記得加上。</p><h2 id="將vendorJs加入default監控任務"><a href="#將vendorJs加入default監控任務" class="headerlink" title="將vendorJs加入default監控任務"></a>將vendorJs加入default監控任務</h2><p>default就不用額外設定bower任務了，因為vendorJs開跑前會先等bower寫完。</p><pre><code>gulp.task(&apos;default&apos;, [&apos;vendorJs&apos;, &apos;browserSync&apos;, &apos;watch&apos;])</code></pre><p>輕鬆寫完腳本後，打上gulp便會自動產生囉！<br>可以將固定專案常用的腳本上傳到git，或是給其他開發者使用。</p><pre><code>#.gitinore 忽略bower_componentsnode_modulespublic</code></pre><p>開發者下載回來，只要輸入<code>npm install</code>及<code>bower install</code>即會產生一樣的效果，快速又方便。</p><hr><h3 id="bower-components資料夾，想要重新命名"><a href="#bower-components資料夾，想要重新命名" class="headerlink" title="bower_components資料夾，想要重新命名"></a>bower_components資料夾，想要重新命名</h3><p>若覺得<code>bower install</code>放套件資料夾「.bower_components」名字很醜，想另外取名的話其實是可以的哦！在專案資料夾根目錄下創建.bowerrc檔 <code>touch .bowerrc</code><br>創建後，在bowerrc裡加入以下程式碼<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dts">.<span class="hljs-class">bowerrc</span><br><span class="hljs-class"></span>&#123;<br> <span class="hljs-string">&quot;directory&quot;</span>: <span class="hljs-string">&quot;vendors/&quot;</span><br> &#125;<br></code></pre></td></tr></table></figure><br>接著執行 <code>bower install</code>便會產生vendors資料夾囉。</p><h3 id="參考網站"><a href="#參考網站" class="headerlink" title="參考網站"></a>參考網站</h3><ul><li><a href="https://bower.io/">Bower官方</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GitPage 上$.getJSON讀取不到json，出現 404 ERROR</title>
      <link href="//GitPage-%E4%B8%8A-getJSON%E8%AE%80%E5%8F%96%E4%B8%8D%E5%88%B0json%EF%BC%8C%E5%87%BA%E7%8F%BE-404-ERROR/"/>
      <url>//GitPage-%E4%B8%8A-getJSON%E8%AE%80%E5%8F%96%E4%B8%8D%E5%88%B0json%EF%BC%8C%E5%87%BA%E7%8F%BE-404-ERROR/</url>
      
        <content type="html"><![CDATA[<h1 id="GitPage-上-getJSON讀取不到json，出現-404-ERROR"><a href="#GitPage-上-getJSON讀取不到json，出現-404-ERROR" class="headerlink" title="GitPage 上$.getJSON讀取不到json，出現 404 ERROR"></a>GitPage 上$.getJSON讀取不到json，出現 404 ERROR</h1><p>我將content.json檔放在Localhost測試正常後，才push到github，接著開啟GitPage，發現沒辦法實行AJAX功能，讀取不到我的content.json資料</p><h3 id="Consolo-log顯示"><a href="#Consolo-log顯示" class="headerlink" title="Consolo.log顯示"></a>Consolo.log顯示</h3><ul><li><code>Failed to load resource: the server responded with a status of 404 ()</code></li></ul><h3 id="什麼原因造成的？"><a href="#什麼原因造成的？" class="headerlink" title="什麼原因造成的？"></a>什麼原因造成的？</h3><ul><li>Github pages is loaded over https and your API request is over http, which is not allowed. You are serving the site over HTTPS but trying to load jQuery over HTTP. This is not allowed.<h3 id="除錯過程"><a href="#除錯過程" class="headerlink" title="除錯過程"></a>除錯過程</h3></li></ul><ol><li>檢查.gitinore是不是忽略到我的json檔</li><li>將路徑$.getJSON改成URL絕對路徑<ul><li><code>$.getJSON(&#39;../data/content.json&#39;, function)</code><br>把裡面的<code>../data/content.json</code>改成</li><li><code>https://hazelwu2.github.io/AjaxMasonryPhoto/data/content.json</code></li></ul></li></ol><p>重新更改路徑後，Gitpage就抓得到我的資料了。<br>初步判斷應該是因為HTTPS，但上傳到github是http，導致無法拿到資料。</p><p>如果有問題、筆誤或寫錯，歡迎糾正我，謝謝</p><h3 id="參考網站"><a href="#參考網站" class="headerlink" title="參考網站"></a>參考網站</h3><ul><li><a href="https://forum.freecodecamp.org/t/cant-receive-json-with-getjson-or-ajax-when-publish-on-github-pages/72438/10">這可憐的老兄遇到的問題和我一樣</a></li><li><a href="https://github.com/Rob--W/cors-anywhere">CROS-anywhere</a></li><li><a href="https://stackoverflow.com/questions/44279919/reading-json-file-from-github-pages-server-using-javascript">Reading Json file from github pages server using javascript</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Git </tag>
            
            <tag> Github Pages </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rails SEO-用Sitemap-generator快速設定sitemap</title>
      <link href="//Rails-SEO-%E7%94%A8Sitemap-generator%E5%BF%AB%E9%80%9F%E8%A8%AD%E5%AE%9Asitemap/"/>
      <url>//Rails-SEO-%E7%94%A8Sitemap-generator%E5%BF%AB%E9%80%9F%E8%A8%AD%E5%AE%9Asitemap/</url>
      
        <content type="html"><![CDATA[<h1 id="Rails-SEO-用Sitemap-generator快速設定sitemap"><a href="#Rails-SEO-用Sitemap-generator快速設定sitemap" class="headerlink" title="Rails SEO-用Sitemap-generator快速設定sitemap"></a>Rails SEO-用Sitemap-generator快速設定sitemap</h1><p>如何用gem gitemap外掛，將Rails整體專案產出sitemap</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ruby">gem <span class="hljs-string">&#x27;sitemap_generator&#x27;</span> <br><span class="hljs-comment"># 在Gemfile加入此行</span><br>bundle install          <br><span class="hljs-comment"># 安裝套件</span><br>rake <span class="hljs-symbol">sitemap:</span>install<br>自動生成 APP/config/sitemap.rb<br><span class="hljs-comment"># 開啟sitemap.rb，已自動生成好格式</span><br>SitemapGenerator::Sitemap.create <span class="hljs-keyword">do</span><br><span class="hljs-comment"># 必要設定default_host</span><br>SitemapGenerator::Sitemap.default_host = <span class="hljs-string">&quot;http://www.你的網站.com&quot;</span><br><span class="hljs-comment"># 接下來就是自由設定你自己Style的map了!</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><h3 id="設定robot-txt，爬蟲能夠爬得到Sitemap"><a href="#設定robot-txt，爬蟲能夠爬得到Sitemap" class="headerlink" title="設定robot.txt，爬蟲能夠爬得到Sitemap"></a><strong>設定robot.txt，爬蟲能夠爬得到Sitemap</strong></h3><p><strong>在public/robot.txt輸入</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">Sitemap: http:<span class="hljs-regexp">//</span>www.你的網站.com/sitemap.xml.gz<br></code></pre></td></tr></table></figure><h3 id="在本端產生sitemap-xml，測試路徑是否正確"><a href="#在本端產生sitemap-xml，測試路徑是否正確" class="headerlink" title="在本端產生sitemap.xml，測試路徑是否正確"></a>在本端產生sitemap.xml，測試路徑是否正確</h3><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">rake sitemap:refresh:no_ping  <span class="hljs-meta">#測試，故不提交給搜尋引擎</span><br><span class="hljs-symbol">localhost:</span><span class="hljs-number">3000</span>/sitemap.xml.gz <span class="hljs-meta">#瀏覽器</span><br><span class="hljs-meta">#自動下載下來後用瀏覽器重新開啟</span><br></code></pre></td></tr></table></figure><h3 id="測試沒問題了！Deploy-到-Heroku跑看看"><a href="#測試沒問題了！Deploy-到-Heroku跑看看" class="headerlink" title="測試沒問題了！Deploy 到 Heroku跑看看"></a>測試沒問題了！Deploy 到 Heroku跑看看</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">git <span class="hljs-builtin-name">add</span> .<br>git commit -am <span class="hljs-string">&#x27;Added sitemap to SEO&#x27;</span><br>git push heroku master<br>heroku <span class="hljs-builtin-name">run</span> sitemap:refresh<br></code></pre></td></tr></table></figure><p>Heroku傳回console.log訊息是有建立成功，但真的測試會發現找不到sitemap。原因出在Heroku採用臨時文件系統，需要找一個容器來裝檔案才行。以下是Heroku官網說明：關於Ephemeral filesystem。</p><blockquote><h4 id="Heroku-採用Ephemeral-filesystem（臨時文件系統）"><a href="#Heroku-採用Ephemeral-filesystem（臨時文件系統）" class="headerlink" title="Heroku 採用Ephemeral filesystem（臨時文件系統）"></a>Heroku 採用Ephemeral filesystem（臨時文件系統）</h4><p>當重新部署或動態管理時，導致資料會重新歸0<br>During the dyno’s lifetime its running processes can use the filesystem as a temporary scratchpad, <strong>but no files that are written are visible to processes in any other dyno and any files written will be discarded the moment the dyno is stopped or restarted.</strong> For example, <strong>this occurs any time a dyno is replaced due to application deployment and approximately once a day as part of normal dyno management.</strong></p></blockquote><h2 id="那就放在Amazon-S3吧！"><a href="#那就放在Amazon-S3吧！" class="headerlink" title="那就放在Amazon S3吧！"></a>那就放在Amazon S3吧！</h2><blockquote><p><strong>寫入S3前，請先完成幾個步驟</strong></p><p>1.註冊AWS會員，並登錄信用卡，才可以用Aws的免費額度。</p><p>2.開啟AWS S3的服務，建立一個Bucket</p><p>3.在本機環境設定先設好AWS相關的API帳密設定，接下來會用到，若沒設定好會出錯。</p></blockquote><h3 id="使用CarrierWave-上傳到-AWS-S3"><a href="#使用CarrierWave-上傳到-AWS-S3" class="headerlink" title="使用CarrierWave 上傳到 AWS S3"></a>使用CarrierWave 上傳到 AWS S3</h3><p>Rails含有豐富的Gem世界，Sitemaps支援多種外掛上傳到遠端空間，包含以下幾鐘：FileAdapter、FogAdapter、S3Adapter、AwsSdkAdapter、WaveAdapter，參考頁面：<a href="https://github.com/kjvarga/sitemap_generator#supported-adapters">官方頁面Supported Adapters</a><br>藉由Gem CarrierWave來上傳到S3，請先安裝好CarrierWave的Gem</p><p><strong>在sitemap.rb內修改</strong></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;carrierwave&#x27;</span><br><span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;sitemap_generator&#x27;</span><br><br>SitemapGenerator::Sitemap.default_host = <span class="hljs-string">&quot;你的網址&quot;</span><br><br><span class="hljs-comment"># 你的AWS S3空間網址，創建的bucket-name</span><br>SitemapGenerator::Sitemap.sitemaps_host = <span class="hljs-string">&quot;http://s3.amazonaws.com/你的bucket-name/&quot;</span><br><span class="hljs-comment"># AWS S3 的bucket底下建立一個資料夾sitemaps</span><br>SitemapGenerator::Sitemap.sitemaps_path = <span class="hljs-string">&#x27;sitemaps/&#x27;</span><br><span class="hljs-comment"># 會放在heroku伺服器內的public/tmp資料架底下</span><br>SitemapGenerator::Sitemap.public_path = <span class="hljs-string">&#x27;tmp/&#x27;</span><br><br><span class="hljs-comment"># 使用WaveAdapter來上傳到AWS S3</span><br>SitemapGenerator::Sitemap.adapter = SitemapGenerator::WaveAdapter.new<br><br>SitemapGenerator::Sitemap.create <span class="hljs-keyword">do</span><br>add <span class="hljs-string">&#x27;/about&#x27;</span>, <span class="hljs-symbol">:changefreq</span> =&gt; <span class="hljs-string">&#x27;monthly&#x27;</span><br>add <span class="hljs-string">&#x27;/news&#x27;</span>, <span class="hljs-symbol">:changefreq</span> =&gt; <span class="hljs-string">&#x27;monthly&#x27;</span><br>add <span class="hljs-string">&#x27;/article&#x27;</span><br>Post.find_each <span class="hljs-keyword">do</span> |post|<br>    add post_path(post.friendly_id), <span class="hljs-symbol">:lastmod</span> =&gt; post.updated_at<br>    <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><p>新增home#controller，設定sitemap路徑</p><pre><code>rails controller -g home</code></pre><p>在home_controller.rb內設定</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">robots</span></span>                                             <br> robots = File.read(Rails.root + <span class="hljs-string">&quot;config/robots.<span class="hljs-subst">#&#123;Rails.env&#125;</span>.txt&quot;</span>)<br> render <span class="hljs-symbol">:text</span> =&gt; robots, <span class="hljs-symbol">:layout</span> =&gt; <span class="hljs-keyword">false</span>, <span class="hljs-symbol">:content_type</span> =&gt; <span class="hljs-string">&quot;text/plain&quot;</span><br><span class="hljs-keyword">end</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sitemap</span></span><br>  redirect_to <span class="hljs-string">&#x27;https://s3-ap-northeast-1.amazonaws.com/你的bucket-name/sitemaps/sitemap.xml.gz&#x27;</span><br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><p>在routes設定路徑</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">get</span> <span class="hljs-string">&#x27;/sitemaps.xml.gz&#x27;</span> =&gt; <span class="hljs-string">&#x27;home#sitemap&#x27;</span><br><span class="hljs-keyword">get</span> <span class="hljs-string">&#x27;/robots.txt&#x27;</span> =&gt; <span class="hljs-string">&#x27;home#robots&#x27;</span><br></code></pre></td></tr></table></figure><p>再重新Deploy到heroku測試看看。</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ruby">git add .<br>git commit -am <span class="hljs-string">&#x27;Add home#controller &amp; Setting routes &amp; Sitemap use Wave Adapter&#x27;</span><br>git push heroku master<br>heroku run <span class="hljs-symbol">sitemap:</span>refresh<br></code></pre></td></tr></table></figure><p>查看看你的AWS S3空間有沒有多出新的資料夾叫「sitemap」，有的話代表上傳成功囉！<br>接著就是去Google Console提交你的Sitemap啦！</p><h4 id="更新robots-txt，上傳到heroku後未抓到更改後的版本。"><a href="#更新robots-txt，上傳到heroku後未抓到更改後的版本。" class="headerlink" title="更新robots.txt，上傳到heroku後未抓到更改後的版本。"></a><strong>更新robots.txt，上傳到heroku後未抓到更改後的版本。</strong></h4><p>在production.rb上加入後重新Deploy到heroku，就抓得到新的版本囉</p><pre><code>config.static_cache_control = &quot;public, max-age=2592000&quot;</code></pre><h4 id="指令介紹"><a href="#指令介紹" class="headerlink" title="指令介紹"></a>指令介紹</h4><hr><p><code>rake sitemap:install</code> 第一步安裝，會自動生成<strong>sitemap.rb</strong>在config目錄底下</p><p><code>rake sitemap:refresh</code> 更新sitemap.xml.gz，並提交到搜尋引擎Google等</p><p><code>rake sitemap:refresh:no_ping</code> 更新sitemap.xml.gz，但<strong>不提交</strong>到搜尋引擎（可在本機development環境下測試）</p><p><code>sitemap:create</code>    建立空白的sitemap，未設定自動提交到搜尋引擎</p><h3 id="關於連結設定"><a href="#關於連結設定" class="headerlink" title="關於連結設定"></a>關於連結設定</h3><p>網址若是localhost:3000/welcome，則add就是設 ‘/welcome’<br>若要使用welcome_path，這種helper需要加上</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">SitemapGenerator::<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Interpreter</span>.</span></span>send :<span class="hljs-keyword">include</span>, RoutingHelper<br></code></pre></td></tr></table></figure><h3 id="關於參數"><a href="#關於參數" class="headerlink" title="關於參數"></a>關於參數</h3><p><code>changefreq</code>：這個頁面頻繁更新的次數，預設是一星期一次<br>    &gt;可設定的參數<br>    &gt;’always’, ‘hourly’, ‘daily’, ‘weekly’, ‘monthly’, ‘yearly’ or ‘never’</p><p><code>lastmod</code>：告訴搜尋引擎，上次修改的時間和日期，預設是Time.now<br><code>host</code>：若不同網域主機需要用:host參數特別指定。預設為default_host所設定的網域<br><code>priority</code>： 排名URL優先權，範圍是0到1，預設為0.5</p><h3 id="關於Post（循環文章）的Sitemap"><a href="#關於Post（循環文章）的Sitemap" class="headerlink" title="關於Post（循環文章）的Sitemap"></a>關於Post（循環文章）的Sitemap</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-built_in">add</span> <span class="hljs-string">&#x27;/article&#x27;</span><br>Post.find_each <span class="hljs-built_in">do</span> |<span class="hljs-built_in">post</span>|<br>  <span class="hljs-built_in">add</span> post_path(<span class="hljs-built_in">post</span>.friendly_id), :lastmod =&gt; <span class="hljs-built_in">post</span>.updated_at<br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=" "></a> </h2><h4 id="參考網站"><a href="#參考網站" class="headerlink" title="參考網站"></a>參考網站</h4><ol><li><a href="https://github.com/kjvarga/sitemap_generator#rails">Github Sitemap_generator#rails</a></li><li><a href="https://www.scrivinor.com/article/rails-seo-%E7%AC%AC%E4%BA%8C%E6%AD%A5-%E9%97%9C%E6%96%BC-sitemap?locale=zh-TW">Rails SEO 第二步: 關於 sitemap</a></li><li><a href="https://www.cookieshq.co.uk/posts/creating-a-sitemap-with-ruby-on-rails-and-upload-it-to-amazon-s3">Creating a sitemap with Ruby on Rails and uploading it to Amazon S3</a></li><li><a href="https://www.sitepoint.com/start-your-seo-right-with-sitemaps-on-rails/">Start Your SEO Right with Sitemaps on Rails</a></li><li><a href="https://stackoverflow.com/questions/23389609/robots-txt-file-on-rails-heroku-app-not-updating?answertab=votes#tab-top">Robots.txt file on Rails heroku app not updating</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Gulp 學習紀錄、常用指令</title>
      <link href="//Gulp-%E5%AD%B8%E7%BF%92%E7%B4%80%E9%8C%84%E3%80%81%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/"/>
      <url>//Gulp-%E5%AD%B8%E7%BF%92%E7%B4%80%E9%8C%84%E3%80%81%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h1 id="Gulp-學習紀錄、常用指令"><a href="#Gulp-學習紀錄、常用指令" class="headerlink" title="Gulp 學習紀錄、常用指令"></a>Gulp 學習紀錄、常用指令</h1><p>紀錄學習Gulp的歷程，及gulp常用的指令</p><h3 id="第一次安裝Gulp"><a href="#第一次安裝Gulp" class="headerlink" title="第一次安裝Gulp"></a>第一次安裝Gulp</h3><ol><li>npm install -g gulp</li><li>npm init</li><li>在目錄下touch gulpfile.js</li><li>npm install 外掛名稱 —save-dev</li></ol><h3 id="之後使用Gulp"><a href="#之後使用Gulp" class="headerlink" title="之後使用Gulp"></a>之後使用Gulp</h3><ol><li>移動到目錄後，npm init，創造package.json檔</li><li>貼上已設定的package.json</li><li>npm install -l 自動安裝package.json列表上的外掛</li><li>複製已設定好的腳本gulpfile.js</li></ol><h3 id="常用外掛清單"><a href="#常用外掛清單" class="headerlink" title="常用外掛清單"></a>常用外掛清單</h3><ul><li><p>SASS/SCSS編譯成CSS gulp-sass</p></li><li><p><a href="https://www.npmjs.com/package/gulp-minify-css">CSS 壓縮迷你化 gulp-minify-css</a></p></li><li><p><a href="https://www.npmjs.com/package/gulp-plumber">遇錯時不會中斷 gulp-plumber</a></p></li><li><p><a href="https://www.npmjs.com/package/gulp-postcss">後處理器 gulp-postcss</a></p></li><li><p><a href="https://www.npmjs.com/package/autoprefixer">根據不同瀏覽器版本，自動補上前綴詞 autoprefixer</a></p></li><li><p><a href="https://www.npmjs.com/package/gulp-load-plugins">不用寫一大堆的變數，用$取代 gulp-load-plugins</a></p></li><li><p><a href="https://www.npmjs.com/package/gulp-babel">JavaScript ES6 編譯 gulp-babel</a></p></li><li><p><a href="https://www.npmjs.com/package/gulp-sourcemaps">壓縮合併程式碼後可以找出原始頭是誰 gulp-sourcemaps</a></p></li><li><p><a href="https://www.npmjs.com/package/gulp-concat">合併程式碼 gulp-concat</a></p></li><li><p><a href="https://www.npmjs.com/package/gulp-order">外部載入的套件需要排序 gulp-order</a><br>(對jquery,bootstrap常載入的是必備品)</p></li><li><p><a href="https://www.npmjs.com/package/browser-sync">Web Server，即時預覽檔案，安裝後即不用裝liverRoad  ：Browser Sync</a></p></li><li><p><a href="https://www.npmjs.com/package/main-bower-files">Gulp 串接 Bower 工具 main-bower-files</a></p></li><li><p><a href="https://www.npmjs.com/package/gulp-uglify">JavaScript 壓縮工具 gulp-uglify</a></p></li><li><p><a href="https://www.npmjs.com/package/minimist">gulp 流程控制 minimist</a></p></li><li><p><a href="https://www.npmjs.com/package/gulp-if">設定任務，可加入判斷式 gulp-if</a></p></li></ul><h3 id="在學習Gulp時遇到的障礙"><a href="#在學習Gulp時遇到的障礙" class="headerlink" title="在學習Gulp時遇到的障礙"></a>在學習Gulp時遇到的障礙</h3><p>在安裝gulp時出現以下訊息</p><p><code>npm WARN deprecated minimatch@2.0.10: Please update to minimatch 3.0.2 or higher to avoid a RegExp DoS issue</code></p><ul><li><p>npm WARN已棄用<a href="mailto:minimatch@2.0.10">minimatch@2.0.10</a>：請更新至最低3.0.2或更高版本以避免RegExp DoS問題</p></li><li><p>解決辦法：npm install minimatch@“3.0.2”<br>或著不用理他也沒有關係的</p></li></ul><hr><h3 id="Gulp-常用指令"><a href="#Gulp-常用指令" class="headerlink" title="Gulp 常用指令"></a>Gulp 常用指令</h3><p><code>Npm init</code></p><ul><li>輸入npm init，進行這個空白專案的初始化，同時也會生成一個基本的package.json，這個package.json非常重要，因為它定義了這個 Node.js 專案裏頭會需要用到的模組與套件 ( Node modules )，輸入npm init之後，基本上可以填寫一些名稱或描述，不然其實也可以直接一直 enter 按下去就會建立完成。</li></ul><p><code>touch gulpfile.js</code></p><ul><li>建立gulpfile.js，要寫的任務、套件全部都是寫在這裡面</li></ul><p><code>npm install</code></p><ul><li>會安裝專案內的 package.json 所列出的需要元件。</li></ul><p><code>npm install -l</code></p><ul><li>把package.json腳本設定好，建立新專案時輸入即可依照package.json上列出的套件，全部自動化安裝完</li></ul><h3 id="npm-相關指令整理"><a href="#npm-相關指令整理" class="headerlink" title="npm 相關指令整理"></a>npm 相關指令整理</h3><ul><li><a href="http://dreamerslab.com/blog/tw/npm-basic-commands/">http://dreamerslab.com/blog/tw/npm-basic-commands/</a></li><li><a href="https://www.youtube.com/watch?v=1rw9MfIleEg">跟著教學操作的youtube</a></li></ul><h3 id="Reference-參考網站"><a href="#Reference-參考網站" class="headerlink" title="Reference | 參考網站"></a>Reference | 參考網站</h3><ul><li><a href="http://www.oxxostudio.tw/articles/201503/gulp-install-webserver.html">http://www.oxxostudio.tw/articles/201503/gulp-install-webserver.html</a></li><li><a href="https://gulpjs.com/">https://gulpjs.com/</a></li><li><a href="https://987.tw/gulpru-men-zhi-nan/">https://987.tw/gulpru-men-zhi-nan/</a></li><li><a href="http://www.gulpjs.com.cn/docs/getting-started/">http://www.gulpjs.com.cn/docs/getting-started/</a></li><li><a href="https://ithelp.ithome.com.tw/articles/10185565">https://ithelp.ithome.com.tw/articles/10185565</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>教你如何快速設定綁定網域在 Byehost 虛擬主機商</title>
      <link href="//%E6%95%99%E4%BD%A0%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E8%A8%AD%E5%AE%9A%E7%B6%81%E5%AE%9A%E7%B6%B2%E5%9F%9F%E5%9C%A8%20Byehost%20%E8%99%9B%E6%93%AC%E4%B8%BB%E6%A9%9F%E5%95%86/"/>
      <url>//%E6%95%99%E4%BD%A0%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E8%A8%AD%E5%AE%9A%E7%B6%81%E5%AE%9A%E7%B6%B2%E5%9F%9F%E5%9C%A8%20Byehost%20%E8%99%9B%E6%93%AC%E4%B8%BB%E6%A9%9F%E5%95%86/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>申請Byethost免費虛擬主機架站，綁定自己購買的網址<br>其實研究了有陣子，第一次架站新手，對DNS、子網域很不熟悉。<br>故記錄起來以防之後有天會忘記XD。<br><span id="more"></span></p><h2 id="申請Byehost虛擬空間"><a href="#申請Byehost虛擬空間" class="headerlink" title="申請Byehost虛擬空間"></a>申請Byehost虛擬空間</h2><p>首先先到Byethost申請虛擬空間，會得到以下的資料及帳號密碼<br><img src="https://i.imgur.com/ScdZjgL.png" alt="byehost虛擬空間"><br><img class="alignnone wp-image-21" src="http://wualnz.com/wordpress/wp-content/uploads/2017/08/未命名.png" alt="" width="796" height="417" /></p><h2 id="綁定網址，以Godaddy示範"><a href="#綁定網址，以Godaddy示範" class="headerlink" title="綁定網址，以Godaddy示範"></a>綁定網址，以Godaddy示範</h2><p>不想要用Byethost主機預設網址的話？像是<code>http://你申請的帳號.byethost7.com</code><br>希望別人能直接輸入自己買的網址後，即轉到wordpress部落格或自架網站<br>而不是醜醜的虛擬主機商贈送的 <code>http://你的帳號.byethost7.com</code></p><p>我是購買Godaddy的網址，以下就用Godaddy來示範操作。<a href="https://tw.godaddy.com/" target="_blank" rel="noopener">前往Godaddy 知名主機商</a><br><br></p><h2 id="進入Godaddy後台，設定DNS"><a href="#進入Godaddy後台，設定DNS" class="headerlink" title="進入Godaddy後台，設定DNS"></a>進入Godaddy後台，設定DNS</h2><p>買好自己中意的網址後，進入Godaddy的後台→網域管理員→旗下的DNS→輸入<b>ns1.byet.org、ns1.byet.org</b><br>將自己的網址透過 設定DNS，告訴老爹說你的DNS主機在哪？（自然就是你的虛擬主機空間取得資料）</p><p><img src="https://i.imgur.com/uGrDvus.jpg" alt="byehost虛擬空間 - Godaddy的設定DNS Servers"></p><p>還記得剛剛在Byethost註冊的帳號密碼吧？<br>現在要登入Byethost的cPanel後台，點選Aliases (Parked Domains)選項<br><img src="https://i.imgur.com/w66Dqun.jpg" alt="點選Aliases (Parked Domains)選項"></p><p>接著，Domain Name輸入你已經申請好的網址<br>Park onto則是選一開始Byethost主機商預設的網址<br>設定完後就打工告成啦！<br><img src="https://i.imgur.com/CzLIDq7.jpg" alt="設定Parked-Domain-Management"></p>]]></content>
      
      
      
        <tags>
            
            <tag> byethost </tag>
            
            <tag> wordpress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>安裝Edius時，出現ERROR：Error launching installer解決辦法</title>
      <link href="//%E5%AE%89%E8%A3%9DEdius%E6%99%82%EF%BC%8C%E5%87%BA%E7%8F%BEERROR%EF%BC%9AError-launching-installer%E8%A7%A3%E6%B1%BA%E8%BE%A6%E6%B3%95/"/>
      <url>//%E5%AE%89%E8%A3%9DEdius%E6%99%82%EF%BC%8C%E5%87%BA%E7%8F%BEERROR%EF%BC%9AError-launching-installer%E8%A7%A3%E6%B1%BA%E8%BE%A6%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>前陣子安裝Edius時發生了錯誤Error launching installer，爬文Google搜尋，並記錄下來解決方法。</p><h3 id="問題"><a href="#問題" class="headerlink" title="問題"></a>問題</h3><p>安裝Error launching installer時出現錯誤訊息<code>Error launching installer</code><br><span id="more"></span></p><h3 id="解決辦法"><a href="#解決辦法" class="headerlink" title="解決辦法"></a>解決辦法</h3><ul><li>把路徑換成別的，把資料夾名稱及含有路徑全改成英文，再重新啟動就可以了</li></ul><h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><ul><li>圖片上資料夾名稱寫edius 7.5軟件，”軟件”為簡體字，導致資料路徑上有特殊符碼(罕見中文或全碼符號)，使得程式無法執行。</li><li>簡單的解法是把安裝程式移到其他資料夾，如 C:\ ，或是重新命名資料夾名稱，即可啟動執行檔程式進行安裝囉</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Edius </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>大部分開發者都是使用MAC OS系統？</title>
      <link href="//%E5%A4%A7%E9%83%A8%E5%88%86%E9%96%8B%E7%99%BC%E8%80%85%E9%83%BD%E6%98%AF%E4%BD%BF%E7%94%A8MAC%20OS%E7%B3%BB%E7%B5%B1%EF%BC%9F/"/>
      <url>//%E5%A4%A7%E9%83%A8%E5%88%86%E9%96%8B%E7%99%BC%E8%80%85%E9%83%BD%E6%98%AF%E4%BD%BF%E7%94%A8MAC%20OS%E7%B3%BB%E7%B5%B1%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="大部分開發者都是使用MAC-OS系統？"><a href="#大部分開發者都是使用MAC-OS系統？" class="headerlink" title="大部分開發者都是使用MAC OS系統？"></a>大部分開發者都是使用MAC OS系統？</h1><p><img src="/images/developer.jpg" alt="Why Web developer always using Mac OS ?"></p><p>相信這是大家都會疑問的問題，我到底要不要花錢下去買Macbook筆電？<br>我個人學Website時是先從Windows起步的，約學習快一年的時間<br>但當遇到許多奇怪的問題，對Unix不太熟，常卡在莫名其妙的問題上，浪費了好多時間。<br>因為相信「時間 &gt; 金錢」的價值觀，最後敗下去買 Macbook Pro 2017。</p><h2 id="警告：以下為前輩較為主觀的意見。"><a href="#警告：以下為前輩較為主觀的意見。" class="headerlink" title="警告：以下為前輩較為主觀的意見。"></a>警告：以下為前輩較為主觀的意見。</h2><p>MAC的終端機方便很多！WINDOWS會鎖住CMD很多功能<br>變成要下載好多好多一大堆相容性軟體，出了問題又要花時間GOOGLE找解答<br>有時候還找不到解答=_=，光是這點會讓你節省不少時間</p><h3 id="Mac-與常見伺服器-Ubuntu-同屬-unix-like"><a href="#Mac-與常見伺服器-Ubuntu-同屬-unix-like" class="headerlink" title="Mac 與常見伺服器(Ubuntu) 同屬 unix like"></a>Mac 與常見伺服器(Ubuntu) 同屬 unix like</h3><p>這會在許多指令、環境上的建制有許多相似之處<br>在部屬時會因為與伺服器端相似度高<br>所以問題也會較少些喔</p><h3 id="開發工具多樣性"><a href="#開發工具多樣性" class="headerlink" title="開發工具多樣性"></a>開發工具多樣性</h3><p>Mac 版本的開發工具很豐富<br>有許多工具是只有 MacOS 才有<br>或者是先有 MacOS 版本後來才轉移到其他系統</p><p>案例：Dash, Affinity 系列, Sketch, iTerm</p><h3 id="Macbook-CP-值高"><a href="#Macbook-CP-值高" class="headerlink" title="Macbook CP 值高"></a>Macbook CP 值高</h3><p>價格偏高是事實，<br>硬體規格看似也低於同價格的 Windows 筆電，<br>但用兩年以上品質就會有差異</p><ul><li>電池耐久是實際 8hr 以上</li><li>螢幕顯色力高，可以作為網頁設計的基準</li><li>輕便</li><li>二手販售Macbook仍還能賣個不錯的價格，可以到<a href="https://www.ptt.cc/bbs/MacShop/index.html">Mac二手 PTT版</a> 逛看看。</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> mac </tag>
            
            <tag> developer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Navigation固定上方，往下瀏覽頁面時縮小效果</title>
      <link href="//Navigation%E5%9B%BA%E5%AE%9A%E4%B8%8A%E6%96%B9%EF%BC%8C%E5%BE%80%E4%B8%8B%E7%80%8F%E8%A6%BD%E9%A0%81%E9%9D%A2%E6%99%82%E7%B8%AE%E5%B0%8F%E6%95%88%E6%9E%9C/"/>
      <url>//Navigation%E5%9B%BA%E5%AE%9A%E4%B8%8A%E6%96%B9%EF%BC%8C%E5%BE%80%E4%B8%8B%E7%80%8F%E8%A6%BD%E9%A0%81%E9%9D%A2%E6%99%82%E7%B8%AE%E5%B0%8F%E6%95%88%E6%9E%9C/</url>
      
        <content type="html"><![CDATA[<p>此篇講述什麼是Web Sticky效果，固定nav及縮小，及紀錄遇到的困難、改良後的JavaScript寫法。<br>將會使用到CSS、JavaScript。</p><h3 id="什麼是Sticky？"><a href="#什麼是Sticky？" class="headerlink" title="什麼是Sticky？"></a>什麼是Sticky？</h3><p>固定Nav後會隨著捲軸拉下去而縮小<br><span id="more"></span><br><a href="https://hazelwu2.github.io/AjaxMasonryPhoto/">請點我預覽DEMO效果</a></p><p><img src="http://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/06/11232058/sticky-effect-300x120.gif" alt="stikcy-effect-demo"></p><h3 id="HTML架構："><a href="#HTML架構：" class="headerlink" title="HTML架構："></a>HTML架構：</h3><p><img src="http://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/06/11232033/nav-html-elmulate-300x247.png" alt="nav-html-elmulate"></p><h3 id="流程圖"><a href="#流程圖" class="headerlink" title="流程圖"></a>流程圖</h3><p><img src="http://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/06/11232046/sticky-effect-flow-chart-300x201.png" alt="sticky-effect-flow-chart"></p><h3 id="錯誤示範"><a href="#錯誤示範" class="headerlink" title="錯誤示範"></a>錯誤示範</h3><ul><li><a href="https://codepen.io/wualnz/pen/RgQozy">CodePen的錯誤示範</a></li></ul><p><img src="http://s3-ap-northeast-1.amazonaws.com/hazel-wordpress/wp-content/uploads/2017/06/11232110/sticky-effect-bad-example-768x452.png" alt="sticky-effect-bad-example"></p><ul><li>超新手時期的我居然這樣寫XDD，程式碼真的是又臭又長天啊，把JS和CSS全部寫在一起了=_=</li><li>千萬不要這麼做，把CSS, JS分離，日後才好維護程式碼！</li></ul><h3 id="改良後Js寫法"><a href="#改良後Js寫法" class="headerlink" title="改良後Js寫法"></a>改良後Js寫法</h3><p>將CSS分歸類在JS要新增的CSS CLASS裡，JS只新增CLASS<br>一目瞭然！<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"> $(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>      $(<span class="hljs-built_in">window</span>).scroll(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<br>       <span class="hljs-keyword">if</span>($(<span class="hljs-built_in">window</span>).scrolltop() &gt; <span class="hljs-number">0</span>)<br>           $(‘#header’).addclass(‘mini’);<br>       <span class="hljs-keyword">else</span> <br>     $(‘#header’).removeclass(‘mini’);<br>       &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> css </tag>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
